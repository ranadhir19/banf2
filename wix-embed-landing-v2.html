<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="format-detection" content="telephone=no">
    <!-- Allow embedding in Wix iframes -->
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors 'self' https://*.wix.com https://*.wixsite.com https://editor.wix.com https://manage.wix.com;">
    <base target="_parent">
    <title>BANF Jacksonville - Bengali Association of North Florida</title>
    <!-- Favicon - Multiple formats to prevent 403 errors -->
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AQAA/wYAAP8MAAD/EgAA/xIAAP8MAAD/BgAA/wEAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wMAAP8PAAD/IQAA/zQAAP9HAAD/VwAA/1cAAP9HAAD/NAAA/yEAAP8PAAD/AwAA/wAAAP8AAAD/BAAA/xsAAP87AAD/XQAA/4UAAP+sAAD/yAAA/8gAAP+sAAD/hQAA/10AAP87AAD/GwAA/wQAAP8AAAD/EgAA/0UAAP+GAAD/xAAA//UAAP//AAD//wAA//8AAP//AAD/9QAA/8QAAP+GAAD/RQAA/xIAAP8CAAD/JQAA/3cAAP/HAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA/8cAAP93AAD/JQAA/wIAAP8DAAD/PAAA/6YAAP/0AAD//wAA//8AdQD/AH0A/wB5AP8AdQD//wAA//QAAP+mAAD/PAAA/wMAAP8GAAD/UwAA/8oAAP//AAD//wA7AP8AVQD/AFYA/wBWAP8AVQD/ADsA//8AAP/KAAD/UwAA/wYAAP8IAAD/XwAA/9oAAP//AAD/ADkA/wBYAP8AUgD/AFYA/wBWAP8AUgD/AFgA/wA5AP//AAD/2gAA/18AAP8IAAD/CAAA/18AAP/aAAD//wAALgBSAP8AWAD/AFIA/wBWAP8AVgD/AFIA/wBYAP8AUgAu//8AAP/aAAD/XwAA/wgAAP8GAAD/UwAA/8oAAP//AABSAFUA/wBYAP8AUgD/AFYA/wBWAP8AUgD/AFgA/wBVAFIA/wAA/8oAAP9TAAD/BgAA/wMAAP88AAD/pgAA//QAABUAeQD/AH0A/wBWAP8AVgD/AFYA/wBWAP8AfQD/AHkAFf/0AAD/pgAA/zwAAP8DAAD/AgAA/yUAAP93AAD/xwAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP/HAAD/dwAA/yUAAP8CAAD/AAAA/xIAAP9FAAD/hgAA/8QAAP/1AAD//wAA//8AAP//AAD//wAA//UAAP/EAAD/hgAA/0UAAP8SAAD/AAAA/wQAAP8bAAD/OwAA/10AAP+FAAD/rAAA/8gAAP/IAAD/rAAA/4UAAP9dAAD/OwAA/xsAAP8EAAD/AAAA/wAAAP8DAAD/DwAA/yEAAP80AAD/RwAA/1cAAP9XAAD/RwAA/zQAAP8hAAD/DwAA/wMAAP8AAAD/AAAA/wAAAP8AAAD/AQAA/wYAAP8MAAD/EgAA/xIAAP8MAAD/BgAA/wEAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ff6b35'/%3E%3Cstop offset='100%25' stop-color='%23006A4E'/%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='50' cy='50' r='45' fill='url(%23g)'/%3E%3Ctext x='50' y='65' font-family='Arial' font-size='40' font-weight='bold' fill='white' text-anchor='middle'%3EB%3C/text%3E%3C/svg%3E">
    <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAD/AAAA/wAAAP8AAAD/AQAA/wYAAP8MAAD/EgAA/xIAAP8MAAD/BgAA/wEAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wMAAP8PAAD/IQAA/zQAAP9HAAD/VwAA/1cAAP9HAAD/NAAA/yEAAP8PAAD/AwAA/wAAAP8AAAD/BAAA/xsAAP87AAD/XQAA/4UAAP+sAAD/yAAA/8gAAP+sAAD/hQAA/10AAP87AAD/GwAA/wQAAP8AAAD/EgAA/0UAAP+GAAD/xAAA//UAAP//AAD//wAA//8AAP//AAD/9QAA/8QAAP+GAAD/RQAA/xIAAP8CAAD/JQAA/3cAAP/HAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA/8cAAP93AAD/JQAA/wIAAP8DAAD/PAAA/6YAAP/0AAD//wAA//8AdQD/AH0A/wB5AP8AdQD//wAA//QAAP+mAAD/PAAA/wMAAP8GAAD/UwAA/8oAAP//AAD//wA7AP8AVQD/AFYA/wBWAP8AVQD/ADsA//8AAP/KAAD/UwAA/wYAAP8IAAD/XwAA/9oAAP//AAD/ADkA/wBYAP8AUgD/AFYA/wBWAP8AUgD/AFgA/wA5AP//AAD/2gAA/18AAP8IAAD/CAAA/18AAP/aAAD//wAALgBSAP8AWAD/AFIA/wBWAP8AVgD/AFIA/wBYAP8AUgAu//8AAP/aAAD/XwAA/wgAAP8GAAD/UwAA/8oAAP//AABSAFUA/wBYAP8AUgD/AFYA/wBWAP8AUgD/AFgA/wBVAFIA/wAA/8oAAP9TAAD/BgAA/wMAAP88AAD/pgAA//QAABUAeQD/AH0A/wBWAP8AVgD/AFYA/wBWAP8AfQD/AHkAFf/0AAD/pgAA/zwAAP8DAAD/AgAA/yUAAP93AAD/xwAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP/HAAD/dwAA/yUAAP8CAAD/AAAA/xIAAP9FAAD/hgAA/8QAAP/1AAD//wAA//8AAP//AAD//wAA//UAAP/EAAD/hgAA/0UAAP8SAAD/AAAA/wQAAP8bAAD/OwAA/10AAP+FAAD/rAAA/8gAAP/IAAD/rAAA/4UAAP9dAAD/OwAA/xsAAP8EAAD/AAAA/wAAAP8DAAD/DwAA/yEAAP80AAD/RwAA/1cAAP9XAAD/RwAA/zQAAP8hAAD/DwAA/wMAAP8AAAD/AAAA/wAAAP8AAAD/AQAA/wYAAP8MAAD/EgAA/xIAAP8MAAD/BgAA/wEAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=">
    <!-- Google Fonts - using preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* ========== CSS VARIABLES ========== */
        :root {
            --banf-orange: #ff6b35;
            --banf-yellow: #f7931e;
            --banf-deep-red: #8B0000;
            --banf-green: #006A4E;
            --gold: #D4AF37;
            --navy: #1a1a2e;
            --cream: #FFF8F0;
            --gradient-primary: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            --gradient-hero: linear-gradient(135deg, rgba(139,0,0,0.95) 0%, rgba(255,107,53,0.9) 50%, rgba(247,147,30,0.85) 100%);
            --gradient-green: linear-gradient(135deg, #006A4E 0%, #00856F 100%);
        }

        /* ========== EMBED-SPECIFIC STYLES ========== */
        /* 
         * FIX: For Wix iframe embedding, DO NOT use height:100% on html/body
         * This causes content to be compressed. Instead, let content flow naturally
         * and the iframe should auto-resize OR have internal scrolling.
         */
        html {
            width: 100%;
            min-height: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            /* Let content determine height naturally */
        }
        
        body {
            width: 100%;
            min-height: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            /* Content flows naturally - no fixed height constraint */
        }
        
        /* Fix for Wix iframe embedding - make content visible */
        .wix-embed-mode {
            min-height: 100vh !important;
            /* Removed height: 100% which was causing the compression */
        }
        
        /* Ensure all content sections have proper display */
        section {
            display: block;
            position: relative;
        }
        
        /* Force all sections to be visible */
        body > * {
            position: relative;
            z-index: 1;
        }
        
        /* Prevent footer from collapsing */
        footer {
            position: relative;
            z-index: 1;
        }
        
        /* ========== BASE STYLES ========== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: #f8f9fa; 
            color: #495057; 
            line-height: 1.7;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        h1, h2, h3, h4, h5, h6 { 
            font-family: 'Playfair Display', Georgia, serif; 
            font-weight: 600; 
            color: var(--navy); 
        }
        .bengali-text { font-family: 'Hind Siliguri', sans-serif; }
        a { text-decoration: none; transition: all 0.3s ease; }
        img { max-width: 100%; height: auto; }

        /* ========== NAVBAR ========== */
        .navbar {
            background: rgba(26, 26, 46, 0.98);
            backdrop-filter: blur(20px);
            padding: 0.75rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.15);
        }
        .navbar-brand {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff !important;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .navbar-brand .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        .nav-link {
            color: rgba(255,255,255,0.85) !important;
            font-weight: 500;
            padding: 0.5rem 0.9rem !important;
            border-radius: 8px;
            transition: all 0.3s;
            font-size: 0.95rem;
        }
        .nav-link:hover {
            color: #fff !important;
            background: rgba(255,255,255,0.1);
        }
        .nav-link i { margin-right: 0.4rem; }
        .btn-nav {
            background: var(--gradient-primary);
            color: #fff !important;
            border: none;
            padding: 0.6rem 1.3rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
        }
        .btn-nav:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255,107,53,0.4);
        }
        .navbar-toggler {
            border-color: rgba(255,255,255,0.3);
        }
        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.85%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        /* ========== HERO SECTION ========== */
        .hero {
            min-height: 55vh; /* Compact for Wix embed */
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: var(--gradient-hero);
            padding-top: 80px;
            padding-bottom: 2rem;
            overflow: visible; /* Changed from hidden to allow content flow */
        }
        .hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url('https://images.unsplash.com/photo-1545893835-abaa50cbe628?w=1920&q=80') center/cover no-repeat;
            opacity: 0.12;
        }
        .hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 150px;
            background: linear-gradient(to top, #f8f9fa, transparent);
        }
        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 0 1rem;
            max-width: 900px;
        }
        .hero h1 {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            color: #fff;
            margin-bottom: 1rem;
            text-shadow: 2px 4px 20px rgba(0,0,0,0.3);
            line-height: 1.2;
        }
        .hero-subtitle {
            font-size: 1.15rem;
            color: rgba(255,255,255,0.92);
            max-width: 700px;
            margin: 0 auto 1.5rem;
            line-height: 1.8;
        }
        .hero-bengali {
            font-size: 1.7rem;
            color: #E5C158;
            margin-bottom: 1.5rem;
            text-shadow: 1px 2px 10px rgba(0,0,0,0.2);
        }
        .hero-badge {
            display: inline-block;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.25);
            color: #fff;
            padding: 0.6rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }
        .hero-badge i { color: var(--gold); }
        .hero-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .btn-primary-custom {
            background: var(--gradient-primary);
            color: #fff;
            border: none;
            padding: 0.9rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .btn-primary-custom:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255,107,53,0.4);
            color: #fff;
        }
        .btn-outline-custom {
            background: transparent;
            color: #fff;
            border: 2px solid rgba(255,255,255,0.5);
            padding: 0.85rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .btn-outline-custom:hover {
            background: rgba(255,255,255,0.15);
            border-color: #fff;
            color: #fff;
        }

        /* ========== STATS SECTION ========== */
        .stats-section {
            background: var(--gradient-primary);
            padding: 1.5rem 0;
            margin-top: -40px;
            margin-bottom: 2rem;
            position: relative;
            z-index: 3;
        }
        .stat-item {
            text-align: center;
            color: #fff;
            padding: 0.5rem;
        }
        .stat-number {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 700;
            display: block;
            line-height: 1.2;
        }
        .stat-label {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-top: 0.15rem;
        }

        /* ========== SECTION STYLES ========== */
        section { padding: 5rem 0; }
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        .section-header h2 {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            position: relative;
            display: inline-block;
        }
        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--gradient-primary);
            border-radius: 2px;
        }
        .section-header p {
            color: #6c757d;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 1.5rem auto 0;
        }

        /* ========== QUICK ACCESS BAR ========== */
        .quick-access {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-top: 1rem;
            position: relative;
            z-index: 10;
        }
        .quick-item {
            text-align: center;
            padding: 1.5rem 1rem;
            border-radius: 15px;
            transition: all 0.3s;
            text-decoration: none;
            color: var(--navy);
            display: block;
        }
        .quick-item:hover {
            background: #f8f9fa;
            transform: translateY(-5px);
            color: var(--banf-orange);
        }
        .quick-item i {
            font-size: 2rem;
            color: var(--banf-orange);
            margin-bottom: 0.75rem;
            display: block;
        }
        .quick-item span {
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ========== PRESIDENT'S MESSAGE ========== */
        .president-welcome {
            background: #fff;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        .president-header {
            background: linear-gradient(135deg, var(--banf-deep-red) 0%, #a52a2a 100%);
            padding: 2rem;
            color: #fff;
        }
        .president-photo {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid rgba(255,255,255,0.3);
            background: linear-gradient(135deg, var(--banf-orange), var(--banf-yellow));
        }
        .president-body {
            padding: 2.5rem;
            line-height: 1.9;
            color: #2c3e50;
        }
        .president-body p { margin-bottom: 1.25rem; }
        .president-body .lead {
            font-size: 1.2rem;
            color: var(--banf-deep-red);
            font-weight: 600;
        }
        .poem-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #fff3e0 100%);
            padding: 1.5rem;
            border-radius: 15px;
            margin: 1.5rem 0;
            border-left: 5px solid var(--gold);
            font-style: italic;
            color: #5d4037;
        }
        .lang-toggle {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1rem;
        }
        .lang-toggle .btn {
            border-radius: 20px;
            padding: 0.4rem 1.2rem;
            font-size: 0.9rem;
        }
        .lang-toggle .btn.active {
            background: rgba(255,255,255,0.3);
        }
        .signature-block {
            text-align: right;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid #dee2e6;
        }

        /* ========== EC TEAM CARDS ========== */
        .ec-section { background: #f0f4f8; }
        .ec-card {
            background: #fff;
            border-radius: 20px;
            padding: 2rem 1.5rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: all 0.4s;
            border: 2px solid transparent;
            height: 100%;
        }
        .ec-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.12);
            border-color: var(--banf-orange);
        }
        .ec-avatar-wrapper {
            position: relative;
            width: 110px;
            height: 110px;
            margin: 0 auto 1rem;
        }
        .ec-avatar-img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #f0f0f0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .ec-avatar {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--banf-orange), var(--banf-yellow));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #fff;
            font-weight: 700;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .ec-position {
            display: inline-block;
            background: var(--gradient-primary);
            color: #fff;
            padding: 0.4rem 1.2rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }
        .ec-card h6 {
            font-size: 1.1rem;
            margin: 0.75rem 0 0.25rem;
            color: var(--navy);
        }
        .ec-short-bio {
            font-size: 0.85rem;
            color: #6c757d;
            margin: 0.5rem 0;
        }
        .ec-contact {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 0.75rem;
        }
        .ec-contact a {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            transition: all 0.3s;
        }
        .ec-contact a:hover {
            background: var(--gradient-primary);
            color: #fff;
        }

        /* ========== SERVICES SECTION (REDESIGNED PORTAL HUB) ========== */
        .services-section { background: linear-gradient(180deg, #fff 0%, #f8f9fa 100%); }
        
        /* Portal Hub Container */
        .portal-hub {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        /* Portal Cards - Main Entry Points */
        .portal-card {
            background: #fff;
            border-radius: 24px;
            padding: 2.5rem;
            text-align: center;
            transition: all 0.4s ease;
            border: 3px solid transparent;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
        }
        .portal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--gradient-primary);
        }
        .portal-card.member-portal::before { background: var(--gradient-green); }
        .portal-card.admin-portal::before { background: linear-gradient(135deg, #8B0000, #DC143C); }
        .portal-card.visitor-portal::before { background: linear-gradient(135deg, #673AB7, #9C27B0); }
        
        .portal-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 25px 60px rgba(0,0,0,0.15);
        }
        
        .portal-icon {
            width: 100px;
            height: 100px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2.5rem;
            color: #fff;
        }
        .visitor-portal .portal-icon { background: linear-gradient(135deg, #673AB7, #9C27B0); }
        .member-portal .portal-icon { background: var(--gradient-green); }
        .admin-portal .portal-icon { background: linear-gradient(135deg, #8B0000, #DC143C); }
        
        .portal-card h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--banf-charcoal);
        }
        .portal-card .portal-subtitle {
            font-size: 0.95rem;
            color: #6c757d;
            margin-bottom: 1.5rem;
        }
        
        .portal-features {
            list-style: none;
            padding: 0;
            margin: 0 0 1.5rem 0;
            text-align: left;
        }
        .portal-features li {
            padding: 0.6rem 0;
            border-bottom: 1px dashed #eee;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9rem;
        }
        .portal-features li:last-child { border-bottom: none; }
        .portal-features li i {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            background: rgba(0,106,78,0.1);
            color: var(--banf-green);
        }
        
        .portal-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1rem;
            width: 100%;
            transition: all 0.3s;
            text-decoration: none;
            cursor: pointer;
            border: none;
        }
        .portal-btn.visitor-btn {
            background: linear-gradient(135deg, #673AB7, #9C27B0);
            color: #fff;
        }
        .portal-btn.member-btn {
            background: var(--gradient-green);
            color: #fff;
        }
        .portal-btn.admin-btn {
            background: linear-gradient(135deg, #8B0000, #DC143C);
            color: #fff;
        }
        .portal-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .portal-note {
            font-size: 0.8rem;
            color: #888;
            margin-top: 1rem;
        }
        .portal-note i { color: var(--banf-orange); }
        
        /* Service Cards Grid (for individual services) */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .service-card {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            height: 100%;
            border: 2px solid transparent;
        }
        .service-card:hover {
            background: #fff;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            border-color: var(--banf-orange);
            transform: translateY(-8px);
        }
        .service-icon {
            width: 70px;
            height: 70px;
            border-radius: 20px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.25rem;
            font-size: 1.8rem;
            color: #fff;
        }
        .service-card h5 {
            font-size: 1.15rem;
            margin-bottom: 0.75rem;
        }
        .service-card p {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 1rem;
        }
        .service-link {
            color: var(--banf-orange);
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .service-link:hover {
            color: var(--banf-deep-red);
        }
        
        /* Quick Access Bar */
        .quick-access {
            background: linear-gradient(135deg, var(--banf-charcoal), #3d3d3d);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
        }
        .quick-access h4 {
            color: #fff;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        .quick-links {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        .quick-link {
            background: rgba(255,255,255,0.1);
            color: #fff;
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            font-size: 0.85rem;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        .quick-link:hover {
            background: var(--banf-orange);
            color: #fff;
        }

        /* ========== EVENTS SECTION ========== */
        .event-card {
            background: #fff;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: all 0.3s;
            height: 100%;
        }
        .event-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.12);
        }
        .event-image {
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: rgba(255,255,255,0.9);
            position: relative;
        }
        .event-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255,255,255,0.9);
            color: var(--banf-deep-red);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .event-content { padding: 1.5rem; }
        .event-date {
            display: inline-block;
            background: var(--gradient-primary);
            color: #fff;
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        .event-content h4 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        .event-location {
            color: #6c757d;
            font-size: 0.9rem;
        }
        .event-location i {
            color: var(--banf-orange);
            margin-right: 0.5rem;
        }

        /* ========== RADIO SECTION ========== */
        .radio-section {
            background: linear-gradient(135deg, #1a1a2e, #2d2d44);
            color: #fff;
        }
        .radio-player {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 3rem;
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
        }
        .radio-status {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            background: rgba(255, 107, 53, 0.2);
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            margin-bottom: 1.5rem;
        }
        .live-dot {
            width: 12px;
            height: 12px;
            background: var(--banf-orange);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.3); }
        }
        .now-playing {
            font-size: 1.4rem;
            margin-bottom: 2rem;
            color: rgba(255,255,255,0.9);
        }
        .radio-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            background: var(--gradient-primary);
            color: #fff;
            transition: all 0.3s;
            margin: 0 0.5rem;
        }
        .radio-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(255,107,53,0.4);
        }
        .radio-features {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .radio-feature {
            text-align: center;
            opacity: 0.9;
        }
        .radio-feature i {
            font-size: 1.5rem;
            color: var(--gold);
            margin-bottom: 0.5rem;
            display: block;
        }

        /* ========== MEMBERSHIP SECTION ========== */
        .membership-section {
            background: linear-gradient(135deg, var(--banf-deep-red) 0%, #4a0000 100%);
            color: #fff;
        }
        .membership-section .section-header h2 { color: #fff; }
        .membership-section .section-header h2::after {
            background: linear-gradient(135deg, var(--gold), #E5C158);
        }
        .pricing-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.4s;
            height: 100%;
        }
        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .pricing-card.featured {
            background: #fff;
            transform: scale(1.05);
        }
        .pricing-card.featured:hover { transform: scale(1.08); }
        .pricing-header {
            padding: 2rem;
            text-align: center;
            color: #fff;
        }
        .pricing-card.featured .pricing-header {
            background: var(--gradient-primary);
        }
        .pricing-price {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
        }
        .pricing-price span {
            font-size: 1rem;
            opacity: 0.8;
        }
        .pricing-body {
            padding: 2rem;
            background: rgba(255,255,255,0.05);
        }
        .pricing-card.featured .pricing-body {
            background: #fff;
            color: var(--navy);
        }
        .pricing-feature {
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .pricing-card.featured .pricing-feature {
            border-color: #eee;
        }
        .pricing-feature i { color: #28a745; }
        .pricing-footer {
            padding: 1.5rem 2rem;
            background: rgba(0,0,0,0.1);
        }
        .pricing-card.featured .pricing-footer {
            background: #f8f9fa;
        }

        /* ========== JACKSONVILLE GUIDE ========== */
        .guide-section { background: #f0f4f8; }
        .guide-card {
            background: #fff;
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: all 0.3s;
            height: 100%;
        }
        .guide-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.12);
        }
        .guide-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 2rem;
        }
        .guide-card h5 { margin-bottom: 0.5rem; }
        .guide-card p {
            font-size: 0.9rem;
            color: #6c757d;
        }

        /* ========== MAGAZINE SECTION ========== */
        .magazine-section { background: var(--cream); }
        .magazine-preview {
            background: #fff;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
        }
        .magazine-cover {
            height: 300px;
            background: linear-gradient(135deg, var(--banf-deep-red), var(--banf-orange));
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 5rem;
        }
        .magazine-info { padding: 2rem; }

        /* ========== CONTACT SECTION ========== */
        .contact-section { background: #f0f4f8; }
        .contact-form {
            background: #fff;
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
        }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--navy);
        }
        .form-control {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        .form-control:focus {
            outline: none;
            border-color: var(--banf-orange);
        }
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        .submit-btn {
            width: 100%;
            background: var(--gradient-primary);
            color: #fff;
            border: none;
            padding: 1rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255,107,53,0.4);
        }
        .contact-info-card {
            background: #fff;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            height: 100%;
        }
        .contact-info-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .contact-info-item i {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255,107,53,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--banf-orange);
            flex-shrink: 0;
        }

        /* ========== FOOTER ========== */
        .footer {
            background: linear-gradient(135deg, #1a1a2e, #2d2d44);
            color: #fff;
            padding: 4rem 0 2rem;
        }
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }
        .footer-section h5 {
            color: var(--gold);
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
        }
        .footer-section p,
        .footer-section a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            display: block;
            margin-bottom: 0.75rem;
            transition: color 0.3s;
        }
        .footer-section a:hover { color: var(--gold); }
        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        .social-link {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            transition: all 0.3s;
            text-decoration: none;
        }
        .social-link:hover {
            background: var(--gradient-primary);
            transform: translateY(-3px);
            color: #fff;
        }
        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 2rem;
            text-align: center;
            opacity: 0.8;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 992px) {
            .president-header { text-align: center; }
            .president-header .d-flex { justify-content: center !important; }
            .quick-access { margin-top: -40px; padding: 1.5rem; }
        }
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.2rem; }
            .hero-bengali { font-size: 1.4rem; }
            .hero { padding: 2rem 1rem; }
            .hero-subtitle { font-size: 1rem; }
            .hero-buttons { flex-direction: column; gap: 0.5rem; }
            .hero-buttons .btn-primary-custom,
            .hero-buttons .btn-outline-custom { width: 100%; justify-content: center; }
            .stat-number { font-size: 2.5rem; }
            .president-body { padding: 1.5rem; }
            .president-header .d-flex { flex-direction: column; text-align: center; }
            .pricing-card.featured { transform: scale(1); }
            .pricing-card.featured:hover { transform: scale(1); }
            section { padding: 3.5rem 0; }
            .section-header h2 { font-size: 1.8rem; }
            /* Quick Access Bar — horizontal scroll on mobile */
            .quick-access .row { flex-wrap: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; scroll-snap-type: x mandatory; padding-bottom: 0.5rem; }
            .quick-access .row > .col { flex: 0 0 auto; width: 80px; scroll-snap-align: start; }
            .quick-access .quick-item span { font-size: 0.65rem; }
            /* Sponsorship tiers — full-width stack */
            .pricing-card { margin-bottom: 1rem; }
            /* Touch targets — minimum 44px */
            .btn, .admin-nav-item, .portal-nav-item, .quick-item, a.btn { min-height: 44px; }
        }

        /* ========== SMALL MOBILE (≤480px) — Sidebar drawer mode ========== */
        @media (max-width: 480px) {
            .hero h1 { font-size: 1.6rem; }
            .hero-badge { font-size: 0.75rem; padding: 0.35rem 0.8rem; }
            .hero-bengali { font-size: 1.1rem; }
            .stat-number { font-size: 2rem; }
            .stat-label { font-size: 0.7rem; }
            .section-header h2 { font-size: 1.4rem; }
            .section-header p { font-size: 0.85rem; }
            .ec-card h6 { font-size: 0.8rem; }
            .ec-card .ec-short-bio { display: none; }
        }

        /* ===== iPhone SE / very small phones (375px and below) ===== */
        @media (max-width: 375px) {
            /* Hero — tighter fit */
            .hero { min-height: 55vh; padding: 2rem 0.5rem; }
            .hero h1 { font-size: 1.35rem; line-height: 1.3; }
            .hero-subtitle { font-size: 0.8rem; line-height: 1.4; padding: 0 0.25rem; }
            .hero-bengali { font-size: 0.95rem; }
            .hero-badge { font-size: 0.7rem; padding: 0.3rem 0.6rem; }
            .hero-buttons { flex-direction: column; gap: 0.5rem; }
            .hero-buttons a { width: 100%; text-align: center; font-size: 0.85rem; padding: 0.6rem 1rem; }

            /* Navigation — compact */
            .navbar-brand { font-size: 1rem; }
            .navbar-brand .logo-icon { font-size: 1.1rem; width: 28px; height: 28px; }
            .nav-link { font-size: 0.8rem; padding: 0.4rem 0.5rem !important; }

            /* Section headers */
            .section-header h2 { font-size: 1.2rem; }
            .section-header p { font-size: 0.8rem; }

            /* Stats — single column */
            .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 0.5rem; }
            .stat-number { font-size: 1.6rem; }
            .stat-label { font-size: 0.65rem; }

            /* EC team grid — single column on tiny screens */
            .ec-team-grid { grid-template-columns: 1fr !important; gap: 0.75rem; }
            .ec-card { padding: 0.75rem; }
            .ec-card .ec-photo { width: 60px; height: 60px; }
            .ec-card h6 { font-size: 0.75rem; }
            .ec-card .ec-role { font-size: 0.65rem; }

            /* Buttons — full width, proper touch targets */
            .btn, .btn-primary-custom, .btn-outline-custom {
                min-height: 44px;
                font-size: 0.8rem;
                padding: 0.5rem 0.75rem;
                width: 100%;
            }

            /* Cards & containers — reduce padding */
            .card, .feature-card, .service-card { padding: 0.75rem; }
            .container { padding-left: 0.75rem; padding-right: 0.75rem; }

            /* Tables — compact text */
            table th, table td { font-size: 0.7rem; padding: 0.35rem 0.4rem; }

            /* Member portal — tighter spacing */
            .portal-content-area { padding: 0.5rem !important; }
            .portal-page-header h2 { font-size: 1.1rem; }

            /* Admin portal — tighter spacing */
            .admin-main-content { padding: 0.5rem !important; }
            .admin-section-header h3 { font-size: 1rem; }

            /* Quick access bar — smaller icons */
            .quick-item { min-width: 60px; font-size: 0.65rem; padding: 0.4rem; }
            .quick-item i { font-size: 1rem; }

            /* Modals — ensure full screen */
            .modal-dialog { margin: 0 !important; }
            .modal-header h5 { font-size: 1rem; }
            .modal-body { padding: 0.75rem; font-size: 0.85rem; }

            /* Careers section */
            .career-card { padding: 0.75rem; }
            .career-card h6 { font-size: 0.85rem; }

            /* DB Explorer — compact */
            .db-explorer-controls { flex-direction: column; gap: 0.5rem; }
            .db-explorer-controls input,
            .db-explorer-controls select { width: 100%; font-size: 0.8rem; }

            /* Form inputs — prevent zoom on iOS */
            input, select, textarea { font-size: 16px !important; }
        }
    </style>
</head>
<body>
    <!-- ========== NAVIGATION ========== -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="#">
                <span class="logo-icon"><i class="fas fa-om"></i></span>
                BANF
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item"><a class="nav-link" href="#about"><i class="fas fa-info-circle"></i>About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#ec-team"><i class="fas fa-users"></i>Leadership</a></li>
                    <li class="nav-item"><a class="nav-link" href="#services"><i class="fas fa-th-large"></i>Services</a></li>
                    <li class="nav-item"><a class="nav-link" href="#careers-guidance"><i class="fas fa-briefcase"></i>Careers</a></li>
                    <li class="nav-item"><a class="nav-link" href="#events"><i class="fas fa-calendar-alt"></i>Events</a></li>
                    <li class="nav-item"><a class="nav-link" href="#radio"><i class="fas fa-broadcast-tower"></i>Radio</a></li>
                    <li class="nav-item"><a class="nav-link" href="#membership"><i class="fas fa-id-card"></i>Membership</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact"><i class="fas fa-envelope"></i>Contact</a></li>
                    <li class="nav-item ms-2">
                        <a class="btn-nav" href="#membership"><i class="fas fa-user-plus me-2"></i>Join Now</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- ========== HERO SECTION ========== -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-badge">
                <i class="fas fa-star me-2"></i>Since 2008 — 17 Years of Heritage
            </div>
            <p class="hero-bengali bengali-text">স্বাগতম | আমাদের পরিবারে আপনাকে স্বাগত</p>
            <h1>Bengali Association of<br>North Florida</h1>
            <p class="hero-subtitle">
                Preserving Bengali culture, traditions, and heritage in Jacksonville, Florida — 
                Building bridges between generations through community, celebration, and service.
            </p>
            <div class="hero-buttons">
                <a href="#membership" class="btn-primary-custom" data-action="join" title="Navigate to membership page">
                    <i class="fas fa-user-plus"></i>Become a Member
                </a>
                <a href="#events" class="btn-outline-custom" data-action="events" title="View all events">
                    <i class="fas fa-calendar-alt"></i>Upcoming Events
                </a>
            </div>
        </div>
    </section>

    <!-- ========== STATS SECTION ========== -->
    <section class="stats-section">
        <div class="container">
            <div class="row">
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <span class="stat-number">80+</span>
                        <span class="stat-label">Active Families</span>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <span class="stat-number">10+</span>
                        <span class="stat-label">Events Yearly</span>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <span class="stat-number">17</span>
                        <span class="stat-label">Years Strong</span>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <span class="stat-number">45+</span>
                        <span class="stat-label">Sponsors</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== QUICK ACCESS BAR ========== -->
    <div class="container">
        <div class="quick-access">
            <div class="row row-cols-4 row-cols-md-6 row-cols-lg-12 g-2 justify-content-center">
                <div class="col">
                    <a href="#membership" class="quick-item" data-action="join" title="members.jsw → registerMember()">
                        <i class="fas fa-credit-card"></i>
                        <span>Pay Dues</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#events" class="quick-item" data-action="events" title="events.jsw → getUpcomingEvents()">
                        <i class="fas fa-calendar-check"></i>
                        <span>Events</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#radio" class="quick-item" data-action="radio" title="radio.jsw → getRadioStationConfig()">
                        <i class="fas fa-broadcast-tower"></i>
                        <span>Radio</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#magazine" class="quick-item" data-action="magazine" title="magazine.jsw → getPublishedMagazines()">
                        <i class="fas fa-book-open"></i>
                        <span>Magazine</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#guide" class="quick-item" data-action="guide" title="guide.jsw → getGuideByCategory()">
                        <i class="fas fa-map-marked-alt"></i>
                        <span>Jax Guide</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#surveys" class="quick-item" data-action="surveys" title="surveys.jsw → getActiveSurveys()" onclick="openSurveyModal(); return false;">
                        <i class="fas fa-poll"></i>
                        <span>Surveys</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#complaints" class="quick-item" data-action="complaints" title="complaints.jsw → submitComplaint()" onclick="openComplaintForm(); return false;">
                        <i class="fas fa-shield-alt"></i>
                        <span>Complaints</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#sponsors" class="quick-item" data-action="sponsors" title="sponsorship.jsw → getSponsors()">
                        <i class="fas fa-handshake"></i>
                        <span>Sponsors</span>
                    </a>
                </div>
                <div class="col">
                    <a href="#contact" class="quick-item">
                        <i class="fas fa-comments"></i>
                        <span>Contact</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== PRESIDENT'S MESSAGE ========== -->
    <section id="about" class="py-5" style="background: #f8f9fa;">
        <div class="container">
            <div class="section-header">
                <h2 class="bengali-text">সভাপতির বার্তা</h2>
                <p>President's Welcome Message</p>
            </div>
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="president-welcome">
                        <div class="president-header">
                            <div class="d-flex align-items-center justify-content-center flex-wrap gap-3">
                                <div class="ec-avatar-wrapper" style="width: 90px; height: 90px;">
                                    <img src="https://static.wixstatic.com/media/c62f94_d6f7e8a5b3c14f4f8a7f9e0d1c2b3a4d~mv2.jpg/v1/fill/w_180,h_180,al_c,q_80/rana.jpg" alt="Dr. Ranadhir Ghosh" style="width:100%;height:100%;border-radius:50%;object-fit:cover;border:3px solid white;" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">
                                    <div class="ec-avatar" style="width: 100%; height: 100%; font-size: 1.8rem; display:none;">RG</div>
                                </div>
                                <div class="text-start text-md-start text-center">
                                    <h4 class="mb-1"><i class="fas fa-crown me-2"></i>Dr. Ranadhir Ghosh</h4>
                                    <p class="mb-0 opacity-90">President, BANF 2025-26</p>
                                </div>
                            </div>
                            <div class="lang-toggle">
                                <button type="button" class="btn btn-light btn-sm active" onclick="toggleLanguage('bengali')" id="btn-bengali">
                                    <i class="fas fa-language me-1"></i>বাংলা
                                </button>
                                <button type="button" class="btn btn-outline-light btn-sm" onclick="toggleLanguage('english')" id="btn-english">
                                    <i class="fas fa-globe me-1"></i>English
                                </button>
                            </div>
                        </div>
                        
                        <!-- Bengali Message -->
                        <div class="president-body bengali-text" id="message-bengali">
                            <p class="lead">প্রিয় BANF পরিবার,</p>
                            
                            <p>BANF শুধু একটি সংগঠন নয়—এটি আমাদের সবার স্বপ্ন, পরিশ্রম ও সাংস্কৃতিক বন্ধনের প্রতিফলন। আমরা প্রত্যেকে ভিন্ন ভিন্ন জায়গা থেকে এসেছি—কেউ নতুন, কেউ বহু বছর ধরে এখানে আছেন। কিন্তু আমাদের সংযুক্ত করেছে একটাই জিনিস—বাংলা ভাষা, সংস্কৃতি আর আমাদের ঐতিহ্যের প্রতি ভালোবাসা।</p>
                            
                            <div class="alert" style="background: linear-gradient(135deg, #e8f5e8, #f0f8f0); border-left: 5px solid #28a745; border-radius: 10px; padding: 20px; margin: 25px 0;">
                                <p class="mb-0 fw-bold" style="color: #155724;">
                                    <i class="fas fa-quote-left me-2"></i>
                                    আমাদের মূল বিশ্বাস—BANF-এর সদস্যদের মধ্যে সংযোগ, সমন্বয় এবং সহমর্মিতা বজায় রাখা ও বৃদ্ধি করা।
                                    <i class="fas fa-quote-right ms-2"></i>
                                </p>
                            </div>
                            
                            <p>গত বছরগুলোতে BANF অনেক পথ পেরিয়ে এসেছে। আমরা একসাথে দুর্গাপূজা, কালীপূজা, সরস্বতী পূজা উদযাপন করেছি, পিকনিকে আনন্দ ভাগ করে নিয়েছি, সাংস্কৃতিক অনুষ্ঠানে আমাদের শিল্পকলা প্রদর্শন করেছি। এই সব কিছুই সম্ভব হয়েছে আপনাদের সক্রিয় অংশগ্রহণের জন্য।</p>
                            
                            <p>এই বছর আমাদের লক্ষ্য হলো BANF-কে আরও অংশগ্রহণমূলক, স্বচ্ছ এবং সদস্য-কেন্দ্রিক সংগঠন হিসেবে গড়ে তোলা। আমরা চাই প্রতিটি সদস্য নিজেকে এই পরিবারের অংশ মনে করুক এবং তাদের মতামত, পরামর্শ ও সমালোচনা যেন আমাদের কাছে সহজে পৌঁছাতে পারে।</p>
                            
                            <div class="poem-section">
                                <p class="mb-2">তব চরণ নিম্নে উৎসবময়ী শ্যামধরনী সরসা</p>
                                <p class="mb-2">ঊর্ধ্বে চাহো অগণিত মণি রঞ্জিত নভঃ নীলাঞ্চলা,</p>
                                <p class="mb-0">সৌম্য মধুর দিব্যাঙ্গনা শান্ত-কুশল-দরশা॥</p>
                            </div>
                            
                            <p>আসুন, একসাথে BANF-কে আরও সমৃদ্ধ করি। আপনাদের সহযোগিতা ও ভালোবাসা আমাদের পথ চলার সবচেয়ে বড় অনুপ্রেরণা।</p>
                            
                            <div class="signature-block">
                                <p class="mb-1 fw-bold" style="color: #2c3e50;">শুভেচ্ছান্তে,</p>
                                <p class="mb-1 fw-bold" style="color: var(--banf-deep-red);">— ডঃ রণধীর ঘোষ</p>
                                <p class="mb-0 text-muted">সভাপতি, BANF 2025-26</p>
                            </div>
                        </div>
                        
                        <!-- English Message -->
                        <div class="president-body" id="message-english" style="display: none;">
                            <p class="lead">Dear BANF Family,</p>
                            
                            <p>BANF is not just an organization—it is a reflection of all our dreams, hard work, and cultural bonds. Each of us has come from different places—some are new, some have been here for many years. But one thing connects us all—our love for the Bengali language, culture, and heritage.</p>
                            
                            <div class="alert" style="background: linear-gradient(135deg, #e8f5e8, #f0f8f0); border-left: 5px solid #28a745; border-radius: 10px; padding: 20px; margin: 25px 0;">
                                <p class="mb-0 fw-bold" style="color: #155724;">
                                    <i class="fas fa-quote-left me-2"></i>
                                    Our core belief—to maintain and strengthen the connection, coordination, and compassion among BANF members.
                                    <i class="fas fa-quote-right ms-2"></i>
                                </p>
                            </div>
                            
                            <p>Over the years, BANF has come a long way. Together we have celebrated Durga Puja, Kali Puja, Saraswati Puja, shared joy at picnics, and showcased our artistry at cultural events. All of this has been possible because of your active participation.</p>
                            
                            <p>This year, our goal is to make BANF more participatory, transparent, and member-centric. We want every member to feel they are part of this family, and their opinions, suggestions, and feedback can easily reach us.</p>
                            
                            <div class="poem-section">
                                <p class="mb-2"><em>At your feet lies the festive, verdant, flowing Earth,</em></p>
                                <p class="mb-2"><em>Above, gaze upon the countless jewel-adorned blue sky,</em></p>
                                <p class="mb-0"><em>The gentle, sweet divine maiden, bestowing peace and welfare.</em></p>
                            </div>
                            
                            <p>Come, let us enrich BANF together. Your cooperation and love are our greatest inspiration on this journey.</p>
                            
                            <div class="signature-block">
                                <p class="mb-1 fw-bold" style="color: #2c3e50;">With warm regards,</p>
                                <p class="mb-1 fw-bold" style="color: var(--banf-deep-red);">— Dr. Ranadhir Ghosh</p>
                                <p class="mb-0 text-muted">President, BANF 2025-26</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== EC TEAM SECTION ========== -->
    <section class="ec-section" id="ec-team">
        <div class="container">
            <div class="section-header">
                <h2>Executive Committee</h2>
                <p>2025-26 Leadership Team — Dedicated to serving our community</p>
            </div>
            <!-- Feature 4: Dynamically populated from EC_MEMBERS data array -->
            <div class="row g-4" id="ec-team-grid">
                <!-- Rendered by renderECTeam() on page load -->
            </div>
        </div>
    </section>

    <!-- ========== SERVICES SECTION - PORTAL HUB ========== -->
    <section class="services-section" id="services">
        <div class="container">
            <div class="section-header">
                <h2>Service Portals</h2>
                <p>Access comprehensive digital services for the Bengali community in Jacksonville</p>
            </div>
            
            <!-- Quick Access Bar -->
            <div class="quick-access">
                <h4><i class="fas fa-bolt me-2"></i>Quick Access</h4>
                <div class="quick-links">
                    <a href="#radio" class="quick-link"><i class="fas fa-broadcast-tower"></i> BANF Radio</a>
                    <a href="#events" class="quick-link"><i class="fas fa-calendar"></i> Events</a>
                    <a href="#surveys" class="quick-link" onclick="openSurveySection()"><i class="fas fa-poll"></i> Surveys</a>
                    <a href="#complaints" class="quick-link" onclick="openComplaintForm()"><i class="fas fa-shield-alt"></i> Complaints</a>
                    <a href="#guide" class="quick-link"><i class="fas fa-map-marked-alt"></i> Jax Guide</a>
                    <a href="#magazine" class="quick-link"><i class="fas fa-book-open"></i> E-Magazine</a>
                    <a href="#sponsors" class="quick-link"><i class="fas fa-handshake"></i> Sponsors</a>
                </div>
            </div>
            
            <!-- Portal Hub - Two Main Entry Points -->
            <div class="portal-hub">
                <!-- Member Portal (Login Required) -->
                <div class="portal-card member-portal">
                    <div class="portal-icon"><i class="fas fa-user-circle"></i></div>
                    <h3>Member Portal</h3>
                    <p class="portal-subtitle">Exclusive member services & features</p>
                    
                    <ul class="portal-features">
                        <li><i class="fas fa-tachometer-alt"></i> Personal Dashboard</li>
                        <li><i class="fas fa-id-card"></i> Profile & Family Management</li>
                        <li><i class="fas fa-credit-card"></i> Payments & Receipts</li>
                        <li><i class="fas fa-file-alt"></i> Meeting Minutes Access</li>
                        <li><i class="fas fa-calendar-check"></i> Event Registration & Check-in</li>
                        <li><i class="fas fa-wallet"></i> View Budget Reports</li>
                        <li><i class="fas fa-poll-h"></i> Member-only Surveys</li>
                        <li><i class="fas fa-music"></i> Request Songs on Radio</li>
                        <li><i class="fas fa-pen-fancy"></i> Submit Magazine Content</li>
                        <li><i class="fas fa-address-book"></i> Member Directory</li>
                    </ul>
                    
                    <a href="#" onclick="openMemberPortal('login'); return false;" class="portal-btn member-btn" style="text-decoration: none; display: inline-block;">
                        <i class="fas fa-sign-in-alt"></i> Member Login
                    </a>
                    <p class="portal-note"><i class="fas fa-lock me-1"></i>Login required • <a href="#membership" style="color: var(--banf-orange);">Register Now</a></p>
                </div>
                
                <!-- Admin Portal (EC Login Required) -->
                <div class="portal-card admin-portal">
                    <div class="portal-icon"><i class="fas fa-user-shield"></i></div>
                    <h3>Admin Portal</h3>
                    <p class="portal-subtitle">EC Management Dashboard</p>
                    
                    <ul class="portal-features">
                        <li><i class="fas fa-users-cog"></i> Member Management & Approvals</li>
                        <li><i class="fas fa-money-check-alt"></i> Payment Verification</li>
                        <li><i class="fas fa-calendar-plus"></i> Event & Meeting Management</li>
                        <li><i class="fas fa-broadcast-tower"></i> Radio Station Control</li>
                        <li><i class="fas fa-chart-bar"></i> Survey Administration</li>
                        <li><i class="fas fa-exclamation-triangle"></i> Complaint Resolution</li>
                        <li><i class="fas fa-piggy-bank"></i> Budget & Finance</li>
                        <li><i class="fas fa-store"></i> Vendor & Sponsor Management</li>
                        <li><i class="fas fa-hands-helping"></i> Volunteer Coordination</li>
                        <li><i class="fas fa-newspaper"></i> Magazine Administration</li>
                    </ul>
                    
                    <a href="#" onclick="openAdminLoginModal(); return false;" class="portal-btn admin-btn" style="text-decoration: none; display: inline-block;">
                        <i class="fas fa-user-lock"></i> Admin Login
                    </a>
                    <p class="portal-note"><i class="fas fa-key me-1"></i>EC Members Only</p>
                </div>
            </div>
            
            <!-- Individual Services Grid -->
            <div class="section-header" style="margin-top: 3rem;">
                <h3 style="font-size: 1.5rem;">All Services</h3>
                <p>Detailed access to all BANF digital services</p>
            </div>
            
            <div class="services-grid">
                <!-- Membership Portal -->
                <div class="service-card">
                    <div class="service-icon"><i class="fas fa-id-card"></i></div>
                    <h5>Membership Portal</h5>
                    <p>Register, renew membership, manage family profiles, view payment history and download receipts.</p>
                    <a href="#membership" class="service-link" data-action="join">
                        Join Now <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Event Management -->
                <div class="service-card">
                    <div class="service-icon" style="background: var(--gradient-green);"><i class="fas fa-calendar-alt"></i></div>
                    <h5>Events & Programs</h5>
                    <p>Browse upcoming/past events, register online, pay fees, submit feedback, and check-in at venues.</p>
                    <a href="#events" class="service-link" data-action="events">
                        View Events <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Community Radio -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #673AB7, #9C27B0);"><i class="fas fa-broadcast-tower"></i></div>
                    <h5>BANF Radio 24/7</h5>
                    <p>Listen to Bengali music, view schedule, browse song library, and request your favorite songs.</p>
                    <a href="#radio" class="service-link" data-action="radio">
                        Listen Live <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- E-Magazine -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #E91E63, #FF5722);"><i class="fas fa-book-open"></i></div>
                    <h5>E-Magazine</h5>
                    <p>Browse issues, read articles by category, search content, and submit your own literary works.</p>
                    <a href="#magazine" class="service-link" data-action="magazine">
                        Read Now <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Jacksonville Guide -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #00BCD4, #009688);"><i class="fas fa-map-marked-alt"></i></div>
                    <h5>Jacksonville Guide</h5>
                    <p>Find Bengali restaurants, grocery stores, doctors, schools. Read reviews and submit new listings.</p>
                    <a href="#guide" class="service-link" data-action="guide">
                        Explore Guide <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Surveys -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #FF9800, #FFC107);"><i class="fas fa-poll"></i></div>
                    <h5>Community Surveys</h5>
                    <p>Participate in community polls and surveys. Share your voice anonymously or as a member.</p>
                    <a href="#surveys" class="service-link" data-action="surveys" onclick="openSurveySection()">
                        Take Survey <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Anonymous Complaints -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #607D8B, #455A64);"><i class="fas fa-shield-alt"></i></div>
                    <h5>Anonymous Complaints</h5>
                    <p>Submit anonymous complaints securely. Track status with access codes and add follow-ups.</p>
                    <a href="#complaints" class="service-link" data-action="complaints" onclick="openComplaintForm(); return false;">
                        Submit Complaint <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Meeting Minutes -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #795548, #8D6E63);"><i class="fas fa-file-alt"></i></div>
                    <h5>Meeting Minutes</h5>
                    <p>Members can access meeting summaries, decisions, and action items from EC meetings.</p>
                    <a href="#" class="service-link" data-action="login" onclick="openMemberLoginModal()" title="Members only - Login required">
                        View Minutes <i class="fas fa-lock ms-1"></i>
                    </a>
                </div>
                
                <!-- Sponsorship -->
                <div class="service-card">
                    <div class="service-icon" style="background: linear-gradient(135deg, #D4AF37, #FFD700);"><i class="fas fa-handshake"></i></div>
                    <h5>Become a Sponsor</h5>
                    <p>Support BANF as a Platinum, Gold, Silver, or Bronze sponsor. Magazine ads & food sponsorships.</p>
                    <a href="#sponsors" class="service-link" data-action="sponsors">
                        Learn More <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== CAREERS & PROFESSIONAL NETWORK SECTION ========== -->
    <section id="careers-guidance" class="py-5" style="background: linear-gradient(180deg, #f8f9fa 0%, #fff 100%);">
        <div class="container">
            <div class="section-header">
                <h2>🎯 Careers & Professional Network</h2>
                <p>Connect with fellow BANF members for career guidance, mentorship, and professional networking</p>
            </div>

            <!-- Search & Filter Bar -->
            <div class="row mb-4 g-2">
                <div class="col-md-6">
                    <input type="text" class="form-control" placeholder="Search by name, skill, or industry..." id="careerSearch" oninput="renderCareerCards()">
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="industryFilter" onchange="renderCareerCards()">
                        <option value="">All Industries</option>
                        <option>Technology</option>
                        <option>Healthcare</option>
                        <option>Finance</option>
                        <option>Education</option>
                        <option>Engineering</option>
                        <option>Legal</option>
                        <option>Business</option>
                        <option>Arts & Media</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="guidanceFilter" onchange="renderCareerCards()">
                        <option value="">All Guidance Types</option>
                        <option>Career Mentorship</option>
                        <option>Resume Review</option>
                        <option>Interview Prep</option>
                        <option>Networking</option>
                        <option>Industry Insights</option>
                    </select>
                </div>
            </div>

            <!-- Member Cards Grid -->
            <div class="row g-4" id="careerCardGrid">
                <!-- Dynamically populated by renderCareerCards() -->
            </div>

            <div class="text-center mt-4">
                <p class="text-muted"><i class="fas fa-lock me-1"></i>Logged-in members can create their own career profile from the Member Portal.</p>
            </div>
        </div>
    </section>

    <!-- ========== EVENTS SECTION ========== -->
    <section class="py-5" id="events" style="background: #f8f9fa;">
        <div class="container">
            <div class="section-header">
                <h2>2026 Event Calendar</h2>
                <p>Join us for cultural celebrations and community gatherings</p>
            </div>
            <div class="row g-4">
                <!-- Saraswati Puja - COMPLETED -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Saraswati Puja', 'Feb 2, 2026', 'Basant Panchami • Temple', 'Food: Polao, Alu Fulkopi, Goat Curry')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #ffc107, #ff9800);">
                            📚
                            <span class="event-badge" style="background: #28a745;">✓ Completed</span>
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>Feb 2, 2026</span>
                            <h4>Saraswati Puja</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Basant Panchami • Temple</p>
                            <p class="small text-muted">Food: Polao, Alu Fulkopi, Goat Curry</p>
                        </div>
                    </div>
                </div>

                <!-- Bosonto Utsob - COMPLETED -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Bosonto Utsob', 'Mar 7, 2026', 'Spring Festival', 'Holi celebration & cultural program')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #E91E63, #FF69B4);">
                            🌸
                            <span class="event-badge" style="background: #28a745;">✓ Completed</span>
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>Mar 7, 2026</span>
                            <h4>Bosonto Utsob</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Spring Festival</p>
                            <p class="small text-muted">Holi celebration & cultural program</p>
                        </div>
                    </div>
                </div>

                <!-- Nabo Borsho / Pohela Boishakh -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Nabo Borsho 1433', 'April 25, 2026', 'Bengali New Year', 'Pohela Boishakh celebration')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #E91E63, #FF5722);">
                            🎉
                            <span class="event-badge">Coming Soon</span>
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>April 25, 2026</span>
                            <h4>Nabo Borsho 1433</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Bengali New Year</p>
                            <p class="small text-muted">Pohela Boishakh celebration</p>
                        </div>
                    </div>
                </div>

                <!-- Summer Camp -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Summer Camp', 'June 2026', 'Youth Programs', 'Kids & youth activities')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #4CAF50, #8BC34A);">
                            🏕️
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>June 2026</span>
                            <h4>Summer Camp</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Youth Programs</p>
                            <p class="small text-muted">Kids & youth activities</p>
                        </div>
                    </div>
                </div>

                <!-- Spandan Cultural Night -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Spandan Cultural', 'August 7, 2026', 'Music, Dance & Drama', 'Theme: Sargam')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #006A4E, #00856F);">
                            🎭
                            <span class="event-badge">Title: Sargam</span>
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>August 7, 2026</span>
                            <h4>Spandan Cultural</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Music, Dance & Drama</p>
                            <p class="small text-muted">Theme: Sargam</p>
                        </div>
                    </div>
                </div>

                <!-- Mahalaya -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Mahalaya', 'October 17, 2026', 'Dawn Program', 'Puja inauguration')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #FFA500, #FF6347);">
                            🌅
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>October 17, 2026</span>
                            <h4>Mahalaya</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Dawn Program</p>
                            <p class="small text-muted">Puja inauguration</p>
                        </div>
                    </div>
                </div>

                <!-- Durga Puja -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Durga Puja 2026', 'October 2026', '230+ Attendees', '5-day puja celebration')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #8B0000, #A52A2A);">
                            🕉️
                            <span class="event-badge">Flagship Event</span>
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>October 2026</span>
                            <h4>Durga Puja 2026</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>230+ Attendees</p>
                            <p class="small text-muted">5-day puja celebration</p>
                        </div>
                    </div>
                </div>

                <!-- Kali Puja -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Kali Puja & Diwali', 'November 7, 2026', 'Festival of Lights', 'Lakshmi Puja & fireworks')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #1a1a2e, #4a148c);">
                            🪔
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>November 7, 2026</span>
                            <h4>Kali Puja & Diwali</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Festival of Lights</p>
                            <p class="small text-muted">Lakshmi Puja & fireworks</p>
                        </div>
                    </div>
                </div>

                <!-- Saraswati Puja 2027 -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('Saraswati Puja 2027', 'January 25, 2027', '+ Winter Picnic', 'Basant Panchami celebration')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #ffc107, #ff9800);">
                            📚
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>January 25, 2027</span>
                            <h4>Saraswati Puja 2027</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>+ Winter Picnic</p>
                            <p class="small text-muted">Basant Panchami celebration</p>
                        </div>
                    </div>
                </div>

                <!-- GBM -->
                <div class="col-md-4 col-lg-3">
                    <div class="event-card" onclick="openEventDetails('GBM & Budget Review', 'February 2027', 'Annual Meeting', 'FY 2026-27 Closing')" style="cursor: pointer;">
                        <div class="event-image" style="background: linear-gradient(135deg, #607D8B, #78909C);">
                            📋
                        </div>
                        <div class="event-content">
                            <span class="event-date"><i class="fas fa-calendar me-1"></i>February 2027</span>
                            <h4>GBM & Budget Review</h4>
                            <p class="event-location"><i class="fas fa-map-marker-alt"></i>Annual Meeting</p>
                            <p class="small text-muted">FY 2026-27 Closing</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a href="#" class="btn-primary-custom" onclick="if(window.parent){window.parent.postMessage({type:'NAVIGATE',target:'/events'},'*');}">
                    <i class="fas fa-calendar-alt me-2"></i>View Full Calendar
                </a>
                <a href="#" class="btn-outline-custom ms-2" onclick="openEventDetails('BANF 2026 Event Calendar', '2026', 'Jacksonville', 'Explore upcoming events and click any event card for details.'); return false;">
                    <i class="fas fa-info-circle me-2"></i>Event Details
                </a>
            </div>
        </div>
    </section>

    <!-- ========== RADIO SECTION ========== -->
    <section class="radio-section" id="radio">
        <div class="container">
            <div class="section-header">
                <h2 style="color: #fff;">BANF Radio</h2>
                <p style="color: rgba(255,255,255,0.8);">24/7 Bengali Music & Cultural Programs</p>
            </div>
            <div class="radio-player">
                <div class="radio-status">
                    <div class="live-dot"></div>
                    <span>LIVE NOW</span>
                </div>
                <h3 class="now-playing bengali-text">
                    🎵 Bengali Music Hour — Rabindra Sangeet Special
                </h3>
                <div class="radio-controls">
                    <button class="radio-btn" title="Previous"><i class="fas fa-backward"></i></button>
                    <button class="radio-btn" title="Play/Pause"><i class="fas fa-play"></i></button>
                    <button class="radio-btn" title="Next"><i class="fas fa-forward"></i></button>
                </div>
                <div class="radio-features">
                    <div class="radio-feature">
                        <i class="fas fa-music"></i>
                        <span>1000+ Songs</span>
                    </div>
                    <div class="radio-feature">
                        <i class="fas fa-microphone"></i>
                        <span>Live Shows</span>
                    </div>
                    <div class="radio-feature">
                        <i class="fas fa-heart"></i>
                        <span>Request Songs</span>
                    </div>
                    <div class="radio-feature">
                        <i class="fas fa-podcast"></i>
                        <span>Podcasts</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== JACKSONVILLE GUIDE ========== -->
    <section class="guide-section" id="guide">
        <div class="container">
            <div class="section-header">
                <h2>Jacksonville Newcomer Guide</h2>
                <p>Your comprehensive guide to Bengali-friendly resources in Jacksonville</p>
            </div>
            <div class="row g-4">
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #FF5722, #FF9800); color: #fff;">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <h5>Restaurants</h5>
                        <p>Indian & Bengali cuisine spots</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #4CAF50, #8BC34A); color: #fff;">
                            <i class="fas fa-shopping-basket"></i>
                        </div>
                        <h5>Grocery Stores</h5>
                        <p>Indian grocery & spices</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #2196F3, #03A9F4); color: #fff;">
                            <i class="fas fa-user-md"></i>
                        </div>
                        <h5>Healthcare</h5>
                        <p>Doctors & specialists</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #9C27B0, #E91E63); color: #fff;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h5>Schools</h5>
                        <p>Education resources</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #607D8B, #78909C); color: #fff;">
                            <i class="fas fa-home"></i>
                        </div>
                        <h5>Housing</h5>
                        <p>Apartments & realtors</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #795548, #8D6E63); color: #fff;">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <h5>Services</h5>
                        <p>Legal, financial & more</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #00BCD4, #009688); color: #fff;">
                            <i class="fas fa-store"></i>
                        </div>
                        <h5>Bengali-Owned</h5>
                        <p>Support our community</p>
                    </div>
                </div>
                <div class="col-md-3 col-6">
                    <div class="guide-card">
                        <div class="guide-icon" style="background: linear-gradient(135deg, #D4AF37, #FFC107); color: #fff;">
                            <i class="fas fa-star"></i>
                        </div>
                        <h5>Featured</h5>
                        <p>Top recommendations</p>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <a href="#" class="btn-primary-custom">
                    <i class="fas fa-map-marked-alt me-2"></i>Explore Full Guide
                </a>
                <a href="#" class="btn-outline-custom ms-2" style="border-color: var(--banf-orange); color: var(--banf-orange);">
                    <i class="fas fa-plus me-2"></i>Submit a Listing
                </a>
            </div>
        </div>
    </section>

    <!-- ========== SURVEYS & FEEDBACK SECTION ========== -->
    <section class="py-5" id="surveys" style="background: #fff;">
        <div class="container">
            <div class="section-header">
                <h2>Community Voice</h2>
                <p>Share your feedback and help shape our community</p>
            </div>
            <div class="row g-4 justify-content-center">
                <div class="col-md-5">
                    <div class="service-card" style="border: 2px solid rgba(255,152,0,0.3);">
                        <div class="service-icon" style="background: linear-gradient(135deg, #FF9800, #FFC107);"><i class="fas fa-poll"></i></div>
                        <h5>Active Surveys</h5>
                        <p>Participate in community polls and surveys. Your input helps us plan better events and services.</p>
                        <ul class="list-unstyled text-start mt-3 mb-3" style="font-size: 0.9rem;">
                            <li><i class="fas fa-check-circle text-success me-2"></i>Anonymous participation available</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>Member-only surveys for detailed feedback</li>
                            <li><i class="fas fa-check-circle text-success me-2"></i>View results (when enabled)</li>
                        </ul>
                        <a href="#" class="btn-primary-custom btn-sm" onclick="openSurveyModal(); return false;">
                            <i class="fas fa-clipboard-list me-2"></i>Take Survey
                        </a>
                    </div>
                </div>
                <div class="col-md-5" id="complaints">
                    <div class="service-card" style="border: 2px solid rgba(96,125,139,0.3);">
                        <div class="service-icon" style="background: linear-gradient(135deg, #607D8B, #455A64);"><i class="fas fa-shield-alt"></i></div>
                        <h5>Anonymous Complaints</h5>
                        <p>File confidential complaints or concerns. Your identity is fully protected.</p>
                        <ul class="list-unstyled text-start mt-3 mb-3" style="font-size: 0.9rem;">
                            <li><i class="fas fa-lock text-primary me-2"></i>100% anonymous submissions</li>
                            <li><i class="fas fa-key text-primary me-2"></i>Track status with access code</li>
                            <li><i class="fas fa-comments text-primary me-2"></i>Add follow-up messages</li>
                        </ul>
                        <a href="#" class="btn-primary-custom btn-sm" style="background: linear-gradient(135deg, #607D8B, #455A64);" onclick="openComplaintForm(); return false;">
                            <i class="fas fa-paper-plane me-2"></i>Submit Complaint
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== E-MAGAZINE SECTION ========== -->
    <section class="py-5" id="magazine" style="background: var(--cream);">
        <div class="container">
            <div class="section-header">
                <h2 class="bengali-text">📚 Jagriti E-Magazine</h2>
                <p>Community literary works — Articles, poems, stories & recipes</p>
            </div>
            <div class="row g-4 align-items-center">
                <div class="col-lg-6">
                    <div class="magazine-preview">
                        <div class="magazine-cover">
                            <i class="fas fa-book-reader"></i>
                        </div>
                        <div class="magazine-info">
                            <span class="badge bg-danger mb-2">Latest Issue</span>
                            <h4>Durga Puja 2025 Special Edition</h4>
                            <p class="text-muted">Featuring articles on Bengali traditions, community stories, and Puja memories.</p>
                            <div class="d-flex gap-2 flex-wrap">
                                <a href="#" class="btn-primary-custom btn-sm"><i class="fas fa-book-open me-1"></i>Read Now</a>
                                <a href="#" class="btn-outline-custom btn-sm" style="border-color: var(--banf-orange); color: var(--banf-orange);"><i class="fas fa-archive me-1"></i>Past Issues</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <h4 class="mb-3"><i class="fas fa-feather-alt me-2" style="color: var(--banf-orange);"></i>Content Categories</h4>
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="p-3 bg-white rounded-3 shadow-sm text-center">
                                <i class="fas fa-pen-fancy fa-2x mb-2" style="color: var(--banf-deep-red);"></i>
                                <h6 class="mb-0">Articles</h6>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-3 bg-white rounded-3 shadow-sm text-center">
                                <i class="fas fa-feather fa-2x mb-2" style="color: #9C27B0;"></i>
                                <h6 class="mb-0">Poems</h6>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-3 bg-white rounded-3 shadow-sm text-center">
                                <i class="fas fa-book fa-2x mb-2" style="color: #2196F3;"></i>
                                <h6 class="mb-0">Stories</h6>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-3 bg-white rounded-3 shadow-sm text-center">
                                <i class="fas fa-utensils fa-2x mb-2" style="color: #FF5722;"></i>
                                <h6 class="mb-0">Recipes</h6>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 p-3 rounded-3" style="background: linear-gradient(135deg, rgba(255,107,53,0.1), rgba(247,147,30,0.1)); border: 1px dashed var(--banf-orange);">
                        <h5 class="mb-2"><i class="fas fa-pencil-alt me-2"></i>Contribute Your Work</h5>
                        <p class="mb-2 small text-muted">Members can submit articles, poems, and stories for publication.</p>
                        <a href="#" class="btn btn-sm" style="background: var(--gradient-primary); color: #fff;"><i class="fas fa-paper-plane me-1"></i>Submit Article</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== SPONSORSHIP TIERS SECTION (PROPOSED) ========== -->
    <section class="py-5" id="sponsors" style="background: linear-gradient(135deg, #1a1a2e, #2d2d44); color: #fff;">
        <div class="container">
            <div class="section-header">
                <h2 style="color: #fff;">Sponsorship Opportunities</h2>
                <p style="color: rgba(255,255,255,0.8);">FY 2026-27 Season • Support Our Community</p>
            </div>
            
            <!-- Sponsorship Tiers Overview -->
            <div class="row justify-content-center mb-5">
                <div class="col-lg-10">
                    <div class="p-4 rounded-4 text-center" style="background: rgba(255,255,255,0.05); border: 2px solid var(--gold);">
                        <h4 style="color: var(--gold);"><i class="fas fa-gem me-2"></i>Partner With BANF</h4>
                        <p class="text-white-50 mb-0">Support cultural preservation and community building in Northeast Florida</p>
                    </div>
                </div>
            </div>
            
            <!-- Title Sponsor -->
            <div class="row justify-content-center mb-4">
                <div class="col-lg-8">
                    <div class="p-4 rounded-4 text-center" style="background: linear-gradient(135deg, #FFD700, #FFA500); color: #1a1a2e;">
                        <h4 class="mb-2"><i class="fas fa-trophy me-2"></i>Title Sponsor - $3,000</h4>
                        <p class="mb-3"><strong>Event Naming Rights + All Platinum Benefits</strong></p>
                        <div class="row g-2 justify-content-center text-start" style="font-size: 0.9rem;">
                            <div class="col-md-6">
                                <i class="fas fa-check me-2"></i>Name your sponsored event (e.g., "[Your Brand] Spandan")<br>
                                <i class="fas fa-check me-2"></i>All Platinum-level benefits included<br>
                                <i class="fas fa-check me-2"></i>8 complimentary passes
                            </div>
                            <div class="col-md-6">
                                <i class="fas fa-check me-2"></i>Prime speaking opportunity at event<br>
                                <i class="fas fa-check me-2"></i>Exclusive branding on all event materials<br>
                                <i class="fas fa-check me-2"></i>Homepage banner + Monthly social media
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tier Cards Row -->
            <div class="row g-4 justify-content-center mb-5">
                <!-- Platinum -->
                <div class="col-lg-3 col-md-6">
                    <div class="h-100 p-4 rounded-4 text-center" style="background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(255,165,0,0.15)); border: 2px solid #FFD700;">
                        <div class="mb-3" style="color: #FFD700;">
                            <i class="fas fa-crown fa-3x"></i>
                        </div>
                        <h5 style="color: #FFD700;">Platinum</h5>
                        <div class="display-6 mb-2" style="color: #fff;">$5,000<small style="font-size: 0.4em;">/year</small></div>
                        <ul class="list-unstyled text-start small" style="color: rgba(255,255,255,0.85);">
                            <li><i class="fas fa-check text-success me-2"></i>8 complimentary passes</li>
                            <li><i class="fas fa-check text-success me-2"></i>Homepage banner all year</li>
                            <li><i class="fas fa-check text-success me-2"></i>Banner at ALL events</li>
                            <li><i class="fas fa-check text-success me-2"></i>Prime booth location</li>
                            <li><i class="fas fa-check text-success me-2"></i>Monthly social media</li>
                            <li><i class="fas fa-check text-success me-2"></i>Logo on all marketing</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Gold -->
                <div class="col-lg-3 col-md-6">
                    <div class="h-100 p-4 rounded-4 text-center" style="background: rgba(192,192,192,0.1); border: 2px solid #C0C0C0;">
                        <div class="mb-3" style="color: #C0C0C0;">
                            <i class="fas fa-medal fa-3x"></i>
                        </div>
                        <h5 style="color: #C0C0C0;">Gold</h5>
                        <div class="display-6 mb-2" style="color: #fff;">$2,000<small style="font-size: 0.4em;">/year</small></div>
                        <ul class="list-unstyled text-start small" style="color: rgba(255,255,255,0.85);">
                            <li><i class="fas fa-check text-success me-2"></i>4 complimentary passes</li>
                            <li><i class="fas fa-check text-success me-2"></i>Standard booth space</li>
                            <li><i class="fas fa-check text-success me-2"></i>Durga Puja + 2 events</li>
                            <li><i class="fas fa-check text-success me-2"></i>Quarterly social media</li>
                            <li><i class="fas fa-check text-success me-2"></i>Logo on event programs</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Silver -->
                <div class="col-lg-3 col-md-6">
                    <div class="h-100 p-4 rounded-4 text-center" style="background: rgba(205,127,50,0.1); border: 2px solid #CD7F32;">
                        <div class="mb-3" style="color: #CD7F32;">
                            <i class="fas fa-award fa-3x"></i>
                        </div>
                        <h5 style="color: #CD7F32;">Silver</h5>
                        <div class="display-6 mb-2" style="color: #fff;">$1,000<small style="font-size: 0.4em;">/year</small></div>
                        <ul class="list-unstyled text-start small" style="color: rgba(255,255,255,0.85);">
                            <li><i class="fas fa-check text-success me-2"></i>2 complimentary passes</li>
                            <li><i class="fas fa-check text-success me-2"></i>Banner at Durga Puja</li>
                            <li><i class="fas fa-check text-success me-2"></i>Logo on materials</li>
                            <li><i class="fas fa-check text-success me-2"></i>Annual newsletter feature</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Bronze -->
                <div class="col-lg-3 col-md-6">
                    <div class="h-100 p-4 rounded-4 text-center" style="background: rgba(128,128,128,0.1); border: 2px solid #6c757d;">
                        <div class="mb-3" style="color: #6c757d;">
                            <i class="fas fa-handshake fa-3x"></i>
                        </div>
                        <h5 style="color: #adb5bd;">Bronze</h5>
                        <div class="display-6 mb-2" style="color: #fff;">$500<small style="font-size: 0.4em;">/year</small></div>
                        <ul class="list-unstyled text-start small" style="color: rgba(255,255,255,0.85);">
                            <li><i class="fas fa-check text-success me-2"></i>1 complimentary pass</li>
                            <li><i class="fas fa-check text-success me-2"></i>Certificate of appreciation</li>
                            <li><i class="fas fa-check text-success me-2"></i>Name on sponsor board</li>
                            <li><i class="fas fa-check text-success me-2"></i>Logo in event program</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Call to Action -->
            <div class="row justify-content-center">
                <div class="col-lg-8 text-center">
                    <div class="p-4 rounded-3" style="background: rgba(255,255,255,0.05); border: 1px dashed rgba(255,255,255,0.3);">
                        <h5 style="color: #fff;"><i class="fas fa-star me-2" style="color: var(--gold);"></i>Ready to Partner With Us?</h5>
                        <p class="text-white-50 mb-3">Contact us to discuss sponsorship opportunities for FY 2026-27</p>
                        <a href="mailto:sponsors@jaxbengali.org" class="btn-primary-custom me-2">
                            <i class="fas fa-envelope me-2"></i>Contact for Sponsorship
                        </a>
                        <a href="#contact" class="btn-outline-custom" style="border-color: var(--gold); color: var(--gold);">
                            <i class="fas fa-phone me-2"></i>Get in Touch
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== ADMIN ADVERTISEMENT SECTION ========== -->
    <section class="py-4" id="admin-ads" style="background: #f8f9fa;">
        <div class="container">
            <div class="row g-4" id="ad-carousel-container">
                <!-- Ad Slot 1 - Business Ad -->
                <div class="col-12 col-sm-6 col-md-4" data-ad-slot="1">
                    <div class="ad-card h-100 p-4 rounded-4 text-center shadow-sm" style="background: white; border: 2px dashed #ccc; min-height: 200px;">
                        <div class="ad-content">
                            <i class="fas fa-bullhorn fa-3x mb-3" style="color: #FF6B35;"></i>
                            <h5>Advertise Here</h5>
                            <p class="text-muted small">Promote your business to the Bengali community</p>
                            <a href="mailto:ads@jaxbengali.org" class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-ad me-1"></i>Place Ad
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Ad Slot 2 - Featured Sponsor -->
                <div class="col-12 col-sm-6 col-md-4" data-ad-slot="2">
                    <div class="ad-card h-100 p-4 rounded-4 text-center shadow" style="background: linear-gradient(135deg, #006A4E, #00856F); color: white; min-height: 200px;">
                        <div class="ad-content">
                            <div style="font-size: 2rem; margin-bottom: 10px;">🍖</div>
                            <h5>Fresh Meats</h5>
                            <p class="small opacity-85">Quality Halal Meats & Indian Groceries</p>
                            <p class="small"><i class="fas fa-map-marker-alt"></i> Jacksonville, FL</p>
                            <span class="badge bg-warning text-dark">Proud Sponsor</span>
                        </div>
                    </div>
                </div>
                
                <!-- Ad Slot 3 - Community Announcement -->
                <div class="col-12 col-sm-6 col-md-4" data-ad-slot="3">
                    <div class="ad-card h-100 p-4 rounded-4 text-center shadow" style="background: linear-gradient(135deg, #8B0000, #A52A2A); color: white; min-height: 200px;">
                        <div class="ad-content">
                            <i class="fas fa-newspaper fa-2x mb-2"></i>
                            <h5>E-Magazine</h5>
                            <p class="small opacity-85">Submit articles, poems & stories for our annual publication!</p>
                            <a href="#" onclick="if(window.parent){window.parent.postMessage({type:'NAVIGATE',target:'/magazine'},'*');}" class="btn btn-sm btn-warning">
                                <i class="fas fa-pen me-1"></i>Submit Article
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Admin controls (hidden for non-admin users) -->
            <div id="ad-admin-controls" class="mt-3 text-center" style="display: none;">
                <button class="btn btn-sm btn-outline-secondary" onclick="openAdManager()">
                    <i class="fas fa-cog me-1"></i>Manage Advertisements (Admin)
                </button>
            </div>
        </div>
    </section>

    <!-- ========== MEMBERSHIP SECTION ========== -->
    <section class="membership-section" id="membership">
        <div class="container">
            <div class="section-header">
                <h2>Membership Plans</h2>
                <p style="color: rgba(255,255,255,0.8);">Join our community • FY 2026-27 Season</p>
            </div>
            
            <!-- Early Bird Alert Banner -->
            <div class="row justify-content-center mb-4">
                <div class="col-lg-10">
                    <div class="alert-box p-3 rounded-3 text-center" style="background: linear-gradient(135deg, #28a745, #20c997); color: #fff;">
                        <i class="fas fa-clock fa-lg me-2"></i>
                        <strong>⏰ Early Bird Pricing!</strong> Family membership $375 (save $25) - Register by March 31, 2026
                    </div>
                </div>
            </div>
            
            <!-- Member Portal Access Box -->
            <div class="row justify-content-center mb-5">
                <div class="col-lg-10">
                    <div class="member-portal-box p-4 rounded-4" style="background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border: 2px solid var(--gold);">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h4 style="color: #fff;"><i class="fas fa-user-lock me-2" style="color: var(--gold);"></i>Member Portal</h4>
                                <p style="color: rgba(255,255,255,0.85); margin-bottom: 0;">
                                    <strong>Already a member?</strong> Log in to access your profile, payment history, event registrations, and exclusive member content.
                                    <br><span class="small">New member who has paid fees? Click "Sign Up" to create your account.</span>
                                </p>
                            </div>
                            <div class="col-md-4 text-md-end mt-3 mt-md-0">
                                <button class="btn me-2" style="background: var(--gold); color: #1a1a2e; font-weight: 600;" onclick="openMemberPortal('login')">
                                    <i class="fas fa-sign-in-alt me-1"></i> Login
                                </button>
                                <button class="btn btn-outline-light" onclick="openMemberPortal('signup')">
                                    <i class="fas fa-user-plus me-1"></i> Sign Up
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row justify-content-center">
                <!-- Student Plan -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="pricing-card">
                        <div class="pricing-header" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);">
                            <h4><i class="fas fa-graduation-cap me-2"></i>Student</h4>
                            <p class="mb-2 opacity-75">Full-time Students</p>
                            <div class="pricing-price">
                                $165<span>/year</span>
                            </div>
                            <small class="opacity-75"><i class="fas fa-id-card me-1"></i>Valid student ID required</small>
                        </div>
                        <div class="pricing-body">
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Access to all events</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Newsletter subscription</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Member directory access</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Special programs</div>
                        </div>
                        <div class="pricing-footer">
                            <a href="mailto:membership@jaxbengali.org" class="btn btn-outline-light w-100">Select Plan</a>
                        </div>
                    </div>
                </div>
                
                <!-- Individual Plan -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="pricing-card">
                        <div class="pricing-header" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">
                            <h4><i class="fas fa-user me-2"></i>Individual</h4>
                            <p class="mb-2 opacity-75">Single Adult Member</p>
                            <div class="pricing-price">
                                $210<span>/year</span>
                            </div>
                            <small class="opacity-75"><i class="fas fa-star me-1"></i>Full membership benefits</small>
                        </div>
                        <div class="pricing-body">
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Access to all events</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Voting rights in elections</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Newsletter subscription</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Member directory access</div>
                        </div>
                        <div class="pricing-footer">
                            <a href="mailto:membership@jaxbengali.org" class="btn btn-outline-light w-100">Select Plan</a>
                        </div>
                    </div>
                </div>
                
                <!-- Couple Plan -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="pricing-card">
                        <div class="pricing-header" style="background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);">
                            <h4><i class="fas fa-heart me-2"></i>Couple</h4>
                            <p class="mb-2 opacity-75">2 Adults</p>
                            <div class="pricing-price">
                                $330<span>/year</span>
                            </div>
                            <small class="opacity-75"><i class="fas fa-users me-1"></i>Dual membership</small>
                        </div>
                        <div class="pricing-body">
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>All Individual benefits</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>2 adult members</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Priority registration</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Event discounts</div>
                        </div>
                        <div class="pricing-footer">
                            <a href="mailto:membership@jaxbengali.org" class="btn btn-outline-light w-100">Select Plan</a>
                        </div>
                    </div>
                </div>
                
                <!-- Family Plan (Featured) -->
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="pricing-card featured">
                        <div class="pricing-header">
                            <span class="badge bg-warning text-dark mb-2"><i class="fas fa-star me-1"></i>Most Popular</span>
                            <h4 style="color: #fff;"><i class="fas fa-users me-2"></i>Family</h4>
                            <p class="mb-2 opacity-75">2 Adults + Kids</p>
                            <div class="pricing-price">
                                $400<span>/year</span>
                            </div>
                            <small class="text-success"><i class="fas fa-tag me-1"></i>Early Bird: $375 (by Mar 31)</small>
                        </div>
                        <div class="pricing-body">
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>All Couple benefits</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>2 adults + children</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Priority event registration</div>
                            <div class="pricing-feature"><i class="fas fa-check-circle"></i>Family discounts on events</div>
                        </div>
                        <div class="pricing-footer">
                            <a href="mailto:membership@jaxbengali.org" class="btn w-100" style="background: var(--gradient-primary); color: white; border: none;">Select Plan</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Special Membership Options -->
            <div class="row justify-content-center mt-4">
                <div class="col-lg-10">
                    <div class="p-4 rounded-3 text-center" style="background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15);">
                        <h5 style="color: var(--gold);"><i class="fas fa-theater-masks me-2"></i>NEW! Selective Membership Plans</h5>
                        <p class="text-white opacity-85 mb-3">Can't attend all events? Choose the plan that fits your interests!</p>
                        <div class="row g-3 justify-content-center">
                            <div class="col-md-5">
                                <div class="p-3 rounded-3" style="background: rgba(255,255,255,0.1);">
                                    <h6 style="color: #FF69B4;"><i class="fas fa-music me-2"></i>Culture Special - $180</h6>
                                    <p class="small text-white-50 mb-0">Access to: Spandan, Nabo Borsho, Summer Camp</p>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="p-3 rounded-3" style="background: rgba(255,255,255,0.1);">
                                    <h6 style="color: #ffc107;"><i class="fas fa-om me-2"></i>Religious Special - $180</h6>
                                    <p class="small text-white-50 mb-0">Access to: Durga Puja, Kali Puja, Saraswati Puja</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Member Benefits Summary -->
            <div class="row mt-5">
                <div class="col-12">
                    <div class="p-4 rounded-3" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);">
                        <h5 class="text-center mb-4" style="color: #fff;"><i class="fas fa-gift me-2"></i>Exclusive Member Benefits</h5>
                        <div class="row g-3 text-center">
                            <div class="col-6 col-md-3">
                                <div class="p-3" style="color: rgba(255,255,255,0.9);">
                                    <i class="fas fa-file-alt fa-2x mb-2" style="color: var(--gold);"></i>
                                    <h6 class="mb-0">Meeting Minutes</h6>
                                    <small class="opacity-75">Access EC meeting summaries</small>
                                </div>
                            </div>
                            <div class="col-6 col-md-3">
                                <div class="p-3" style="color: rgba(255,255,255,0.9);">
                                    <i class="fas fa-ticket-alt fa-2x mb-2" style="color: var(--gold);"></i>
                                    <h6 class="mb-0">Event Discounts</h6>
                                    <small class="opacity-75">Special member pricing</small>
                                </div>
                            </div>
                            <div class="col-6 col-md-3">
                                <div class="p-3" style="color: rgba(255,255,255,0.9);">
                                    <i class="fas fa-pen-fancy fa-2x mb-2" style="color: var(--gold);"></i>
                                    <h6 class="mb-0">Submit Articles</h6>
                                    <small class="opacity-75">Contribute to E-Magazine</small>
                                </div>
                            </div>
                            <div class="col-6 col-md-3">
                                <div class="p-3" style="color: rgba(255,255,255,0.9);">
                                    <i class="fas fa-star fa-2x mb-2" style="color: var(--gold);"></i>
                                    <h6 class="mb-0">Write Reviews</h6>
                                    <small class="opacity-75">Rate Jacksonville Guide listings</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== PHOTO GALLERY SECTION ========== -->
    <section class="py-5" id="photos" style="background: #f8f9fa;">
        <div class="container">
            <div class="section-header">
                <h2>Photo Gallery</h2>
                <p>Relive our cherished moments together</p>
            </div>
            
            <!-- Featured Albums Grid -->
            <div class="row g-4">
                <!-- Durga Puja 2025 -->
                <div class="col-md-4">
                    <div class="photo-album-card position-relative overflow-hidden rounded-4 shadow" style="height: 250px; cursor: pointer;" onclick="PhotoGallery.openGallery('durga-puja-2025')">
                        <div style="background: linear-gradient(135deg, #8B0000, #A52A2A); height: 100%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 4rem;">🕉️</span>
                        </div>
                        <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: linear-gradient(transparent, rgba(0,0,0,0.8));">
                            <h5 class="text-white mb-1">Durga Puja 2025</h5>
                            <small class="text-white-50"><i class="fas fa-images me-1"></i>150+ Photos</small>
                        </div>
                        <span class="badge bg-success position-absolute top-0 end-0 m-2">Public</span>
                    </div>
                </div>
                
                <!-- Saraswati Puja 2026 -->
                <div class="col-md-4">
                    <div class="photo-album-card position-relative overflow-hidden rounded-4 shadow" style="height: 250px; cursor: pointer;" onclick="PhotoGallery.openGallery('saraswati-puja-2026')">
                        <div style="background: linear-gradient(135deg, #ffc107, #ff9800); height: 100%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 4rem;">📚</span>
                        </div>
                        <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: linear-gradient(transparent, rgba(0,0,0,0.8));">
                            <h5 class="text-white mb-1">Saraswati Puja 2026</h5>
                            <small class="text-white-50"><i class="fas fa-images me-1"></i>75+ Photos</small>
                        </div>
                        <span class="badge bg-success position-absolute top-0 end-0 m-2">Public</span>
                    </div>
                </div>
                
                <!-- Members Only Album -->
                <div class="col-md-4">
                    <div class="photo-album-card position-relative overflow-hidden rounded-4 shadow" style="height: 250px; cursor: pointer;" onclick="PhotoGallery.requestMemberAccess() && PhotoGallery.openGallery('members-collection')">
                        <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); height: 100%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 4rem;">🔐</span>
                        </div>
                        <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: linear-gradient(transparent, rgba(0,0,0,0.8));">
                            <h5 class="text-white mb-1">Member Photos</h5>
                            <small class="text-white-50"><i class="fas fa-lock me-1"></i>Login Required</small>
                        </div>
                        <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2">
                            <i class="fas fa-user-lock me-1"></i>Members Only
                        </span>
                    </div>
                </div>
                
                <!-- Winter Picnic 2026 -->
                <div class="col-md-4">
                    <div class="photo-album-card position-relative overflow-hidden rounded-4 shadow" style="height: 250px; cursor: pointer;" onclick="PhotoGallery.openGallery('winter-picnic-2026')">
                        <div style="background: linear-gradient(135deg, #2196F3, #03A9F4); height: 100%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 4rem;">🧺</span>
                        </div>
                        <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: linear-gradient(transparent, rgba(0,0,0,0.8));">
                            <h5 class="text-white mb-1">Winter Picnic 2026</h5>
                            <small class="text-white-50"><i class="fas fa-images me-1"></i>50+ Photos</small>
                        </div>
                        <span class="badge bg-success position-absolute top-0 end-0 m-2">Public</span>
                    </div>
                </div>
                
                <!-- Spandan 2025 -->
                <div class="col-md-4">
                    <div class="photo-album-card position-relative overflow-hidden rounded-4 shadow" style="height: 250px; cursor: pointer;" onclick="PhotoGallery.openGallery('spandan-2025')">
                        <div style="background: linear-gradient(135deg, #006A4E, #00856F); height: 100%; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 4rem;">🎭</span>
                        </div>
                        <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: linear-gradient(transparent, rgba(0,0,0,0.8));">
                            <h5 class="text-white mb-1">Spandan 2025</h5>
                            <small class="text-white-50"><i class="fas fa-images me-1"></i>100+ Photos</small>
                        </div>
                        <span class="badge bg-success position-absolute top-0 end-0 m-2">Public</span>
                    </div>
                </div>
                
                <!-- View All Albums -->
                <div class="col-md-4">
                    <div class="photo-album-card position-relative overflow-hidden rounded-4" style="height: 250px; cursor: pointer; border: 3px dashed #dee2e6; background: white; display: flex; align-items: center; justify-content: center;" onclick="if(window.parent){window.parent.postMessage({type:'NAVIGATE',target:'/photos'},'*');}">
                        <div class="text-center">
                            <i class="fas fa-photo-video fa-4x mb-3" style="color: #6c757d;"></i>
                            <h5 style="color: #333;">View All Albums</h5>
                            <p class="text-muted small mb-0">Browse complete photo collection</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Photo Submission CTA -->
            <div class="row mt-5">
                <div class="col-12">
                    <div class="p-4 rounded-4 text-center" style="background: linear-gradient(135deg, var(--banf-saffron), var(--banf-orange));">
                        <h5 class="text-white mb-2"><i class="fas fa-upload me-2"></i>Share Your Photos!</h5>
                        <p class="text-white opacity-85 mb-3">Members can submit photos from events for the community gallery</p>
                        <button class="btn btn-light" onclick="openMemberPortal('login')">
                            <i class="fas fa-cloud-upload-alt me-2"></i>Submit Photos
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== CONTACT SECTION ========== -->
    <section class="contact-section" id="contact">
        <div class="container">
            <div class="section-header">
                <h2>Get in Touch</h2>
                <p>Have questions? We'd love to hear from you</p>
            </div>
            <div class="row g-4">
                <div class="col-lg-6">
                    <form class="contact-form">
                        <div class="form-group">
                            <label><i class="fas fa-user me-2"></i>Your Name</label>
                            <input type="text" class="form-control" placeholder="Enter your name" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-envelope me-2"></i>Email Address</label>
                            <input type="email" class="form-control" placeholder="Enter your email" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-tag me-2"></i>Subject</label>
                            <select class="form-control">
                                <option>General Inquiry</option>
                                <option>Membership Question</option>
                                <option>Event Information</option>
                                <option>Sponsorship</option>
                                <option>Volunteer</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-comment me-2"></i>Message</label>
                            <textarea class="form-control" placeholder="Your message..." required></textarea>
                        </div>
                        <button type="submit" class="submit-btn">
                            <i class="fas fa-paper-plane me-2"></i>Send Message
                        </button>
                    </form>
                </div>
                <div class="col-lg-6">
                    <div class="contact-info-card">
                        <h4 class="mb-4"><i class="fas fa-address-card me-2" style="color: var(--banf-orange);"></i>Contact Information</h4>
                        
                        <div class="contact-info-item">
                            <i class="fas fa-envelope"></i>
                            <div>
                                <strong>Email</strong><br>
                                <a href="mailto:info@jaxbengali.org">info@jaxbengali.org</a>
                            </div>
                        </div>
                        
                        <div class="contact-info-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <div>
                                <strong>Location</strong><br>
                                Jacksonville, Florida, USA
                            </div>
                        </div>
                        
                        <div class="contact-info-item">
                            <i class="fas fa-globe"></i>
                            <div>
                                <strong>Website</strong><br>
                                <a href="https://www.jaxbengali.org">www.jaxbengali.org</a>
                            </div>
                        </div>
                        
                        <div class="contact-info-item">
                            <i class="fas fa-clock"></i>
                            <div>
                                <strong>Office Hours</strong><br>
                                By Appointment Only
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <h5 class="mb-3">Follow Us</h5>
                        <div class="social-links">
                            <a href="https://facebook.com/banfjax" class="social-link" target="_blank" title="Facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="https://instagram.com/banfjax" class="social-link" target="_blank" title="Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="https://youtube.com/@banfjacksonville" class="social-link" target="_blank" title="YouTube">
                                <i class="fab fa-youtube"></i>
                            </a>
                            <a href="https://twitter.com/banfjax" class="social-link" target="_blank" title="Twitter">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Profile modals are now dynamically generated by openProfileModal() from EC_MEMBERS data -->

    <!-- ========== FOOTER ========== -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h5><i class="fas fa-om me-2"></i>About BANF</h5>
                    <p>Bengali Association of North Florida — Preserving and celebrating Bengali culture, heritage, and traditions in Jacksonville since 2008.</p>
                    <div class="social-links">
                        <a href="https://facebook.com/banfjax" class="social-link"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://instagram.com/banfjax" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="https://youtube.com/@banfjacksonville" class="social-link"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h5>Quick Links</h5>
                    <a href="#about"><i class="fas fa-info-circle me-2"></i>About Us</a>
                    <a href="#events"><i class="fas fa-calendar me-2"></i>Events</a>
                    <a href="#membership"><i class="fas fa-users me-2"></i>Membership</a>
                    <a href="#ec-team"><i class="fas fa-user-tie me-2"></i>Leadership</a>
                    <a href="#sponsors"><i class="fas fa-handshake me-2"></i>Sponsors</a>
                </div>
                <div class="footer-section">
                    <h5>Services</h5>
                    <a href="#radio"><i class="fas fa-broadcast-tower me-2"></i>BANF Radio</a>
                    <a href="#magazine"><i class="fas fa-book-open me-2"></i>E-Magazine</a>
                    <a href="#guide"><i class="fas fa-map me-2"></i>Jax Guide</a>
                    <a href="#surveys"><i class="fas fa-poll me-2"></i>Surveys</a>
                    <a href="#complaints"><i class="fas fa-shield-alt me-2"></i>Complaints</a>
                </div>
                <div class="footer-section">
                    <h5>Contact Info</h5>
                    <p><i class="fas fa-envelope me-2"></i>info@jaxbengali.org</p>
                    <p><i class="fas fa-map-marker-alt me-2"></i>Jacksonville, FL</p>
                    <p><i class="fas fa-globe me-2"></i>www.jaxbengali.org</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2026 Bengali Association of North Florida (BANF). All rights reserved.</p>
                <p class="mt-2" style="font-size: 0.85rem; opacity: 0.7;">
                    <i class="fas fa-code me-1"></i>Built with ❤️ for the Jacksonville Bengali Community
                </p>
            </div>
        </div>
    </footer>

    <!-- ========== SCRIPTS ========== -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SheetJS for Excel (.xlsx/.xls) parsing — Feature 7 -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <script>
        // ========== PROFILE MODAL FUNCTIONS ==========

        // ===== Feature 4: EC Member Data Array (single source of truth) =====
        const EC_MEMBERS = [
            {
                id: 'rana',
                name: 'Dr. Ranadhir Ghosh',
                firstName: 'Ranadhir',
                role: 'President',
                positionStyle: '',
                photoUrl: 'https://static.wixstatic.com/media/c62f94_d6f7e8a5b3c14f4f8a7f9e0d1c2b3a4d~mv2.jpg/v1/fill/w_200,h_200,al_c,q_80/rana.jpg',
                fallbackInitials: 'RG',
                fallbackGradient: 'linear-gradient(135deg, #DC143C, #8B0000)',
                bio: 'AI thought leader & educator. Rooted in philosophy, arts & music.',
                email: 'president@jaxbengali.org',
                linkedin: '#',
                hasProfile: true,
                profileData: {
                    fullBio: 'Visionary leader blending technology, philosophy, and community building. Dr. Ghosh brings expertise in AI/ML, data engineering, and cultural arts to drive BANF\'s digital transformation.',
                    education: 'Ph.D., Computer Science',
                    profession: 'AI/ML Engineering Lead',
                    interests: ['AI & Machine Learning', 'Bengali Literature', 'Rabindra Sangeet', 'Philosophy'],
                    quote: '"Technology should serve culture, and culture should inspire technology."',
                    yearJoined: 2020
                }
            },
            {
                id: 'partha',
                name: 'Partha Mukhopadhyay',
                firstName: 'Partha',
                role: 'Vice President',
                positionStyle: 'background: var(--gradient-green);',
                photoUrl: 'https://static.wixstatic.com/media/c62f94_vp_partha~mv2.jpg/v1/fill/w_200,h_200,al_c,q_80/partha.jpg',
                fallbackInitials: 'PM',
                fallbackGradient: 'linear-gradient(135deg, #006A4E, #00856F)',
                bio: 'Deputy Executive & Operations Leadership',
                email: 'vp@jaxbengali.org',
                linkedin: '#',
                hasProfile: false,
                profileData: {
                    fullBio: 'Deputy executive overseeing operations and strategic planning for BANF community initiatives.',
                    profession: 'Operations Leader',
                    interests: ['Community Service', 'Strategic Planning'],
                    yearJoined: 2021
                }
            },
            {
                id: 'amit',
                name: 'Amit Chandak',
                firstName: 'Amit',
                role: 'Treasurer',
                positionStyle: 'background: linear-gradient(135deg, #D4AF37, #E5C158);',
                photoUrl: null,
                fallbackInitials: 'AC',
                fallbackGradient: 'linear-gradient(135deg, #D4AF37, #E5C158)',
                bio: 'Financial Management',
                email: 'treasurer@jaxbengali.org',
                linkedin: '#',
                hasProfile: false,
                profileData: {
                    fullBio: 'Managing BANF\'s financial operations including budgeting, payments, and sponsorship accounting.',
                    profession: 'Finance Professional',
                    interests: ['Financial Planning', 'Community Volunteering'],
                    yearJoined: 2022
                }
            },
            {
                id: 'rajanya',
                name: 'Rajanya Ghosh',
                firstName: 'Rajanya',
                role: 'Gen. Secretary',
                positionStyle: 'background: linear-gradient(135deg, #8B0000, #a52a2a);',
                photoUrl: 'https://static.wixstatic.com/media/c62f94_gs_rajanya~mv2.jpg/v1/fill/w_200,h_200,al_c,q_80/rajanya.jpg',
                fallbackInitials: 'RG',
                fallbackGradient: 'linear-gradient(135deg, #8B0000, #a52a2a)',
                bio: 'Future leader, passionate about culture & community service.',
                email: 'secretary@jaxbengali.org',
                linkedin: '#',
                hasProfile: true,
                profileData: {
                    fullBio: 'Young, passionate leader dedicated to bridging generations within the Bengali community. Rajanya drives organizational excellence and community engagement.',
                    profession: 'Student Leader',
                    interests: ['Cultural Arts', 'Youth Leadership', 'Community Outreach'],
                    yearJoined: 2023
                }
            },
            {
                id: 'moumita',
                name: 'Dr. Moumita Ghosh',
                firstName: 'Moumita',
                role: 'Cultural Sec.',
                positionStyle: 'background: linear-gradient(135deg, #9C27B0, #E91E63);',
                photoUrl: 'https://static.wixstatic.com/media/c62f94_cs_moumita~mv2.jpg/v1/fill/w_200,h_200,al_c,q_80/moumita.jpg',
                fallbackInitials: 'MG',
                fallbackGradient: 'linear-gradient(135deg, #9C27B0, #E91E63)',
                bio: 'Creative visionary, educator, and cultural program director.',
                email: 'cultural@jaxbengali.org',
                linkedin: '#',
                hasProfile: false,
                profileData: {
                    fullBio: 'A creative visionary and educator who directs BANF\'s cultural programs — from Rabindra Jayanti to Durga Puja cultural evenings.',
                    education: 'Ph.D., Education',
                    profession: 'Educator & Cultural Director',
                    interests: ['Dance', 'Rabindra Sangeet', 'Cultural Programming', 'Education'],
                    yearJoined: 2021
                }
            },
            {
                id: 'banty',
                name: 'Banty Dutta',
                firstName: 'Banty',
                role: 'Food Coord.',
                positionStyle: 'background: linear-gradient(135deg, #FF5722, #FF9800);',
                photoUrl: null,
                fallbackInitials: 'BD',
                fallbackGradient: 'linear-gradient(135deg, #FF5722, #FF9800)',
                bio: 'Food & Catering',
                email: 'food@jaxbengali.org',
                linkedin: '#',
                hasProfile: false,
                profileData: {
                    fullBio: 'Coordinates authentic Bengali cuisine for all BANF events, managing vendor relationships and menu planning.',
                    profession: 'Food & Catering Coordinator',
                    interests: ['Bengali Cuisine', 'Event Catering', 'Vendor Management'],
                    yearJoined: 2023
                }
            },
            {
                id: 'sumanta',
                name: 'Dr. Sumanta Ghosh',
                firstName: 'Sumanta',
                role: 'Event Coord.',
                positionStyle: 'background: linear-gradient(135deg, #2196F3, #03A9F4);',
                photoUrl: null,
                fallbackInitials: 'SG',
                fallbackGradient: 'linear-gradient(135deg, #2196F3, #03A9F4)',
                bio: 'Event Planning & Logistics',
                email: 'events@jaxbengali.org',
                linkedin: '#',
                hasProfile: false,
                profileData: {
                    fullBio: 'Manages end-to-end event planning and logistics for BANF\'s community gatherings and celebrations.',
                    profession: 'Event Planner',
                    interests: ['Event Management', 'Community Building', 'Logistics'],
                    yearJoined: 2022
                }
            },
            {
                id: 'rwiti',
                name: 'Rwiti Choudhury',
                firstName: 'Rwiti',
                role: 'Puja Coord.',
                positionStyle: 'background: linear-gradient(135deg, #673AB7, #9C27B0);',
                photoUrl: null,
                fallbackInitials: 'RC',
                fallbackGradient: 'linear-gradient(135deg, #673AB7, #9C27B0)',
                bio: 'Puja Coordination',
                email: 'puja@jaxbengali.org',
                linkedin: '#',
                hasProfile: false,
                profileData: {
                    fullBio: 'Coordinates Durga Puja and other religious/cultural ceremonies for the BANF community.',
                    profession: 'Puja Coordinator',
                    interests: ['Puja Organization', 'Cultural Traditions', 'Volunteer Management'],
                    yearJoined: 2023
                }
            }
        ];

        /**
         * Render EC team cards dynamically from EC_MEMBERS data array (Feature 4)
         */
        function renderECTeam() {
            const grid = document.getElementById('ec-team-grid');
            if (!grid) return;
            grid.innerHTML = EC_MEMBERS.map(m => `
                <div class="col-lg-3 col-md-4 col-6">
                    <div class="ec-card">
                        <div class="ec-avatar-wrapper">
                            ${m.photoUrl
                                ? `<img src="${m.photoUrl}" alt="${m.name}" class="ec-avatar-img" onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">
                                   <div class="ec-avatar" style="background:${m.fallbackGradient};display:none;">${m.fallbackInitials}</div>`
                                : `<div class="ec-avatar" style="background:${m.fallbackGradient};">${m.fallbackInitials}</div>`
                            }
                        </div>
                        <span class="ec-position" ${m.positionStyle ? `style="${m.positionStyle}"` : ''}>${m.role}</span>
                        <h6>${m.name}</h6>
                        <p class="ec-short-bio">${m.bio}</p>
                        <a class="ec-view-profile" onclick="openProfileModal('${m.id}')" style="cursor:pointer;"><i class="fas fa-user-circle me-1"></i>View Profile</a>
                        <div class="ec-contact mt-2">
                            <a href="mailto:${m.email}" title="Email"><i class="fas fa-envelope"></i></a>
                            <a href="${m.linkedin}" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        /**
         * Open EC Member Profile Modal (Feature 5: dynamic modal from EC_MEMBERS data)
         */
        function openProfileModal(memberId) {
            const member = EC_MEMBERS.find(m => m.id === memberId);
            if (!member) return;

            // Remove existing dynamic modal if any
            const existing = document.getElementById('ecProfileModal');
            if (existing) existing.remove();

            const pd = member.profileData || {};
            const interestsHtml = (pd.interests || []).map(i => `<span class="badge bg-primary bg-opacity-75 me-1 mb-1">${i}</span>`).join('');
            
            const modalHtml = `
            <div class="modal fade" id="ecProfileModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 2px solid var(--gold); border-radius: 20px; overflow: hidden;">
                        <div class="modal-header border-0" style="background: ${member.fallbackGradient}; padding: 2rem;">
                            <div class="d-flex align-items-center gap-3 w-100">
                                <div style="width:80px;height:80px;border-radius:50%;overflow:hidden;border:3px solid rgba(255,255,255,0.5);flex-shrink:0;">
                                    ${member.photoUrl
                                        ? `<img src="${member.photoUrl}" alt="${member.name}" style="width:100%;height:100%;object-fit:cover;" onerror="this.parentElement.innerHTML='<div style=\\'display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:1.5rem;font-weight:bold;color:#fff;background:${member.fallbackGradient.replace(/'/g, "\\'")}\\'>${member.fallbackInitials}</div>'">`
                                        : `<div style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:1.5rem;font-weight:bold;color:#fff;background:${member.fallbackGradient}">${member.fallbackInitials}</div>`
                                    }
                                </div>
                                <div>
                                    <h4 class="text-white mb-1">${member.name}</h4>
                                    <span class="badge" style="background: rgba(255,255,255,0.2); font-size: 0.9rem;">${member.role}</span>
                                </div>
                            </div>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body p-4">
                            ${pd.quote ? `<blockquote class="blockquote text-center mb-4"><p class="text-warning fst-italic" style="font-size:1rem;">${pd.quote}</p></blockquote>` : ''}
                            <div class="row g-4">
                                <div class="col-md-8">
                                    <h6 class="text-warning mb-2"><i class="fas fa-user me-2"></i>About</h6>
                                    <p class="text-light">${pd.fullBio || member.bio}</p>
                                    ${pd.education ? `<p class="text-light mb-1"><i class="fas fa-graduation-cap me-2 text-info"></i><strong>Education:</strong> ${pd.education}</p>` : ''}
                                    ${pd.profession ? `<p class="text-light mb-3"><i class="fas fa-briefcase me-2 text-info"></i><strong>Profession:</strong> ${pd.profession}</p>` : ''}
                                </div>
                                <div class="col-md-4">
                                    <h6 class="text-warning mb-2"><i class="fas fa-info-circle me-2"></i>Details</h6>
                                    <p class="text-light mb-1"><i class="fas fa-envelope me-2 text-muted"></i><a href="mailto:${member.email}" class="text-info" style="text-decoration:none">${member.email}</a></p>
                                    ${pd.yearJoined ? `<p class="text-light mb-1"><i class="fas fa-calendar-alt me-2 text-muted"></i>EC since ${pd.yearJoined}</p>` : ''}
                                    ${interestsHtml ? `<div class="mt-3"><h6 class="text-warning mb-2"><i class="fas fa-heart me-2"></i>Interests</h6>${interestsHtml}</div>` : ''}
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer border-0">
                            <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>`;

            document.body.insertAdjacentHTML('beforeend', modalHtml);
            const modal = new bootstrap.Modal(document.getElementById('ecProfileModal'));
            modal.show();

            // Clean up on close
            document.getElementById('ecProfileModal').addEventListener('hidden.bs.modal', function() {
                this.remove();
            });
        }

        // ========== RADIO PLAYER FUNCTIONALITY ==========
        let radioAudio = null;
        let isRadioPlaying = false;
        let currentSchedule = [];
        let currentProgramIndex = 0;
        let currentProgram = null;
        
        // ========== API CONFIGURATION ==========
        // All API calls route through Wix Velo HTTP Functions at /_functions/
        const WIX_SITE_URL = 'https://www.jaxbengali.org';
        const WIX_API_BASE = WIX_SITE_URL + '/_functions';
        const GMAIL_API_BASE = WIX_API_BASE;
        const RADIO_API_BASE = WIX_API_BASE;
        const RADIO_ENDPOINTS = {
            schedule: `${WIX_API_BASE}/radio_schedule`,
            currentStatus: `${WIX_API_BASE}/radio_status`,
            startCurrent: `${WIX_API_BASE}/radio_start`,
            nextTrack: `${WIX_API_BASE}/radio_next`,
            previousTrack: `${WIX_API_BASE}/radio_previous`
        };
        
        /**
         * API endpoint mapper - translates REST paths to Wix Velo HTTP Function paths
         * e.g. '/send-evite' → https://www.jaxbengali.org/_functions/send_evite
         */
        function apiUrl(endpoint) {
            // Map REST paths → Wix flat function names
            const routeMap = {
                '/status':          '/email_status',
                '/unread':          '/email_unread',
                '/send':            '/send_email',
                '/send-evite':      '/send_evite',
                '/contacts':        '/contacts',
                '/contacts/group':  '/contact_group_create',
                '/rsvp-check':      '/rsvp_check'
            };
            
            // Direct mapping
            if (routeMap[endpoint]) return WIX_API_BASE + routeMap[endpoint];
            
            // Dynamic paths with parameters
            if (endpoint.startsWith('/inbox'))   return WIX_API_BASE + '/email_inbox' + endpoint.replace('/inbox', '');
            if (endpoint.startsWith('/search'))  return WIX_API_BASE + '/email_search' + endpoint.replace('/search', '');
            if (endpoint.startsWith('/email/'))  return WIX_API_BASE + '/email_message?id=' + endpoint.split('/email/')[1].split('?')[0] + (endpoint.includes('?') ? '&' + endpoint.split('?')[1] : '');
            if (endpoint.startsWith('/mark-read/')) return WIX_API_BASE + '/email_mark_read';
            if (endpoint.startsWith('/delete/'))    return WIX_API_BASE + '/email_delete';
            if (endpoint.includes('/contacts/group/') && endpoint.includes('/add'))    return WIX_API_BASE + '/contact_group_add';
            if (endpoint.includes('/contacts/group/') && endpoint.includes('/remove')) return WIX_API_BASE + '/contact_group_remove';
            if (endpoint.match(/\/contacts\/group\/[^/]+$/)) return WIX_API_BASE + '/contact_group_delete';
            
            // Fallback
            return WIX_API_BASE + endpoint.replace(/-/g, '_').replace(/\//g, '_');
        }
        
        /**
         * Enhanced fetch wrapper for Wix API compatibility
         * - Converts DELETE methods to POST (Wix HTTP functions only support GET/POST)
         * - Adds group_name/id to body for Wix endpoints that need it
         */
        function apiFetch(endpoint, options = {}) {
            let url = apiUrl(endpoint);
            let opts = { ...options };
            
            // Wix only supports GET and POST - convert DELETE to POST
            if (opts.method === 'DELETE') {
                opts.method = 'POST';
                const deleteIdMatch = endpoint.match(/\/delete\/(.+)/);
                if (deleteIdMatch) {
                    opts.headers = opts.headers || { 'Content-Type': 'application/json' };
                    opts.body = JSON.stringify({ id: deleteIdMatch[1] });
                }
            }
            
            // For mark-read, extract ID from URL into body
            const markReadMatch = endpoint.match(/\/mark-read\/(.+)/);
            if (markReadMatch) {
                opts.method = 'POST';
                opts.headers = { 'Content-Type': 'application/json' };
                opts.body = JSON.stringify({ id: markReadMatch[1] });
            }
            
            // For contact group operations, extract group name from URL into body
            const groupMatch = endpoint.match(/\/contacts\/group\/([^/]+)/);
            if (groupMatch) {
                const groupName = decodeURIComponent(groupMatch[1]);
                opts.method = opts.method || 'POST';
                opts.headers = opts.headers || { 'Content-Type': 'application/json' };
                
                if (endpoint.includes('/add') || endpoint.includes('/remove')) {
                    let existingBody = {};
                    try { existingBody = JSON.parse(opts.body || '{}'); } catch(e) {}
                    existingBody.group_name = groupName;
                    opts.body = JSON.stringify(existingBody);
                } else if (opts.method === 'POST' && !endpoint.includes('/add') && !endpoint.includes('/remove')) {
                    opts.body = JSON.stringify({ group_name: groupName });
                }
            }
            
            return fetch(url, opts);
        }

        /**
         * Safe API fetch — checks HTTP status and parses JSON safely.
         * Returns { ok, status, data } instead of raw Response.
         * Handles 404 (endpoint not deployed) and non-JSON responses gracefully.
         */
        async function safeApiFetch(endpoint, options = {}) {
            try {
                const r = await apiFetch(endpoint, options);
                if (r.status === 404) {
                    return { ok: false, status: 404, data: { error: 'API endpoint not found. Wix Velo backend may not be published yet.' } };
                }
                if (!r.ok) {
                    const txt = await r.text().catch(() => '');
                    return { ok: false, status: r.status, data: { error: txt || `HTTP ${r.status}` } };
                }
                const contentType = r.headers.get('content-type') || '';
                if (!contentType.includes('application/json')) {
                    const txt = await r.text().catch(() => '');
                    if (txt.startsWith('{') || txt.startsWith('[')) {
                        try { return { ok: true, status: r.status, data: JSON.parse(txt) }; } catch(e) {}
                    }
                    return { ok: false, status: r.status, data: { error: 'Non-JSON response from server' } };
                }
                const d = await r.json();
                return { ok: true, status: r.status, data: d };
            } catch(e) {
                return { ok: false, status: 0, data: { error: e.message || 'Network error' } };
            }
        }
        
        // Program categories with display info
        const PROGRAM_CATEGORIES = {
            'Classical_Music': { name: 'Classical Music', icon: '🎻', color: '#8B4513' },
            'Folk_Music': { name: 'Folk Music', icon: '🪘', color: '#228B22' },
            'Modern_Music': { name: 'Modern Music', icon: '🎵', color: '#4169E1' },
            'Literature': { name: 'Literature', icon: '📚', color: '#800080' },
            'Philosophy': { name: 'Philosophy', icon: '🧘', color: '#DAA520' },
            'Devotional': { name: 'Devotional', icon: '🙏', color: '#FF6347' },
            'Children': { name: 'Children\'s Hour', icon: '👶', color: '#FF69B4' },
            'Health_Wellness': { name: 'Health & Wellness', icon: '💪', color: '#32CD32' },
            'Cultural_Arts': { name: 'Cultural Arts', icon: '🎨', color: '#FF8C00' },
            'Family_Entertainment': { name: 'Family Entertainment', icon: '👨‍👩‍👧‍👦', color: '#9932CC' },
            'News_Current': { name: 'News & Current Affairs', icon: '📰', color: '#4682B4' },
            'Traditional_Music': { name: 'Traditional Music', icon: '🎼', color: '#CD853F' }
        };
        
        // Fallback local stations (when API unavailable)
        const fallbackStations = [
            { name: 'BANF Radio - Classical', url: '/static/audio/classical_mix.mp3', category: 'Classical_Music' },
            { name: 'BANF Radio - Folk', url: '/static/audio/folk_mix.mp3', category: 'Folk_Music' },
            { name: 'BANF Radio - Modern', url: '/static/audio/modern_mix.mp3', category: 'Modern_Music' }
        ];
        let currentStationIndex = 0;

        /**
         * Initialize Radio Player
         */
        function initRadioPlayer() {
            const radioControls = document.querySelector('.radio-controls');
            if (!radioControls) return;
            
            const buttons = radioControls.querySelectorAll('.radio-btn');
            if (buttons.length >= 3) {
                buttons[0].onclick = () => skipStation(-1);  // Previous
                buttons[1].onclick = () => toggleRadio();     // Play/Pause
                buttons[2].onclick = () => skipStation(1);    // Next
            }
            
            // Create audio element
            radioAudio = new Audio();
            radioAudio.crossOrigin = 'anonymous';
            
            radioAudio.addEventListener('playing', () => {
                isRadioPlaying = true;
                updatePlayButton(true);
                updateNowPlaying();
            });
            
            radioAudio.addEventListener('pause', () => {
                isRadioPlaying = false;
                updatePlayButton(false);
            });
            
            radioAudio.addEventListener('error', (e) => {
                console.warn('Radio stream error:', e);
                updateNowPlaying('Stream unavailable - try another station');
            });
        }

        /**
         * Toggle Radio Play/Pause - Uses existing API
         */
        async function toggleRadio() {
            if (!radioAudio) {
                radioAudio = new Audio();
            }
            
            if (isRadioPlaying) {
                radioAudio.pause();
                radioAudio.src = '';
                isRadioPlaying = false;
                updatePlayButton(false);
            } else {
                try {
                    // Try to start from API first
                    const response = await fetch(RADIO_ENDPOINTS.startCurrent, { method: 'POST' });
                    const data = await response.json();
                    
                    if (data.stream_url) {
                        radioAudio.src = data.stream_url;
                        currentProgram = data;
                        updateNowPlayingFromAPI(data);
                    } else {
                        // Fallback to local stations
                        radioAudio.src = fallbackStations[currentStationIndex].url;
                        updateNowPlaying();
                    }
                } catch (error) {
                    console.warn('API unavailable, using fallback:', error);
                    radioAudio.src = fallbackStations[currentStationIndex].url;
                    updateNowPlaying();
                }
                
                radioAudio.play().catch(err => {
                    console.warn('Auto-play blocked:', err);
                    updateNowPlaying('Click play again to start');
                });
            }
        }

        /**
         * Skip to Next/Previous Track - Uses existing API
         */
        async function skipStation(direction) {
            try {
                const endpoint = direction > 0 ? RADIO_ENDPOINTS.nextTrack : RADIO_ENDPOINTS.previousTrack;
                const response = await fetch(endpoint, { method: 'POST' });
                const data = await response.json();
                
                if (data.stream_url) {
                    if (isRadioPlaying) {
                        radioAudio.src = data.stream_url;
                        radioAudio.play();
                    }
                    currentProgram = data;
                    updateNowPlayingFromAPI(data);
                    return;
                }
            } catch (error) {
                console.warn('API skip failed, using fallback:', error);
            }
            
            // Fallback to local stations
            currentStationIndex = (currentStationIndex + direction + fallbackStations.length) % fallbackStations.length;
            if (isRadioPlaying) {
                radioAudio.src = fallbackStations[currentStationIndex].url;
                radioAudio.play();
            }
            updateNowPlaying();
        }
        
        /**
         * Update Now Playing from API response
         */
        function updateNowPlayingFromAPI(data) {
            const nowPlaying = document.querySelector('.now-playing');
            if (nowPlaying && data) {
                const category = PROGRAM_CATEGORIES[data.category] || { icon: '🎵', name: data.category };
                nowPlaying.innerHTML = `${category.icon} ${data.program_name || data.title} — ${category.name}`;
            }
        }
        
        /**
         * Fetch current schedule from API
         */
        async function fetchCurrentSchedule() {
            try {
                const response = await fetch(RADIO_ENDPOINTS.currentStatus);
                const data = await response.json();
                if (data && data.current_program) {
                    currentProgram = data.current_program;
                    updateNowPlayingFromAPI(data.current_program);
                }
            } catch (error) {
                console.warn('Could not fetch schedule:', error);
            }
        }

        /**
         * Update Play Button Icon
         */
        function updatePlayButton(playing) {
            const playBtn = document.querySelector('.radio-controls .radio-btn:nth-child(2) i');
            if (playBtn) {
                playBtn.className = playing ? 'fas fa-pause' : 'fas fa-play';
            }
        }

        /**
         * Update Now Playing Display (fallback mode)
         */
        function updateNowPlaying(customText = null) {
            const nowPlaying = document.querySelector('.now-playing');
            if (nowPlaying) {
                nowPlaying.innerHTML = customText || `🎵 ${fallbackStations[currentStationIndex].name} — BANF Radio Live`;
            }
        }

        // Initialize radio on page load and fetch schedule
        document.addEventListener('DOMContentLoaded', () => {
            initRadioPlayer();
            fetchCurrentSchedule();
        });

        // ========== ADMIN RADIO CONTROL FUNCTIONS ==========
        function toggleRadioStatus() {
            const btn = document.getElementById('radioStatusBtn');
            const text = document.getElementById('radioStatusText');
            if (text.textContent === 'Online') {
                text.textContent = 'Offline';
                btn.style.background = '#dc3545';
                alert('Radio station paused — Demo');
            } else {
                text.textContent = 'Online';
                btn.style.background = '';
                alert('Radio station resumed — Demo');
            }
        }

        function adminTogglePlay() {
            const btn = document.getElementById('adminPlayBtn');
            if (btn.innerHTML.includes('pause')) {
                btn.innerHTML = '<i class="fas fa-play me-1"></i>Paused';
                btn.className = 'btn btn-sm btn-warning';
                alert('Radio playback paused — Demo');
            } else {
                btn.innerHTML = '<i class="fas fa-pause me-1"></i>Playing';
                btn.className = 'btn btn-sm btn-success';
                alert('Radio playback resumed — Demo');
            }
        }

        function adminSkipTrack(direction) {
            const label = direction > 0 ? 'Next track loaded' : 'Previous track loaded';
            const nowPlaying = document.getElementById('adminNowPlaying');
            const tracks = ['Rabindra Sangeet Special', 'Bengali Modern Hits', 'Folk Melodies', 'Children\'s Hour', 'Evening Ragas', 'Literature Corner'];
            if (nowPlaying) {
                const current = tracks.indexOf(nowPlaying.textContent);
                const next = (current + direction + tracks.length) % tracks.length;
                nowPlaying.textContent = tracks[next];
            }
            alert(label + ' — Demo');
        }

        function adminRefreshStatus() {
            // Simulate refresh
            const listeners = document.getElementById('radioListeners');
            if (listeners) listeners.textContent = Math.floor(Math.random() * 40) + 10;
            alert('Status refreshed — Demo');
        }

        function approveSongRequest(btn) {
            const row = btn.closest('tr');
            const song = row.cells[1].textContent;
            row.style.background = '#d4edda';
            row.cells[3].innerHTML = '<span class="badge bg-success">Approved</span>';
            alert('Song request approved: ' + song + ' — Demo');
        }

        function rejectSongRequest(btn) {
            const row = btn.closest('tr');
            const song = row.cells[1].textContent;
            row.style.background = '#f8d7da';
            row.cells[3].innerHTML = '<span class="badge bg-danger">Rejected</span>';
            alert('Song request rejected: ' + song + ' — Demo');
        }

        // Member song request handler
        function handleSongRequest(form) {
            const title = document.getElementById('songRequestTitle').value;
            const artist = document.getElementById('songRequestArtist').value;
            const category = document.getElementById('songRequestCategory').value;
            const dedication = document.getElementById('songDedication').value;

            // Add to My Requests
            const container = document.getElementById('myRadioRequests');
            const newRequest = document.createElement('div');
            newRequest.className = 'd-flex justify-content-between align-items-center p-2 border-bottom';
            newRequest.innerHTML = `
                <div>
                    <strong>${title}</strong><br>
                    <small class="text-muted">${artist || 'Unknown'} • ${category}</small>
                    ${dedication ? '<br><small class="text-info"><i class="fas fa-heart me-1"></i>' + dedication.substring(0, 50) + '</small>' : ''}
                </div>
                <span class="badge bg-info">Submitted</span>
            `;
            container.insertBefore(newRequest, container.firstChild);

            alert('🎵 Song request submitted!\n\nSong: ' + title + '\nArtist: ' + (artist || 'N/A') + '\nCategory: ' + category + (dedication ? '\nDedication: ' + dedication : '') + '\n\nYour request will be reviewed by the radio team.');
            form.reset();
        }

        // Language Toggle for President's Message
        function toggleLanguage(lang) {
            const bengaliMsg = document.getElementById('message-bengali');
            const englishMsg = document.getElementById('message-english');
            const btnBengali = document.getElementById('btn-bengali');
            const btnEnglish = document.getElementById('btn-english');
            
            if (lang === 'bengali') {
                bengaliMsg.style.display = 'block';
                englishMsg.style.display = 'none';
                btnBengali.classList.add('active', 'btn-light');
                btnBengali.classList.remove('btn-outline-light');
                btnEnglish.classList.remove('active', 'btn-light');
                btnEnglish.classList.add('btn-outline-light');
            } else {
                bengaliMsg.style.display = 'none';
                englishMsg.style.display = 'block';
                btnEnglish.classList.add('active', 'btn-light');
                btnEnglish.classList.remove('btn-outline-light');
                btnBengali.classList.remove('active', 'btn-light');
                btnBengali.classList.add('btn-outline-light');
            }
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Navbar scroll effect (optional - for when standalone)
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.background = 'rgba(26, 26, 46, 1)';
            } else {
                navbar.style.background = 'rgba(26, 26, 46, 0.98)';
            }
        });

        // Radio play button simulation
        document.querySelectorAll('.radio-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const icon = this.querySelector('i');
                if (icon.classList.contains('fa-play')) {
                    icon.classList.remove('fa-play');
                    icon.classList.add('fa-pause');
                } else if (icon.classList.contains('fa-pause')) {
                    icon.classList.remove('fa-pause');
                    icon.classList.add('fa-play');
                }
            });
        });

        // Form submission (prevent default for demo)
        document.querySelector('.contact-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Thank you for your message! We will get back to you soon.');
            this.reset();
        });

        // ========== WIX API INTEGRATION LAYER ==========
        
        /**
         * BANF Wix API Configuration
         * Maps landing page actions to Wix backend APIs and pages
         * Based on velo_backend/*.jsw modules
         */
        const BANF_API = {
            // Site Configuration
            siteUrl: 'https://www.jaxbengali.org',
            siteId: 'c13ae8c5-7053-4f2d-9a9a-371869be4395',
            
            // HTTP Functions Base URL (from http-functions.js)
            httpFunctionsBase: '/_functions',
            
            // API Endpoints - Maps to velo_backend/*.jsw exports
            endpoints: {
                // members.jsw - Member Management
                members: {
                    register: '/members/register',       // registerMember()
                    profile: '/members/profile',         // getMemberById(), getCurrentMemberProfile()
                    payment: '/members/payment-history', // getPaymentHistory()
                    family: '/members/family'            // getFamilyMembers()
                },
                // events.jsw - Event Management
                events: {
                    list: '/_functions/get_events',      // getUpcomingEvents(), getPastEvents()
                    register: '/events/register',        // registerForEvent()
                    feedback: '/events/feedback',        // submitEventFeedback()
                    checkin: '/events/checkin'           // checkIntoEvent()
                },
                // radio.jsw - Radio Streaming
                radio: {
                    config: '/_functions/get_radio',     // getRadioStationConfig()
                    schedule: '/radio/schedule',         // getUpcomingShows()
                    request: '/radio/request',           // submitSongRequest()
                    library: '/radio/library'            // getSongLibrary()
                },
                // magazine.jsw - E-Magazine
                magazine: {
                    list: '/magazine/issues',            // getPublishedMagazines()
                    latest: '/magazine/latest',          // getLatestMagazine()
                    articles: '/magazine/articles',      // getArticlesByCategory()
                    submit: '/magazine/submit'           // submitArticle()
                },
                // guide.jsw - Jacksonville Guide
                guide: {
                    list: '/guide/listings',             // getAllListings()
                    category: '/guide/category',         // getGuideByCategory()
                    search: '/guide/search',             // searchGuide()
                    review: '/guide/review'              // submitReview()
                },
                // surveys.jsw - Community Surveys
                surveys: {
                    active: '/surveys/active',           // getActiveSurveys()
                    submit: '/surveys/submit',           // submitSurveyResponse()
                    results: '/surveys/results'          // getSurveyResults() (members only)
                },
                // complaints.jsw - Anonymous Complaints
                complaints: {
                    submit: '/complaints/submit',        // submitComplaint()
                    status: '/complaints/status',        // checkComplaintStatus()
                    followup: '/complaints/followup'     // addComplaintFollowUp()
                },
                // sponsorship.jsw - Sponsorship Management
                sponsors: {
                    list: '/_functions/get_sponsors',    // getSponsors()
                    tiers: '/sponsors/tiers',            // SPONSORSHIP_TIERS
                    apply: '/sponsors/apply'             // createSponsor()
                },
                // documents.jsw - Meeting Minutes & Documents
                documents: {
                    minutes: '/documents/minutes',       // getDocumentsByCategory('meeting_docs')
                    list: '/documents/list'              // getAllPublicDocuments()
                },
                // gallery.jsw - Photo Gallery
                gallery: {
                    list: '/_functions/get_gallery',     // getPublicGalleries()
                    photos: '/gallery/photos'            // getGalleryPhotos()
                }
            },
            
            // Wix Page Routes - Maps to actual Wix pages (from LandingPage.velo.js)
            pages: {
                home: '/',
                about: '/about',
                events: '/events',
                radio: '/radio',
                magazine: '/magazine',
                guide: '/guide',
                surveys: '/surveys',
                complaints: '/complaints',
                sponsors: '/sponsors',
                gallery: '/gallery',
                membership: '/member-payment',
                account: '/account',
                login: '/login',
                memberDashboard: '/member-dashboard',
                adminDashboard: '/admin-dashboard',
                membersArea: '/members-area'
            },
            
            // Action Types from backend modules
            actions: {
                JOIN_NOW: 'navigate_membership',
                VIEW_EVENTS: 'navigate_events',
                LISTEN_RADIO: 'navigate_radio',
                READ_MAGAZINE: 'navigate_magazine',
                EXPLORE_GUIDE: 'navigate_guide',
                TAKE_SURVEY: 'navigate_surveys',
                SUBMIT_COMPLAINT: 'navigate_complaints',
                VIEW_SPONSORS: 'navigate_sponsors',
                VIEW_GALLERY: 'navigate_gallery',
                LOGIN: 'navigate_login',
                CONTACT: 'scroll_contact'
            }
        };

        /**
         * Navigate to Wix page from embedded iframe
         * Uses postMessage to communicate with Wix parent window
         */
        function navigateToWixPage(pageKey, queryParams = {}) {
            const pagePath = BANF_API.pages[pageKey];
            if (!pagePath) {
                console.warn('Unknown page:', pageKey);
                return;
            }
            
            // Build full URL with query params
            let url = BANF_API.siteUrl + pagePath;
            if (Object.keys(queryParams).length > 0) {
                const params = new URLSearchParams(queryParams);
                url += '?' + params.toString();
            }
            
            // Try to communicate with Wix parent
            if (window.parent !== window) {
                // Inside Wix iframe - use postMessage
                window.parent.postMessage({
                    type: 'BANF_NAVIGATION',
                    action: 'navigate',
                    url: url,
                    pagePath: pagePath
                }, '*');
                
                // Fallback: Direct navigation after short delay
                setTimeout(() => {
                    window.parent.location.href = url;
                }, 100);
            } else {
                // Standalone - direct navigation
                window.location.href = url;
            }
        }

        /**
         * Fetch data from Wix HTTP Functions
         * @param {string} endpoint - API endpoint path
         * @returns {Promise<object>} API response data
         */
        async function fetchFromAPI(endpoint) {
            try {
                const url = BANF_API.siteUrl + endpoint;
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API fetch error:', error);
                return null;
            }
        }

        /**
         * Load dynamic content from backend APIs
         */
        async function loadDynamicContent() {
            // Load upcoming events count
            try {
                const eventsData = await fetchFromAPI(BANF_API.endpoints.events.list);
                if (eventsData && eventsData.events) {
                    // Update events section with real data
                    console.log('Events loaded:', eventsData.events.length);
                }
            } catch (e) {
                console.log('Events API not available - using static content');
            }
            
            // Load radio status
            try {
                const radioData = await fetchFromAPI(BANF_API.endpoints.radio.config);
                if (radioData) {
                    // Update radio section with current show
                    console.log('Radio status loaded');
                }
            } catch (e) {
                console.log('Radio API not available - using static content');
            }
            
            // Load sponsors
            try {
                const sponsorsData = await fetchFromAPI(BANF_API.endpoints.sponsors.list);
                if (sponsorsData && sponsorsData.sponsors) {
                    console.log('Sponsors loaded:', sponsorsData.sponsors.length);
                }
            } catch (e) {
                console.log('Sponsors API not available - using static content');
            }
        }

        /**
         * Enhanced link handler for Wix page navigation
         * Intercepts clicks on specific action buttons
         */
        function setupActionLinks() {
            // Map data-action attributes to navigation
            document.querySelectorAll('[data-action]').forEach(el => {
                el.addEventListener('click', function(e) {
                    e.preventDefault();
                    const action = this.dataset.action;
                    
                    switch(action) {
                        case 'join':
                            navigateToWixPage('membership');
                            break;
                        case 'events':
                            navigateToWixPage('events');
                            break;
                        case 'radio':
                            navigateToWixPage('radio');
                            break;
                        case 'magazine':
                            navigateToWixPage('magazine');
                            break;
                        case 'guide':
                            navigateToWixPage('guide');
                            break;
                        case 'surveys':
                            navigateToWixPage('surveys');
                            break;
                        case 'complaints':
                            navigateToWixPage('complaints');
                            break;
                        case 'sponsors':
                            navigateToWixPage('sponsors');
                            break;
                        case 'gallery':
                            navigateToWixPage('gallery');
                            break;
                        case 'login':
                            navigateToWixPage('login');
                            break;
                        default:
                            console.log('Unknown action:', action);
                    }
                });
            });
        }

        /**
         * API Integration Summary
         * -----------------------
         * This landing page integrates with the following Velo backend modules:
         * 
         * 1. members.jsw - Member registration, profiles, payment history
         *    - Used by: Membership section, Join Now buttons
         *    - Functions: registerMember(), getMemberById(), getPaymentHistory()
         * 
         * 2. events.jsw - Event management and registration
         *    - Used by: Events section, event cards
         *    - Functions: getUpcomingEvents(), registerForEvent(), submitEventFeedback()
         * 
         * 3. radio.jsw - 24/7 radio streaming
         *    - Used by: Radio section, Now Playing widget
         *    - Functions: getRadioStationConfig(), getCurrentShow(), submitSongRequest()
         * 
         * 4. magazine.jsw - E-Magazine articles and submissions
         *    - Used by: E-Magazine section
         *    - Functions: getPublishedMagazines(), submitArticle()
         * 
         * 5. guide.jsw - Jacksonville Guide listings and reviews
         *    - Used by: Jacksonville Guide section
         *    - Functions: getGuideByCategory(), searchGuide(), submitReview()
         * 
         * 6. surveys.jsw - Community surveys and polls
         *    - Used by: Surveys section
         *    - Functions: getActiveSurveys(), submitSurveyResponse()
         * 
         * 7. complaints.jsw - Anonymous complaint system
         *    - Used by: Complaints section
         *    - Functions: submitComplaint(), checkComplaintStatus()
         * 
         * 8. sponsorship.jsw - Sponsorship tiers and applications
         *    - Used by: Sponsors section
         *    - Functions: getSponsors(), createSponsor()
         *    - Tiers: Platinum ($2000), Gold ($1000), Silver ($500), Bronze ($250)
         * 
         * 9. documents.jsw - Meeting minutes and documents
         *    - Used by: Minutes section (members only)
         *    - Functions: getDocumentsByCategory()
         * 
         * 10. http-functions.js - Public REST endpoints
         *     - GET /_functions/get_events - Public events list
         *     - GET /_functions/get_radio - Radio station config
         *     - GET /_functions/get_sponsors - Active sponsors
         *     - GET /_functions/get_gallery - Photo galleries
         *     - GET /_functions/get_members (auth required)
         */

        // Initialize API integration
        document.addEventListener('DOMContentLoaded', function() {
            setupActionLinks();
            // Render EC team cards dynamically from EC_MEMBERS data
            if (typeof renderECTeam === 'function') renderECTeam();
            // Render Career Directory cards on landing page
            if (typeof renderCareerCards === 'function') renderCareerCards();
            // Uncomment to enable dynamic loading when deployed to Wix:
            // loadDynamicContent();
            console.log('BANF Landing Page - API Integration Ready');
            console.log('Site ID:', BANF_API.siteId);
            console.log('Available endpoints:', Object.keys(BANF_API.endpoints).length);
        });
    </script>

    <!-- ========== FULL-SCREEN MEMBER PORTAL OVERLAY ========== -->
    <div id="memberPortalOverlay" class="member-portal-fullscreen" style="display: none;">
        <!-- Portal Header -->
        <header class="portal-header-bar">
            <div class="portal-header-content">
                <div class="portal-logo-group">
                    <div class="portal-logo-icon">
                        <i class="fas fa-om"></i>
                    </div>
                    <div class="portal-logo-text">
                        <h1>Member Portal</h1>
                        <span>Bengali Association of North Florida</span>
                    </div>
                </div>
                <div class="portal-user-menu">
                    <button class="portal-mobile-toggle btn btn-sm btn-outline-secondary me-2" style="display:none;" onclick="togglePortalSidebar()" aria-label="Toggle sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="portal-user-avatar" id="portalUserAvatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <span class="portal-user-name" id="portalUserName">Member</span>
                    <button class="portal-btn-logout" onclick="handlePortalLogout()">
                        <i class="fas fa-sign-out-alt me-1"></i> Logout
                    </button>
                    <button class="portal-btn-close" onclick="closeFullPortal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </header>
        
        <div class="portal-main-container">
            <!-- Mobile sidebar backdrop -->
            <div class="portal-sidebar-backdrop" onclick="togglePortalSidebar()"></div>
            <!-- Sidebar Navigation -->
            <nav class="portal-sidebar">
                <div class="sidebar-section">
                    <h6>Main</h6>
                    <a href="#" class="portal-nav-item active" onclick="showPortalSection('dashboard', this); return false;">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('profile', this); return false;">
                        <i class="fas fa-id-card"></i>
                        <span>My Profile</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('family', this); return false;">
                        <i class="fas fa-users"></i>
                        <span>Family Members</span>
                    </a>
                </div>
                
                <div class="sidebar-section">
                    <h6>Finance</h6>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('payments', this); return false;">
                        <i class="fas fa-credit-card"></i>
                        <span>Payments & Receipts</span>
                        <span class="portal-badge">Due</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('budget', this); return false;">
                        <i class="fas fa-wallet"></i>
                        <span>Budget Reports</span>
                    </a>
                </div>
                
                <div class="sidebar-section">
                    <h6>Community</h6>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('meetings', this); return false;">
                        <i class="fas fa-file-alt"></i>
                        <span>Meeting Minutes</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('events', this); return false;">
                        <i class="fas fa-calendar-check"></i>
                        <span>Events & RSVP</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('surveys', this); return false;">
                        <i class="fas fa-poll-h"></i>
                        <span>Surveys</span>
                        <span class="portal-badge">2</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('directory', this); return false;">
                        <i class="fas fa-address-book"></i>
                        <span>Member Directory</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('careerProfile', this); return false;">
                        <i class="fas fa-briefcase"></i>
                        <span>Career Profile</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('volunteer', this); return false;">
                        <i class="fas fa-hands-helping"></i>
                        <span>Volunteer</span>
                    </a>
                </div>
                
                <div class="sidebar-section">
                    <h6>Media</h6>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('radio', this); return false;">
                        <i class="fas fa-music"></i>
                        <span>Request Songs</span>
                    </a>
                    <a href="#" class="portal-nav-item" onclick="showPortalSection('magazine', this); return false;">
                        <i class="fas fa-pen-fancy"></i>
                        <span>Magazine Submission</span>
                    </a>
                </div>
            </nav>
            
            <!-- Main Content Area -->
            <main class="portal-content-area">
                <!-- DASHBOARD SECTION -->
                <section id="portalDashboard" class="portal-section active">
                    <div class="portal-page-header">
                        <h2>Welcome back, <span id="dashboardMemberName">Member</span>! 👋</h2>
                        <p>Here's your BANF membership overview</p>
                    </div>
                    
                    <!-- Stats Grid -->
                    <div class="portal-stats-grid">
                        <div class="portal-stat-card">
                            <div class="stat-icon green"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-info">
                                <h3>Active</h3>
                                <p>Membership Status</p>
                            </div>
                        </div>
                        <div class="portal-stat-card">
                            <div class="stat-icon orange"><i class="fas fa-calendar"></i></div>
                            <div class="stat-info">
                                <h3>5</h3>
                                <p>Upcoming Events</p>
                            </div>
                        </div>
                        <div class="portal-stat-card">
                            <div class="stat-icon gold"><i class="fas fa-receipt"></i></div>
                            <div class="stat-info">
                                <h3>$0</h3>
                                <p>Dues Balance</p>
                            </div>
                        </div>
                        <div class="portal-stat-card">
                            <div class="stat-icon purple"><i class="fas fa-poll"></i></div>
                            <div class="stat-info">
                                <h3>2</h3>
                                <p>Active Surveys</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Access Features -->
                    <h3 style="margin: 2rem 0 1.5rem; color: var(--banf-charcoal);">Quick Access</h3>
                    <div class="portal-features-grid">
                        <div class="portal-feature-card">
                            <div class="feature-icon-box"><i class="fas fa-id-card"></i></div>
                            <h4>My Profile & Family</h4>
                            <p>Update your personal information, contact details, and manage family member profiles.</p>
                            <button class="portal-feature-btn" onclick="showPortalSection('profile')">
                                <i class="fas fa-user-edit"></i> Edit Profile
                            </button>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: var(--gradient-primary);"><i class="fas fa-credit-card"></i></div>
                            <h4>Payments & Receipts</h4>
                            <p>View payment history, download receipts, and make membership or event payments.</p>
                            <button class="portal-feature-btn" onclick="showPortalSection('payments')">
                                <i class="fas fa-receipt"></i> View Payments
                            </button>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #795548, #8D6E63);"><i class="fas fa-file-alt"></i></div>
                            <h4>Meeting Minutes</h4>
                            <p>Access EC meeting summaries, decisions, action items, and announcements.</p>
                            <button class="portal-feature-btn" onclick="showPortalSection('meetings')">
                                <i class="fas fa-folder-open"></i> View Minutes
                            </button>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #2196F3, #03A9F4);"><i class="fas fa-calendar-check"></i></div>
                            <h4>Events & RSVP</h4>
                            <p>Browse upcoming events, register your family, and check-in at venues.</p>
                            <button class="portal-feature-btn" onclick="showPortalSection('events')">
                                <i class="fas fa-calendar-plus"></i> View Events
                            </button>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #FF9800, #FFC107);"><i class="fas fa-poll-h"></i></div>
                            <h4>Surveys & Polls</h4>
                            <p>Participate in community polls and provide feedback on BANF initiatives.</p>
                            <button class="portal-feature-btn" onclick="showPortalSection('surveys')">
                                <i class="fas fa-vote-yea"></i> Take Survey
                            </button>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #673AB7, #9C27B0);"><i class="fas fa-music"></i></div>
                            <h4>Request Songs</h4>
                            <p>Request your favorite Bengali songs to be played on BANF Radio 24/7.</p>
                            <button class="portal-feature-btn" onclick="showPortalSection('radio')">
                                <i class="fas fa-microphone"></i> Request Song
                            </button>
                        </div>

                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #009688, #26a69a);"><i class="fas fa-stethoscope"></i></div>
                            <h4>System Check</h4>
                            <p>Run due diligence checks for schema, data integrity, and workflow readiness.</p>
                            <button class="portal-feature-btn secondary" onclick="runDueDiligenceChecks('member')">
                                <i class="fas fa-clipboard-check"></i> Run Check
                            </button>
                        </div>
                    </div>

                    <div class="portal-form-card" style="margin-top: 2rem;">
                        <h4 style="margin-bottom: 1rem;"><i class="fas fa-list-check me-2"></i>Workflow Checklist</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkLogin">
                                    <label class="form-check-label" for="checkLogin">Login & Session</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkProfile">
                                    <label class="form-check-label" for="checkProfile">Profile Update</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkFamily">
                                    <label class="form-check-label" for="checkFamily">Family Members</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkEvents">
                                    <label class="form-check-label" for="checkEvents">Events & RSVP</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkPayments">
                                    <label class="form-check-label" for="checkPayments">Payments & Zelle</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkReceipts">
                                    <label class="form-check-label" for="checkReceipts">Receipts Download</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkMinutes">
                                    <label class="form-check-label" for="checkMinutes">Meeting Minutes</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkSurveys">
                                    <label class="form-check-label" for="checkSurveys">Surveys</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkDirectory">
                                    <label class="form-check-label" for="checkDirectory">Member Directory</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkRadio">
                                    <label class="form-check-label" for="checkRadio">Radio Request</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkMagazine">
                                    <label class="form-check-label" for="checkMagazine">Magazine Submission</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="checkVolunteer">
                                    <label class="form-check-label" for="checkVolunteer">Volunteer Signup</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- PROFILE SECTION -->
                <section id="portalProfile" class="portal-section">
                    <div class="portal-page-header">
                        <h2>My Profile</h2>
                        <p>Update your personal information and preferences</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="portal-form-card">
                                <form id="portalProfileForm" onsubmit="handleProfileUpdate(event)">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">First Name</label>
                                            <input type="text" class="form-control" id="portalFirstName" value="">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Last Name</label>
                                            <input type="text" class="form-control" id="portalLastName" value="">
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Email Address</label>
                                        <input type="email" class="form-control" id="portalEmail" value="">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" id="portalPhone" value="">
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Address</label>
                                        <textarea class="form-control" id="portalAddress" rows="2"></textarea>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">City</label>
                                            <input type="text" class="form-control" id="portalCity" value="Jacksonville">
                                        </div>
                                        <div class="col-md-3 mb-3">
                                            <label class="form-label">State</label>
                                            <input type="text" class="form-control" id="portalState" value="FL">
                                        </div>
                                        <div class="col-md-3 mb-3">
                                            <label class="form-label">ZIP Code</label>
                                            <input type="text" class="form-control" id="portalZip" value="">
                                        </div>
                                    </div>
                                    
                                    <button type="submit" class="portal-feature-btn">
                                        <i class="fas fa-save"></i> Save Changes
                                    </button>
                                </form>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="portal-form-card text-center">
                                <div style="width: 120px; height: 120px; border-radius: 50%; background: var(--gradient-green); margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-user fa-3x text-white"></i>
                                </div>
                                <h5>Member Photo</h5>
                                <p class="text-muted small">Upload a profile picture</p>
                                <button class="portal-feature-btn secondary">
                                    <i class="fas fa-camera"></i> Upload Photo
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- FAMILY SECTION -->
                <section id="portalFamily" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Family Members</h2>
                        <p>Manage family members under your membership</p>
                    </div>
                    
                    <div class="portal-data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Relationship</th>
                                    <th>Age</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="portalFamilyTable">
                                <tr>
                                    <td>Spouse Demo</td>
                                    <td>Spouse</td>
                                    <td>Adult</td>
                                    <td><span class="status-badge active">Active</span></td>
                                    <td><button class="btn btn-sm btn-outline-primary"><i class="fas fa-edit"></i></button></td>
                                </tr>
                                <tr>
                                    <td>Child Demo</td>
                                    <td>Child</td>
                                    <td>12</td>
                                    <td><span class="status-badge active">Active</span></td>
                                    <td><button class="btn btn-sm btn-outline-primary"><i class="fas fa-edit"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <button class="portal-feature-btn mt-3" onclick="alert('Add Family Member - Demo Mode')">
                        <i class="fas fa-user-plus"></i> Add Family Member
                    </button>
                </section>
                
                <!-- PAYMENTS SECTION -->
                <section id="portalPayments" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Payments & Receipts</h2>
                        <p>View your payment history and download receipts</p>
                    </div>
                    
                    <div class="portal-stats-grid" style="margin-bottom: 2rem;">
                        <div class="portal-stat-card">
                            <div class="stat-icon green"><i class="fas fa-check-circle"></i></div>
                            <div class="stat-info">
                                <h3 id="portalBalanceDue">$0.00</h3>
                                <p>Balance Due</p>
                            </div>
                        </div>
                        <div class="portal-stat-card">
                            <div class="stat-icon orange"><i class="fas fa-history"></i></div>
                            <div class="stat-info">
                                <h3 id="portalTotalPaid">$250.00</h3>
                                <p>Total Paid (2026)</p>
                            </div>
                        </div>
                        <div class="portal-stat-card">
                            <div class="stat-icon" style="background:#e8e0ff; color:#6528F7;"><i class="fas fa-bolt"></i></div>
                            <div class="stat-info">
                                <h3 id="portalZelleStatus" style="font-size:0.95rem; color:#28a745;">✅ Auto-Tracking</h3>
                                <p>Zelle Detection</p>
                            </div>
                        </div>
                    </div>

                    <div class="portal-form-card">
                        <h4 style="margin-bottom: 1rem;"><i class="fas fa-university me-2"></i>Zelle Payment Info</h4>
                        <p class="text-muted">Send payments via Zelle. Your payment will be <strong>automatically detected</strong> from Gmail and matched to your account.</p>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Zelle Recipient</label>
                                <input class="form-control" value="treasurer@jaxbengali.org" readonly>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Memo Format</label>
                                <input class="form-control" value="Membership - [Your Name]" readonly>
                            </div>
                        </div>
                        <div style="padding:0.75rem; background:#e8f5e9; border-radius:8px; margin-bottom:1rem; font-size:0.9rem;">
                            <i class="fas fa-magic" style="color:#6528F7; margin-right:0.5rem;"></i>
                            <strong>Auto-Detection Active:</strong> When you send a Zelle payment, our system automatically detects the email notification and updates your account. No manual verification needed!
                        </div>
                        <button class="portal-feature-btn" onclick="portalRefreshPayments()">
                            <i class="fas fa-sync-alt"></i> Refresh Payment Status
                        </button>
                    </div>
                    
                    <h4 style="margin-bottom: 1rem;">Payment History</h4>
                    <div class="portal-data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                    <th>Method</th>
                                    <th>Status</th>
                                    <th>Receipt</th>
                                </tr>
                            </thead>
                            <tbody id="portalPaymentHistoryBody">
                                <tr>
                                    <td>Feb 01, 2026</td>
                                    <td>Annual Membership - Family</td>
                                    <td>$150.00</td>
                                    <td><i class="fas fa-bolt" style="color:#6528F7;"></i> Zelle</td>
                                    <td><span class="status-badge active">Paid</span></td>
                                    <td><a href="#" class="text-primary" onclick="alert('Download Receipt - Demo'); return false;"><i class="fas fa-download"></i> PDF</a></td>
                                </tr>
                                <tr>
                                    <td>Feb 02, 2026</td>
                                    <td>Saraswati Puja Registration</td>
                                    <td>$100.00</td>
                                    <td><i class="fas fa-bolt" style="color:#6528F7;"></i> Zelle</td>
                                    <td><span class="status-badge active">Paid</span></td>
                                    <td><a href="#" class="text-primary" onclick="alert('Download Receipt - Demo'); return false;"><i class="fas fa-download"></i> PDF</a></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- BUDGET SECTION -->
                <section id="portalBudget" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Budget Reports</h2>
                        <p>View BANF financial transparency reports</p>
                    </div>
                    
                    <div class="portal-features-grid" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #4CAF50, #8BC34A);"><i class="fas fa-file-invoice-dollar"></i></div>
                            <h4>2026 Budget</h4>
                            <p>Current fiscal year budget allocation and spending summary.</p>
                            <button class="portal-feature-btn" onclick="alert('Download 2026 Budget - Demo')">
                                <i class="fas fa-download"></i> Download PDF
                            </button>
                        </div>
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #607D8B, #455A64);"><i class="fas fa-archive"></i></div>
                            <h4>2025 Annual Report</h4>
                            <p>Complete financial summary and audit report for 2025.</p>
                            <button class="portal-feature-btn secondary" onclick="alert('Download 2025 Report - Demo')">
                                <i class="fas fa-download"></i> Download PDF
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- MEETINGS SECTION -->
                <section id="portalMeetings" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Meeting Minutes</h2>
                        <p>Access EC meeting summaries and decisions</p>
                    </div>
                    
                    <div class="portal-data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Meeting Type</th>
                                    <th>Summary</th>
                                    <th>Document</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Feb 10, 2026</td>
                                    <td>EC Meeting</td>
                                    <td>Nabo Borsho planning, budget review</td>
                                    <td><a href="#" class="text-primary" onclick="alert('View PDF - Demo'); return false;"><i class="fas fa-file-pdf"></i> View PDF</a></td>
                                </tr>
                                <tr>
                                    <td>Jan 25, 2026</td>
                                    <td>General Body</td>
                                    <td>Annual review, 2026 goals</td>
                                    <td><a href="#" class="text-primary" onclick="alert('View PDF - Demo'); return false;"><i class="fas fa-file-pdf"></i> View PDF</a></td>
                                </tr>
                                <tr>
                                    <td>Jan 10, 2026</td>
                                    <td>EC Meeting</td>
                                    <td>Saraswati Puja planning</td>
                                    <td><a href="#" class="text-primary" onclick="alert('View PDF - Demo'); return false;"><i class="fas fa-file-pdf"></i> View PDF</a></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- EVENTS SECTION -->
                <section id="portalEvents" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Events & RSVP</h2>
                        <p>Register for upcoming events and manage your RSVPs</p>
                    </div>

                    <!-- RSVP Form (hidden by default) -->
                    <div id="memberRsvpFormContainer" style="display:none; margin-bottom:1.5rem;">
                        <div class="portal-form-card" style="border:2px solid var(--banf-orange);">
                            <h4 id="rsvpFormTitle">RSVP for Event</h4>
                            <form id="memberRsvpForm" onsubmit="return handleMemberRsvp(event)">
                                <input type="hidden" id="rsvpEventId" value="">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">RSVP Status *</label>
                                        <select class="form-control" id="rsvpStatus" required onchange="toggleRsvpDetails()">
                                            <option value="">Select...</option>
                                            <option value="attending">✅ Yes, I'll attend</option>
                                            <option value="maybe">🤔 Maybe</option>
                                            <option value="not_attending">❌ Can't make it</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label fw-bold"># Adults</label>
                                        <input type="number" class="form-control" id="rsvpAdults" min="0" max="10" value="1">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label fw-bold"># Kids</label>
                                        <input type="number" class="form-control" id="rsvpKids" min="0" max="10" value="0">
                                    </div>
                                    <div class="col-md-6" id="rsvpDietaryCol">
                                        <label class="form-label fw-bold">Dietary Requirements</label>
                                        <select class="form-control" id="rsvpDietary">
                                            <option value="None">None</option>
                                            <option value="Vegetarian">Vegetarian</option>
                                            <option value="Vegan">Vegan</option>
                                            <option value="Jain">Jain (no onion/garlic)</option>
                                            <option value="Gluten-free">Gluten-free</option>
                                            <option value="Nut allergy">Nut allergy</option>
                                            <option value="Other">Other (specify in notes)</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Notes</label>
                                        <input type="text" class="form-control" id="rsvpNotes" placeholder="Any special requests...">
                                    </div>
                                </div>
                                <div class="mt-3" style="display:flex; gap:0.5rem;">
                                    <button type="submit" class="portal-feature-btn"><i class="fas fa-check me-1"></i> Submit RSVP</button>
                                    <button type="button" class="portal-feature-btn secondary" onclick="document.getElementById('memberRsvpFormContainer').style.display='none'"><i class="fas fa-times me-1"></i> Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <div class="portal-features-grid">
                        <div class="portal-feature-card" style="border: 2px solid var(--banf-orange);">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #E91E63, #FF5722);"><i class="fas fa-om"></i></div>
                            <h4>Nabo Borsho 1433</h4>
                            <p><strong>April 25, 2026</strong> • Bengali New Year celebration with cultural program and feast.</p>
                            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                <button class="portal-feature-btn" onclick="openMemberRsvp('EVT-001', 'Nabo Borsho 1433')">
                                    <i class="fas fa-user-check"></i> RSVP Now
                                </button>
                                <button class="portal-feature-btn secondary" onclick="alert('Event Details - Demo')">
                                    <i class="fas fa-info-circle"></i> Details
                                </button>
                            </div>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #4CAF50, #8BC34A);"><i class="fas fa-campground"></i></div>
                            <h4>Summer Camp 2026</h4>
                            <p><strong>June 2026</strong> • Bengali language and culture camp for children ages 5-15.</p>
                            <button class="portal-feature-btn" onclick="openMemberRsvp('EVT-002', 'Summer Camp 2026')">
                                <i class="fas fa-user-check"></i> RSVP Now
                            </button>
                        </div>
                        
                        <div class="portal-feature-card">
                            <div class="feature-icon-box" style="background: linear-gradient(135deg, #2196F3, #03A9F4);"><i class="fas fa-utensils"></i></div>
                            <h4>Summer Picnic</h4>
                            <p><strong>July 2026</strong> • Annual community picnic with games, food, and music.</p>
                            <button class="portal-feature-btn secondary">
                                <i class="fas fa-clock"></i> Coming Soon
                            </button>
                        </div>
                    </div>

                    <!-- My RSVPs -->
                    <div style="margin-top: 2rem;">
                        <h4><i class="fas fa-clipboard-check me-2"></i>My RSVPs</h4>
                        <div class="portal-data-table">
                            <table>
                                <thead><tr><th>Event</th><th>Status</th><th>Adults</th><th>Kids</th><th>Dietary</th><th>Action</th></tr></thead>
                                <tbody id="myRsvpTableBody">
                                    <tr><td colspan="6" class="text-center py-3 text-muted">No RSVPs yet. RSVP to an event above!</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- SURVEYS SECTION -->
                <section id="portalSurveys" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Surveys & Polls</h2>
                        <p>Share your feedback and participate in community decisions</p>
                    </div>
                    
                    <div class="portal-features-grid">
                        <div class="portal-feature-card" style="border: 2px solid var(--banf-orange);">
                            <span class="status-badge pending" style="margin-bottom: 1rem;">Active</span>
                            <h4>Nabo Borsho 2026 Menu Preferences</h4>
                            <p>Help us decide the food menu for the Bengali New Year celebration!</p>
                            <button class="portal-feature-btn" onclick="alert('Survey - Demo Mode')">
                                <i class="fas fa-vote-yea"></i> Take Survey
                            </button>
                        </div>
                        
                        <div class="portal-feature-card" style="border: 2px solid var(--banf-orange);">
                            <span class="status-badge pending" style="margin-bottom: 1rem;">Active</span>
                            <h4>Summer Camp Interest Survey</h4>
                            <p>Would you like to enroll your children in Bengali summer camp?</p>
                            <button class="portal-feature-btn" onclick="alert('Survey - Demo Mode')">
                                <i class="fas fa-vote-yea"></i> Take Survey
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- DIRECTORY SECTION -->
                <section id="portalDirectory" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Member Directory</h2>
                        <p>Connect with fellow BANF members</p>
                    </div>
                    
                    <div class="portal-form-card" style="margin-bottom: 1.5rem;">
                        <div class="row">
                            <div class="col-md-8 mb-2 mb-md-0">
                                <input type="text" class="form-control" placeholder="Search by name, city, or profession..." id="portalDirectorySearch">
                            </div>
                            <div class="col-md-4">
                                <button class="portal-feature-btn w-100" onclick="alert('Search - Demo: Found 45 members')">
                                    <i class="fas fa-search"></i> Search
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="portal-data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>City</th>
                                    <th>Member Since</th>
                                    <th>Contact</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="4" class="text-center py-4">
                                        <i class="fas fa-address-book fa-2x text-muted mb-2"></i>
                                        <p class="text-muted mb-0">Search to view member directory</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- VOLUNTEER SECTION -->
                <section id="portalVolunteer" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Volunteer Opportunities</h2>
                        <p>Support BANF events and community programs</p>
                    </div>

                    <div class="portal-data-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Event</th>
                                    <th>Role</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Nabo Borsho 1433</td>
                                    <td>Registration Desk</td>
                                    <td>Apr 25, 2026</td>
                                    <td><span class="status-badge pending">Open</span></td>
                                    <td><button class="portal-feature-btn secondary" onclick="alert('Volunteer sign-up submitted (Demo)')">Sign Up</button></td>
                                </tr>
                                <tr>
                                    <td>Summer Camp 2026</td>
                                    <td>Activity Support</td>
                                    <td>Jun 2026</td>
                                    <td><span class="status-badge pending">Open</span></td>
                                    <td><button class="portal-feature-btn secondary" onclick="alert('Volunteer sign-up submitted (Demo)')">Sign Up</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- RADIO SECTION -->
                <section id="portalRadio" class="portal-section">
                    <div class="portal-page-header">
                        <h2>BANF Radio 24/7</h2>
                        <p>Listen live & request your favorite Bengali songs</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-lg-6 mb-4">
                            <div class="portal-form-card">
                                <h4 style="margin-bottom: 1rem;"><i class="fas fa-broadcast-tower me-2"></i>Now Playing</h4>
                                <div style="background: linear-gradient(135deg, #673AB7, #9C27B0); border-radius: 16px; padding: 2rem; color: #fff; text-align: center;" id="memberRadioPlayer">
                                    <i class="fas fa-music fa-3x mb-3"></i>
                                    <h5 id="memberNowPlaying">BANF Radio 24/7</h5>
                                    <p style="opacity: 0.8;" id="memberRadioCategory">Bengali Music Non-Stop</p>
                                    <div class="d-flex justify-content-center gap-2 mt-3">
                                        <button class="btn btn-light rounded-circle" onclick="skipStation(-1)" title="Previous" style="width:40px;height:40px;">
                                            <i class="fas fa-backward"></i>
                                        </button>
                                        <button class="btn btn-light btn-lg rounded-circle" onclick="toggleRadio()" id="memberPlayBtn" title="Play/Pause" style="width:55px;height:55px;">
                                            <i class="fas fa-play"></i>
                                        </button>
                                        <button class="btn btn-light rounded-circle" onclick="skipStation(1)" title="Next" style="width:40px;height:40px;">
                                            <i class="fas fa-forward"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Today's Schedule Preview -->
                                <h5 class="mt-4 mb-3"><i class="fas fa-clock me-2"></i>Today's Schedule</h5>
                                <div style="max-height: 200px; overflow-y: auto;">
                                    <div class="d-flex justify-content-between p-2 border-bottom"><span>🙏 6 AM — Prabhati Sangeet</span><small class="text-muted">Devotional</small></div>
                                    <div class="d-flex justify-content-between p-2 border-bottom"><span>🎻 8 AM — Morning Ragas</span><small class="text-muted">Classical</small></div>
                                    <div class="d-flex justify-content-between p-2 border-bottom"><span>🎻 10 AM — Rabindra Sangeet</span><small class="text-muted">Classical</small></div>
                                    <div class="d-flex justify-content-between p-2 border-bottom" style="background:#e8f5e9;"><span>🎵 12 PM — Bengali Modern Hits</span><small class="text-success">Now</small></div>
                                    <div class="d-flex justify-content-between p-2 border-bottom"><span>🪘 2 PM — Folk Melodies</span><small class="text-muted">Folk</small></div>
                                    <div class="d-flex justify-content-between p-2 border-bottom"><span>👶 4 PM — Children's Hour</span><small class="text-muted">Children</small></div>
                                    <div class="d-flex justify-content-between p-2 border-bottom"><span>🎻 6 PM — Evening Ragas</span><small class="text-muted">Classical</small></div>
                                    <div class="d-flex justify-content-between p-2"><span>📚 8 PM — Literature Corner</span><small class="text-muted">Literature</small></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="portal-form-card">
                                <h4 style="margin-bottom: 1.5rem;"><i class="fas fa-music me-2"></i>Song Request Form</h4>
                                <form onsubmit="event.preventDefault(); handleSongRequest(this);">
                                    <div class="mb-3">
                                        <label class="form-label">Song Title</label>
                                        <input type="text" class="form-control" id="songRequestTitle" placeholder="e.g., Amar Sonar Bangla" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Artist Name</label>
                                        <input type="text" class="form-control" id="songRequestArtist" placeholder="e.g., Rabindranath Tagore">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Category</label>
                                        <select class="form-control" id="songRequestCategory">
                                            <option value="classical">Classical / Rabindra Sangeet</option>
                                            <option value="folk">Folk Music (Baul, Bhatiyali)</option>
                                            <option value="modern">Modern Bengali</option>
                                            <option value="devotional">Devotional</option>
                                            <option value="film">Film Songs</option>
                                            <option value="children">Children's Songs</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Dedication Message (Optional)</label>
                                        <textarea class="form-control" rows="3" id="songDedication" placeholder="Dedicate this song to someone special..."></textarea>
                                    </div>
                                    <button type="submit" class="portal-feature-btn">
                                        <i class="fas fa-paper-plane"></i> Submit Request
                                    </button>
                                </form>
                                
                                <!-- My Requests -->
                                <h5 class="mt-4 mb-3"><i class="fas fa-list me-2"></i>My Recent Requests</h5>
                                <div id="myRadioRequests">
                                    <div class="d-flex justify-content-between align-items-center p-2 border-bottom">
                                        <div>
                                            <strong>Tumi Robe Nirobe</strong><br>
                                            <small class="text-muted">Rabindranath Tagore • Classical</small>
                                        </div>
                                        <span class="badge bg-success">Played</span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center p-2">
                                        <div>
                                            <strong>Ami Chini Go Chini</strong><br>
                                            <small class="text-muted">Rabindranath Tagore • Classical</small>
                                        </div>
                                        <span class="badge bg-warning text-dark">Queued</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- CAREER PROFILE SECTION -->
                <section id="portalCareerProfile" class="portal-section">
                    <div class="portal-page-header">
                        <h2><i class="fas fa-briefcase me-2"></i>My Career Profile</h2>
                        <p>Create or edit your career guidance profile to appear in the BANF professional network</p>
                    </div>
                    <div class="portal-form-card">
                        <form onsubmit="event.preventDefault(); saveMyCareerProfile();">
                            <div class="d-flex align-items-center mb-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="careerProfileVisible" checked>
                                    <label class="form-check-label" for="careerProfileVisible"><strong>Visible in Public Directory</strong></label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Professional Title</label>
                                    <input type="text" class="form-control" id="careerTitle" placeholder="e.g. Software Engineer, Doctor, Teacher" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Company / Organization</label>
                                    <input type="text" class="form-control" id="careerCompany" placeholder="Your current employer">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">Industry</label>
                                    <select class="form-select" id="careerIndustry" required>
                                        <option value="">Select...</option>
                                        <option>Technology</option><option>Healthcare</option><option>Finance</option>
                                        <option>Education</option><option>Engineering</option><option>Legal</option>
                                        <option>Business</option><option>Arts & Media</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">Years of Experience</label>
                                    <input type="number" class="form-control" id="careerYears" min="0" max="60" value="5">
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">Education</label>
                                    <input type="text" class="form-control" id="careerEducation" placeholder="e.g. M.S. Computer Science">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Skills (comma-separated)</label>
                                <input type="text" class="form-control" id="careerSkills" placeholder="Python, Project Management, Data Analysis...">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Guidance I Can Offer</label>
                                <div class="d-flex flex-wrap gap-2" id="guidanceCheckboxes">
                                    <label class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value="Career Mentorship"> Career Mentorship</label>
                                    <label class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value="Resume Review"> Resume Review</label>
                                    <label class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value="Interview Prep"> Interview Prep</label>
                                    <label class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value="Networking"> Networking</label>
                                    <label class="form-check form-check-inline"><input class="form-check-input" type="checkbox" value="Industry Insights"> Industry Insights</label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Short Bio</label>
                                <textarea class="form-control" id="careerBio" rows="3" placeholder="Tell other members how you can help..."></textarea>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">LinkedIn URL (optional)</label>
                                    <input type="url" class="form-control" id="careerLinkedin" placeholder="https://linkedin.com/in/...">
                                </div>
                                <div class="col-md-6 mb-3 d-flex align-items-end">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="careerAvailable" checked>
                                        <label class="form-check-label" for="careerAvailable">Available for meetings</label>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-primary"><i class="fas fa-save me-1"></i>Save Profile</button>
                                <button type="button" class="btn btn-outline-danger" onclick="deleteMyCareerProfile()"><i class="fas fa-trash me-1"></i>Remove Profile</button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- MAGAZINE SECTION -->
                <section id="portalMagazine" class="portal-section">
                    <div class="portal-page-header">
                        <h2>Magazine Submission</h2>
                        <p>Submit your literary works for BANF E-Magazine</p>
                    </div>
                    
                    <div class="portal-form-card">
                        <form onsubmit="event.preventDefault(); alert('Submission sent for review - Demo'); this.reset();">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Submission Type</label>
                                    <select class="form-control" required>
                                        <option value="">Select type...</option>
                                        <option value="poem">Poem (কবিতা)</option>
                                        <option value="story">Short Story (গল্প)</option>
                                        <option value="article">Article (প্রবন্ধ)</option>
                                        <option value="essay">Essay (রচনা)</option>
                                        <option value="memoir">Memoir (স্মৃতিকথা)</option>
                                        <option value="review">Book/Movie Review</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Language</label>
                                    <select class="form-control" required>
                                        <option value="bengali">Bengali (বাংলা)</option>
                                        <option value="english">English</option>
                                        <option value="both">Both</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Title</label>
                                <input type="text" class="form-control" placeholder="Enter the title of your work" required>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Content</label>
                                <textarea class="form-control" rows="8" placeholder="Paste your content here..." required></textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Author Bio (Optional)</label>
                                <textarea class="form-control" rows="2" placeholder="Brief bio to be published with your work..."></textarea>
                            </div>
                            
                            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                <button type="submit" class="portal-feature-btn">
                                    <i class="fas fa-paper-plane"></i> Submit for Review
                                </button>
                                <button type="button" class="portal-feature-btn secondary" onclick="alert('Draft saved - Demo')">
                                    <i class="fas fa-save"></i> Save Draft
                                </button>
                            </div>
                        </form>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- ========== FULL-SCREEN ADMIN PORTAL OVERLAY ========== -->
    <div id="adminPortalOverlay" class="admin-portal-fullscreen" style="display: none;">
        <!-- Admin Header -->
        <header class="admin-header">
            <div class="admin-header-content">
                <div class="admin-logo-group">
                    <div class="admin-logo-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="admin-logo-text">
                        <h1>EC Admin Portal</h1>
                        <span>Bengali Association of North Florida</span>
                    </div>
                </div>
                <div class="admin-user-menu">
                    <button class="admin-mobile-toggle btn btn-sm btn-outline-light me-2" style="display:none;" onclick="toggleAdminSidebar()" aria-label="Toggle sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <span class="admin-role-badge" id="adminRoleBadge">EC Member</span>
                    <div class="admin-user-avatar">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <span class="admin-user-name" id="adminPortalName">Admin</span>
                    <button class="admin-btn" onclick="runDueDiligenceChecks('admin')">
                        <i class="fas fa-stethoscope me-1"></i> System Check
                    </button>
                    <button class="admin-btn" onclick="handleAdminLogout()">
                        <i class="fas fa-sign-out-alt me-1"></i> Logout
                    </button>
                    <button class="admin-btn admin-btn-close" onclick="closeAdminPortal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="admin-portal-container">
            <!-- Mobile sidebar backdrop -->
            <div class="admin-sidebar-backdrop" onclick="toggleAdminSidebar()"></div>
            <!-- Sidebar Navigation -->
            <nav class="admin-sidebar">
                <div class="admin-sidebar-section">
                    <h6>Dashboard</h6>
                    <a href="#" class="admin-nav-item active" data-section="dashboard" onclick="showAdminSection('dashboard', this); return false;">
                        <i class="fas fa-chart-line"></i>
                        <span>Overview</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="siteConfig" data-permission="site_config" onclick="showAdminSection('siteConfig', this); return false;">
                        <i class="fas fa-wrench"></i>
                        <span>Site Configuration</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Member Management</h6>
                    <a href="#" class="admin-nav-item" data-section="members" data-permission="members" onclick="showAdminSection('members', this); return false;">
                        <i class="fas fa-users"></i>
                        <span>All Members</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="dataImport" data-permission="members" onclick="showAdminSection('dataImport', this); return false;">
                        <i class="fas fa-file-excel"></i>
                        <span>Data Import (Excel)</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="dbExplorer" data-permission="members" onclick="showAdminSection('dbExplorer', this); return false;">
                        <i class="fas fa-database"></i>
                        <span>DB Explorer</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="payments" data-permission="payments" onclick="showAdminSection('payments', this); return false;">
                        <i class="fas fa-credit-card"></i>
                        <span>Payment Verification</span>
                        <span class="admin-badge warning">5</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Email</h6>
                    <a href="#" class="admin-nav-item" data-section="gmail" data-permission="communications" onclick="showAdminSection('gmail', this); return false;">
                        <i class="fas fa-envelope"></i>
                        <span>Email Management</span>
                        <span class="admin-badge" id="gmailUnreadBadge" style="display:none">0</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Events</h6>
                    <a href="#" class="admin-nav-item" data-section="events" data-permission="events" onclick="showAdminSection('events', this); return false;">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Event Management</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="evite" data-permission="evite" onclick="showAdminSection('evite', this); return false;">
                        <i class="fas fa-envelope-open-text"></i>
                        <span>Evite / Invitations</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="rsvps" data-permission="rsvps" onclick="showAdminSection('rsvps', this); return false;">
                        <i class="fas fa-user-check"></i>
                        <span>RSVPs & Check-ins</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Communication</h6>
                    <a href="#" class="admin-nav-item" data-section="complaints" data-permission="complaints" onclick="showAdminSection('complaints', this); return false;">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Complaints</span>
                        <span class="admin-badge">3</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="surveys" data-permission="surveys" onclick="showAdminSection('surveys', this); return false;">
                        <i class="fas fa-poll"></i>
                        <span>Survey Admin</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="announcements" data-permission="announcements" onclick="showAdminSection('announcements', this); return false;">
                        <i class="fas fa-bullhorn"></i>
                        <span>Announcements</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Media</h6>
                    <a href="#" class="admin-nav-item" data-section="radio" data-permission="radio" onclick="showAdminSection('radio', this); return false;">
                        <i class="fas fa-broadcast-tower"></i>
                        <span>Radio Control</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="magazine" data-permission="magazine" onclick="showAdminSection('magazine', this); return false;">
                        <i class="fas fa-newspaper"></i>
                        <span>Magazine Admin</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Professional</h6>
                    <a href="#" class="admin-nav-item" data-section="careers" data-permission="careers" onclick="showAdminSection('careers', this); return false;">
                        <i class="fas fa-briefcase"></i>
                        <span>Career Directory</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Finance</h6>
                    <a href="#" class="admin-nav-item" data-section="budget" data-permission="budget" onclick="showAdminSection('budget', this); return false;">
                        <i class="fas fa-wallet"></i>
                        <span>Budget & Finance</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="vendors" data-permission="vendors" onclick="showAdminSection('vendors', this); return false;">
                        <i class="fas fa-store"></i>
                        <span>Vendors & Sponsors</span>
                    </a>
                </div>

                <div class="admin-sidebar-section">
                    <h6>Operations</h6>
                    <a href="#" class="admin-nav-item" data-section="volunteers" data-permission="volunteers" onclick="showAdminSection('volunteers', this); return false;">
                        <i class="fas fa-hands-helping"></i>
                        <span>Volunteers</span>
                    </a>
                    <a href="#" class="admin-nav-item" data-section="meetings" data-permission="meetings" onclick="showAdminSection('meetings', this); return false;">
                        <i class="fas fa-clipboard-list"></i>
                        <span>Meeting Minutes</span>
                    </a>
                </div>
            </nav>

            <!-- Main Content -->
            <main class="admin-main-content">
                <section id="adminDashboard" class="admin-section active">
                    <div class="admin-page-header">
                        <div>
                            <h2>Admin Dashboard</h2>
                            <p>Welcome back! Here's your BANF management overview.</p>
                        </div>
                        <button class="admin-primary" onclick="runDueDiligenceChecks('admin')">
                            <i class="fas fa-stethoscope"></i> Run System Check
                        </button>
                    </div>

                    <div class="admin-stats-grid">
                        <div class="admin-stat-card red">
                            <div class="admin-stat-icon red"><i class="fas fa-users"></i></div>
                            <div class="admin-stat-info">
                                <h3>156</h3>
                                <p>Total Members</p>
                            </div>
                        </div>
                        <div class="admin-stat-card green">
                            <div class="admin-stat-icon green"><i class="fas fa-dollar-sign"></i></div>
                            <div class="admin-stat-info">
                                <h3>$12,450</h3>
                                <p>Revenue (YTD)</p>
                            </div>
                        </div>
                        <div class="admin-stat-card orange">
                            <div class="admin-stat-icon orange"><i class="fas fa-calendar-check"></i></div>
                            <div class="admin-stat-info">
                                <h3>5</h3>
                                <p>Upcoming Events</p>
                            </div>
                        </div>
                        <div class="admin-stat-card blue">
                            <div class="admin-stat-icon blue"><i class="fas fa-tasks"></i></div>
                            <div class="admin-stat-info">
                                <h3>8</h3>
                                <p>Pending Actions</p>
                            </div>
                        </div>
                    </div>

                    <div class="admin-card-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-credit-card"></i></div>
                                <div>
                                    <h4>Payment Verification</h4>
                                    <span class="status-badge pending">5 Pending</span>
                                </div>
                            </div>
                            <p>Review and verify pending membership and event payments.</p>
                            <div class="admin-actions">
                                <button class="admin-secondary" onclick="showAdminSection('payments')"><i class="fas fa-check"></i> Review</button>
                                <button class="admin-secondary"><i class="fas fa-list"></i> View All</button>
                            </div>
                        </div>

                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon" style="background:rgba(33,150,243,0.1);color:#2196F3"><i class="fas fa-envelope"></i></div>
                                <div>
                                    <h4>Email Management</h4>
                                    <span class="status-badge active">Connected</span>
                                </div>
                            </div>
                            <p>Full inbox, compose, contact groups, search — manage all emails from <strong>banfjax@gmail.com</strong>.</p>
                            <div class="admin-actions">
                                <button class="admin-secondary" onclick="showAdminSection('gmail')"><i class="fas fa-inbox"></i> Open Inbox</button>
                                <button class="admin-secondary" onclick="showAdminSection('gmail'); setTimeout(()=>gmailShowTab('compose'),300)"><i class="fas fa-pen"></i> Compose</button>
                            </div>
                        </div>

                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-exclamation-circle"></i></div>
                                <div>
                                    <h4>Complaint Resolution</h4>
                                    <span class="status-badge new">3 New</span>
                                </div>
                            </div>
                            <p>Address member complaints and feedback submissions.</p>
                            <div class="admin-actions">
                                <button class="admin-secondary" onclick="showAdminSection('complaints')"><i class="fas fa-eye"></i> View</button>
                                <button class="admin-secondary"><i class="fas fa-reply"></i> Respond</button>
                            </div>
                        </div>

                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-music"></i></div>
                                <div>
                                    <h4>Radio Management</h4>
                                    <span class="status-badge active">Online</span>
                                </div>
                            </div>
                            <p>Manage playlists, approve song requests, and control radio.</p>
                            <div class="admin-actions">
                                <button class="admin-secondary" onclick="showAdminSection('radio')"><i class="fas fa-cog"></i> Manage</button>
                                <button class="admin-secondary"><i class="fas fa-list-music"></i> Playlist</button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="adminMembers" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Member Management</h2>
                            <p>View and manage all BANF members</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-user-plus"></i> Add Member</button>
                    </div>
                    <div class="admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Member ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>BANF-2024-001</td>
                                    <td>Rajib Das</td>
                                    <td>rajib.das@email.com</td>
                                    <td>Family</td>
                                    <td><span class="status-badge active">Active</span></td>
                                    <td><button class="admin-secondary"><i class="fas fa-eye"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="adminPayments" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-bolt me-2" style="color: #6528F7;"></i>Zelle Payment Automation</h2>
                            <p>Auto-detect Zelle payments from Gmail &amp; manage member payments</p>
                        </div>
                        <div style="display:flex; gap:0.5rem; flex-wrap:wrap;">
                            <button class="admin-primary" onclick="zelleManualScan()" id="btnZelleScan">
                                <i class="fas fa-search"></i> Scan Gmail Now
                            </button>
                            <button class="admin-secondary" id="btnZelleAutoToggle" onclick="zelleTogglePoller()">
                                <i class="fas fa-sync-alt"></i> Auto-Poll: OFF
                            </button>
                        </div>
                    </div>

                    <!-- Zelle Stats Cards -->
                    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(160px,1fr)); gap:1rem; margin-bottom:1.5rem;" id="zelleStatsGrid">
                        <div class="admin-stat-card" style="border-left:4px solid #6528F7;">
                            <div class="stat-label">Total Detected</div>
                            <div class="stat-value" id="zelleTotalDetected">0</div>
                        </div>
                        <div class="admin-stat-card" style="border-left:4px solid #FFC107;">
                            <div class="stat-label">Pending Review</div>
                            <div class="stat-value" id="zellePendingCount" style="color:#FFC107;">0</div>
                        </div>
                        <div class="admin-stat-card" style="border-left:4px solid #28a745;">
                            <div class="stat-label">Verified</div>
                            <div class="stat-value" id="zelleVerifiedCount" style="color:#28a745;">0</div>
                        </div>
                        <div class="admin-stat-card" style="border-left:4px solid #17a2b8;">
                            <div class="stat-label">Auto-Matched</div>
                            <div class="stat-value" id="zelleAutoMatched">0</div>
                        </div>
                        <div class="admin-stat-card" style="border-left:4px solid #28a745;">
                            <div class="stat-label">Total Collected</div>
                            <div class="stat-value" id="zelleTotalAmount" style="color:#28a745;">$0</div>
                        </div>
                        <div class="admin-stat-card" style="border-left:4px solid #6c757d;">
                            <div class="stat-label">Last Scan</div>
                            <div class="stat-value" id="zelleLastScan" style="font-size:0.9rem;">Never</div>
                        </div>
                    </div>

                    <!-- Scan Status Banner -->
                    <div id="zelleScanBanner" style="display:none; padding:1rem; border-radius:8px; margin-bottom:1rem; background:#e8f5e9; border:1px solid #4caf50;">
                        <i class="fas fa-check-circle" style="color:#4caf50; margin-right:0.5rem;"></i>
                        <span id="zelleScanMessage">Scan complete</span>
                    </div>

                    <!-- Filter Tabs -->
                    <div style="display:flex; gap:0.5rem; margin-bottom:1rem; flex-wrap:wrap;">
                        <button class="admin-primary" onclick="zelleFilterPayments('all')" id="zelleFilterAll" style="font-size:0.85rem;">All</button>
                        <button class="admin-secondary" onclick="zelleFilterPayments('pending')" id="zelleFilterPending" style="font-size:0.85rem;">⏳ Pending</button>
                        <button class="admin-secondary" onclick="zelleFilterPayments('auto_verified')" id="zelleFilterAuto" style="font-size:0.85rem;">🤖 Auto-Verified</button>
                        <button class="admin-secondary" onclick="zelleFilterPayments('verified')" id="zelleFilterVerified" style="font-size:0.85rem;">✅ Verified</button>
                        <button class="admin-secondary" onclick="zelleFilterPayments('rejected')" id="zelleFilterRejected" style="font-size:0.85rem;">❌ Rejected</button>
                        <button class="admin-secondary" onclick="zelleSeedTestData()" style="font-size:0.85rem; margin-left:auto;">
                            <i class="fas fa-flask"></i> Load Test Data
                        </button>
                    </div>

                    <!-- Payments Table -->
                    <div class="admin-table" style="overflow-x:auto;">
                        <table id="zellePaymentsTable">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Date</th>
                                    <th>From (Zelle)</th>
                                    <th>Amount</th>
                                    <th>Memo</th>
                                    <th>Bank</th>
                                    <th>Matched Member</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="zellePaymentsBody">
                                <tr>
                                    <td colspan="9" class="text-center" style="padding:2rem; color:#999;">
                                        <i class="fas fa-inbox" style="font-size:2rem; display:block; margin-bottom:0.5rem;"></i>
                                        No Zelle payments detected yet. Click "Scan Gmail Now" or "Load Test Data" to start.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Member Match Modal (inline) -->
                    <div id="zelleMatchModal" style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center;">
                        <div style="background:white; border-radius:12px; padding:2rem; max-width:500px; width:90%; max-height:80vh; overflow-y:auto;">
                            <h4><i class="fas fa-link me-2"></i>Match Payment to Member</h4>
                            <p style="color:#666;">Payment: <strong id="zelleMatchPaymentInfo"></strong></p>
                            <div style="margin:1rem 0;">
                                <label class="form-label">Select Member</label>
                                <select class="form-select" id="zelleMatchMemberSelect">
                                    <option value="">-- Select a member --</option>
                                </select>
                            </div>
                            <div style="display:flex; gap:0.5rem; justify-content:flex-end;">
                                <button class="admin-secondary" onclick="zelleCloseMatchModal()">Cancel</button>
                                <button class="admin-primary" onclick="zelleConfirmMatch()">
                                    <i class="fas fa-check"></i> Match & Verify
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="adminEvents" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Event Management</h2>
                            <p>Create and manage BANF events</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-plus"></i> Create Event</button>
                    </div>
                    <div class="admin-card-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-om"></i></div>
                                <div>
                                    <h4>Nabo Borsho 1433</h4>
                                    <span class="status-badge active">Published</span>
                                </div>
                            </div>
                            <p><strong>April 25, 2026</strong> • 124 RSVPs</p>
                            <div class="admin-actions">
                                <button class="admin-secondary"><i class="fas fa-edit"></i> Edit</button>
                                <button class="admin-secondary"><i class="fas fa-users"></i> RSVPs</button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="adminRsvps" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>RSVPs & Check-ins</h2>
                            <p>Track attendee registrations and check-ins</p>
                        </div>
                        <button class="admin-primary" onclick="exportEviteReport()"><i class="fas fa-download"></i> Export Report</button>
                    </div>
                    <div id="rsvpSummaryStats" class="admin-stats-grid" style="margin-bottom: 1.5rem;">
                        <!-- Populated by renderRsvpDashboard -->
                    </div>
                    <div class="admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Event</th>
                                    <th>Member</th>
                                    <th>Status</th>
                                    <th>Adults</th>
                                    <th>Kids</th>
                                    <th>Dietary</th>
                                    <th>Notes</th>
                                    <th>Check-in</th>
                                </tr>
                            </thead>
                            <tbody id="rsvpTableBody">
                                <tr>
                                    <td>Nabo Borsho 1433</td>
                                    <td>Member #45</td>
                                    <td><span class="status-badge active">Registered</span></td>
                                    <td>2</td>
                                    <td>1</td>
                                    <td>None</td>
                                    <td>-</td>
                                    <td><button class="admin-secondary">Check-in</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- ========== EVITE / INVITATION SECTION ========== -->
                <section id="adminEvite" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-envelope-open-text me-2"></i>Evite / Invitations</h2>
                            <p>Send event invitations and track RSVP responses</p>
                        </div>
                        <button class="admin-primary" onclick="openSendEviteForm()"><i class="fas fa-paper-plane"></i> Send New Evite</button>
                    </div>

                    <!-- Send Evite Form (hidden by default) -->
                    <div id="sendEviteFormContainer" style="display:none; margin-bottom: 2rem;">
                        <div class="admin-card" style="border: 2px solid var(--gold);">
                            <h4><i class="fas fa-paper-plane me-2"></i>Compose Invitation</h4>
                            <form id="sendEviteForm" onsubmit="return handleSendEvite(event)">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Event Name *</label>
                                        <select class="form-control" id="eviteEventName" required>
                                            <option value="">Select event...</option>
                                            <option value="Nabo Borsho 1433">Nabo Borsho 1433 (Apr 25, 2026)</option>
                                            <option value="Summer Camp 2026">Summer Camp 2026 (Jun 15, 2026)</option>
                                            <option value="Spandan 2026">Spandan 2026 (Aug 2026)</option>
                                            <option value="Mahalaya 2026">Mahalaya 2026 (Oct 2026)</option>
                                            <option value="Durga Puja 2026">Durga Puja 2026 (Oct 2026)</option>
                                            <option value="Custom">Custom Event...</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">Template</label>
                                        <select class="form-control" id="eviteTemplate" onchange="applyEviteTemplate()">
                                            <option value="">Select template...</option>
                                            <option value="TPL-001">🪷 Cultural Event</option>
                                            <option value="TPL-002">📋 Meeting</option>
                                            <option value="TPL-003">🌳 Picnic/Outing</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label fw-bold">Event Date *</label>
                                        <input type="date" class="form-control" id="eviteDate" required>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label fw-bold">Event Time</label>
                                        <input type="text" class="form-control" id="eviteTime" placeholder="e.g. 5:00 PM - 10:00 PM">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label fw-bold">Venue</label>
                                        <input type="text" class="form-control" id="eviteVenue" placeholder="Event location">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Recipients</label>
                                        <select class="form-control" id="eviteRecipients">
                                            <option value="all">All Members (156)</option>
                                            <option value="active">Active Members Only (148)</option>
                                            <option value="family">Family Members (92)</option>
                                            <option value="ec">EC Members Only (10)</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Subject Line</label>
                                        <input type="text" class="form-control" id="eviteSubject" placeholder="You're invited to...">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Invitation Message</label>
                                        <textarea class="form-control" id="eviteMessage" rows="6" placeholder="Write your invitation message..."></textarea>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="eviteCollectDietary" checked>
                                            <label class="form-check-label">Collect dietary requirements</label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input class="form-check-input" type="checkbox" id="eviteCollectKids" checked>
                                            <label class="form-check-label">Collect adult/kid count</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="eviteAllowMaybe" checked>
                                            <label class="form-check-label">Allow "Maybe" responses</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-3" style="display:flex; gap:0.5rem; flex-wrap:wrap;">
                                    <button type="submit" class="admin-primary"><i class="fas fa-paper-plane me-1"></i> Send Invitations</button>
                                    <button type="button" class="admin-secondary" onclick="previewEvite()"><i class="fas fa-eye me-1"></i> Preview</button>
                                    <button type="button" class="admin-secondary" onclick="document.getElementById('sendEviteFormContainer').style.display='none'"><i class="fas fa-times me-1"></i> Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Evite History / Sent Invitations -->
                    <div id="eviteHistoryContainer">
                        <h4 class="mb-3"><i class="fas fa-history me-2"></i>Sent Invitations</h4>
                        <div id="eviteHistoryList" class="admin-card-grid">
                            <!-- Populated by renderEviteHistory() -->
                        </div>
                    </div>

                    <!-- RSVP Report Modal Area -->
                    <div id="eviteReportArea" style="display:none; margin-top: 2rem;">
                        <div class="admin-card" style="border-left: 4px solid var(--gold);">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                                <h4 id="eviteReportTitle"><i class="fas fa-chart-bar me-2"></i>RSVP Report</h4>
                                <div>
                                    <button class="admin-secondary" onclick="exportEviteReport()"><i class="fas fa-file-csv me-1"></i> Export CSV</button>
                                    <button class="admin-secondary" onclick="document.getElementById('eviteReportArea').style.display='none'"><i class="fas fa-times me-1"></i> Close</button>
                                </div>
                            </div>
                            <div id="eviteReportStats" class="admin-stats-grid" style="margin-bottom: 1rem;"></div>
                            <div id="eviteReportDietary" style="margin-bottom: 1rem;"></div>
                            <div class="admin-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Member</th>
                                            <th>Status</th>
                                            <th>Adults</th>
                                            <th>Kids</th>
                                            <th>Dietary</th>
                                            <th>Notes</th>
                                            <th>Responded</th>
                                        </tr>
                                    </thead>
                                    <tbody id="eviteReportTableBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ========== DATA IMPORT (EXCEL) SECTION ========== -->
                <section id="adminDataImport" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-file-excel me-2"></i>Data Import (Excel)</h2>
                            <p>Upload member data, event data, and payment records via Excel/CSV</p>
                        </div>
                    </div>

                    <div class="admin-card-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-users"></i></div>
                                <div>
                                    <h4>Member Import</h4>
                                    <span class="status-badge active">Ready</span>
                                </div>
                            </div>
                            <p>Upload member list from Excel/CSV. Required columns: First Name, Last Name, Email, Phone, Membership Type.</p>
                            <input type="file" id="memberImportFile" accept=".xlsx,.xls,.csv" style="display:none" onchange="handleExcelUpload('members', this)">
                            <div class="admin-actions">
                                <button class="admin-primary" onclick="document.getElementById('memberImportFile').click()"><i class="fas fa-upload me-1"></i> Upload</button>
                                <button class="admin-secondary" onclick="downloadTemplate('members')"><i class="fas fa-download me-1"></i> Template</button>
                            </div>
                        </div>

                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-calendar-alt"></i></div>
                                <div>
                                    <h4>Event Import</h4>
                                    <span class="status-badge active">Ready</span>
                                </div>
                            </div>
                            <p>Upload event schedule from Excel. Required columns: Event Name, Date, Time, Venue, Description.</p>
                            <input type="file" id="eventImportFile" accept=".xlsx,.xls,.csv" style="display:none" onchange="handleExcelUpload('events', this)">
                            <div class="admin-actions">
                                <button class="admin-primary" onclick="document.getElementById('eventImportFile').click()"><i class="fas fa-upload me-1"></i> Upload</button>
                                <button class="admin-secondary" onclick="downloadTemplate('events')"><i class="fas fa-download me-1"></i> Template</button>
                            </div>
                        </div>

                        <div class="admin-card">
                            <div class="admin-card-header">
                                <div class="admin-card-icon"><i class="fas fa-credit-card"></i></div>
                                <div>
                                    <h4>Payment Import</h4>
                                    <span class="status-badge active">Ready</span>
                                </div>
                            </div>
                            <p>Upload payment records from Excel. Required: Member Name, Amount, Date, Type, Status.</p>
                            <input type="file" id="paymentImportFile" accept=".xlsx,.xls,.csv" style="display:none" onchange="handleExcelUpload('payments', this)">
                            <div class="admin-actions">
                                <button class="admin-primary" onclick="document.getElementById('paymentImportFile').click()"><i class="fas fa-upload me-1"></i> Upload</button>
                                <button class="admin-secondary" onclick="downloadTemplate('payments')"><i class="fas fa-download me-1"></i> Template</button>
                            </div>
                        </div>
                    </div>

                    <!-- Import Preview Area -->
                    <div id="importPreviewArea" style="display:none; margin-top: 2rem;">
                        <div class="admin-card" style="border-left: 4px solid #4CAF50;">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                                <h4 id="importPreviewTitle"><i class="fas fa-table me-2"></i>Import Preview</h4>
                                <div>
                                    <button class="admin-primary" id="confirmImportBtn" onclick="confirmImport()"><i class="fas fa-check me-1"></i> Confirm Import</button>
                                    <button class="admin-secondary" onclick="document.getElementById('importPreviewArea').style.display='none'"><i class="fas fa-times me-1"></i> Cancel</button>
                                </div>
                            </div>
                            <div id="importPreviewStats" class="mb-3"></div>
                            <div class="admin-table" style="max-height: 400px; overflow-y: auto;">
                                <table>
                                    <thead id="importPreviewHead"></thead>
                                    <tbody id="importPreviewBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Import History -->
                    <div style="margin-top: 2rem;">
                        <h4><i class="fas fa-history me-2"></i>Import History</h4>
                        <div class="admin-table">
                            <table>
                                <thead>
                                    <tr><th>Date</th><th>Type</th><th>Records</th><th>Status</th><th>Imported By</th></tr>
                                </thead>
                                <tbody id="importHistoryBody">
                                    <tr>
                                        <td>Jan 15, 2026</td>
                                        <td>Members</td>
                                        <td>45 records</td>
                                        <td><span class="status-badge active">Success</span></td>
                                        <td>Admin User</td>
                                    </tr>
                                    <tr>
                                        <td>Feb 01, 2026</td>
                                        <td>Payments</td>
                                        <td>23 records</td>
                                        <td><span class="status-badge active">Success</span></td>
                                        <td>Subir Ghosh</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- ========== DB EXPLORER SECTION (Feature 7) ========== -->
                <section id="adminDbExplorer" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-database me-2"></i>Member Database Explorer</h2>
                            <p>Search, filter, and manage the member universe</p>
                        </div>
                        <div class="admin-actions">
                            <button class="admin-primary" id="dbExpAddBtn" onclick="MemberDBExplorer.showAddModal()" style="display:none"><i class="fas fa-plus me-1"></i> Add Member</button>
                            <button class="admin-secondary" id="dbExpExportCsvBtn" onclick="MemberDBExplorer.exportCSV()" style="display:none"><i class="fas fa-file-csv me-1"></i> Export CSV</button>
                            <button class="admin-secondary" id="dbExpExportXlsxBtn" onclick="MemberDBExplorer.exportExcel()" style="display:none"><i class="fas fa-file-excel me-1"></i> Export Excel</button>
                            <button class="admin-secondary" onclick="MemberDBExplorer.render()"><i class="fas fa-sync-alt me-1"></i> Refresh</button>
                        </div>
                    </div>

                    <!-- Stats Row -->
                    <div class="admin-card-grid" id="dbExpStats" style="margin-bottom:1.5rem;"></div>

                    <!-- Search & Filter Controls -->
                    <div class="admin-card" style="margin-bottom: 1.5rem;">
                        <div style="display:flex; flex-wrap:wrap; gap:1rem; align-items:flex-end;">
                            <div style="flex:2; min-width:200px;">
                                <label style="font-size:0.85rem; font-weight:600; margin-bottom:4px; display:block;">Search</label>
                                <input type="text" id="dbExpSearch" class="form-control" placeholder="Search by name, email, phone…" oninput="MemberDBExplorer.applyFilters()">
                            </div>
                            <div style="flex:1; min-width:140px;">
                                <label style="font-size:0.85rem; font-weight:600; margin-bottom:4px; display:block;">Status</label>
                                <select id="dbExpFilterStatus" class="form-select" onchange="MemberDBExplorer.applyFilters()">
                                    <option value="">All Statuses</option>
                                    <option value="Active">Active</option>
                                    <option value="Expired">Expired</option>
                                    <option value="Pending">Pending</option>
                                </select>
                            </div>
                            <div style="flex:1; min-width:140px;">
                                <label style="font-size:0.85rem; font-weight:600; margin-bottom:4px; display:block;">Type</label>
                                <select id="dbExpFilterType" class="form-select" onchange="MemberDBExplorer.applyFilters()">
                                    <option value="">All Types</option>
                                    <option value="Family">Family</option>
                                    <option value="Individual">Individual</option>
                                    <option value="Couple">Couple</option>
                                    <option value="Student">Student</option>
                                    <option value="Senior">Senior</option>
                                </select>
                            </div>
                            <div style="flex:1; min-width:140px;">
                                <label style="font-size:0.85rem; font-weight:600; margin-bottom:4px; display:block;">Sort By</label>
                                <select id="dbExpSort" class="form-select" onchange="MemberDBExplorer.applyFilters()">
                                    <option value="lastName">Last Name</option>
                                    <option value="firstName">First Name</option>
                                    <option value="joinDate">Join Date</option>
                                    <option value="type">Membership Type</option>
                                    <option value="status">Status</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Data Table -->
                    <div class="admin-card">
                        <div class="admin-table" style="max-height: 500px; overflow-y: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Phone</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th>Joined</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="dbExpTableBody"></tbody>
                            </table>
                        </div>
                        <!-- Pagination -->
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:1rem; padding:0 0.5rem;">
                            <span id="dbExpPageInfo" style="font-size:0.85rem; color:#666;"></span>
                            <div>
                                <button class="admin-secondary" onclick="MemberDBExplorer.prevPage()" id="dbExpPrevBtn" style="margin-right:0.5rem;"><i class="fas fa-chevron-left me-1"></i>Prev</button>
                                <button class="admin-secondary" onclick="MemberDBExplorer.nextPage()" id="dbExpNextBtn">Next<i class="fas fa-chevron-right ms-1"></i></button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="adminComplaints" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Complaint Resolution</h2>
                            <p>Address member concerns and feedback</p>
                        </div>
                    </div>
                    <div class="admin-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Date</th>
                                    <th>Category</th>
                                    <th>Subject</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#C-001</td>
                                    <td>Feb 10, 2026</td>
                                    <td>Event</td>
                                    <td>Food quality at last event</td>
                                    <td><span class="status-badge new">New</span></td>
                                    <td>
                                        <button class="admin-secondary"><i class="fas fa-eye"></i></button>
                                        <button class="admin-secondary"><i class="fas fa-reply"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="adminSurveys" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Survey Administration</h2>
                            <p>Create and manage member surveys</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-plus"></i> Create Survey</button>
                    </div>
                </section>

                <section id="adminAnnouncements" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Announcements</h2>
                            <p>Publish updates to members and the community</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-bullhorn"></i> New Announcement</button>
                    </div>
                </section>

                <section id="adminRadio" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Radio Control Panel</h2>
                            <p>Manage BANF Radio 24/7 broadcasting & schedule</p>
                        </div>
                        <button class="admin-primary" id="radioStatusBtn" onclick="toggleRadioStatus()"><i class="fas fa-broadcast-tower"></i> <span id="radioStatusText">Online</span></button>
                    </div>

                    <!-- Radio Status Dashboard -->
                    <div class="row g-4 mb-4">
                        <div class="col-md-3">
                            <div class="stat-card" style="border-left: 4px solid #4CAF50;">
                                <div class="stat-number" style="color: #4CAF50;" id="radioListeners">24</div>
                                <div class="stat-label">Active Listeners</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card" style="border-left: 4px solid #2196F3;">
                                <div class="stat-number" style="color: #2196F3;" id="radioUptime">99.2%</div>
                                <div class="stat-label">Uptime (30 days)</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card" style="border-left: 4px solid #FF9800;">
                                <div class="stat-number" style="color: #FF9800;" id="radioSongRequests">12</div>
                                <div class="stat-label">Song Requests</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card" style="border-left: 4px solid #9C27B0;">
                                <div class="stat-number" style="color: #9C27B0;" id="radioLibrarySize">1,247</div>
                                <div class="stat-label">Songs in Library</div>
                            </div>
                        </div>
                    </div>

                    <!-- Now Playing & Controls -->
                    <div class="row g-4 mb-4">
                        <div class="col-lg-6">
                            <div class="admin-card">
                                <h5><i class="fas fa-play-circle me-2 text-success"></i>Now Playing</h5>
                                <div class="p-3 rounded-3 mb-3" style="background: linear-gradient(135deg, #673AB7, #9C27B0); color: #fff;">
                                    <div class="d-flex align-items-center">
                                        <div class="me-3" style="font-size: 2.5rem;">🎵</div>
                                        <div>
                                            <h5 class="mb-1" id="adminNowPlaying">Rabindra Sangeet Special</h5>
                                            <p class="mb-0 opacity-75" id="adminNowCategory">Classical Music</p>
                                            <small class="opacity-50" id="adminNowTime">Playing since 2:00 PM</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-2 flex-wrap">
                                    <button class="btn btn-sm btn-outline-primary" onclick="adminSkipTrack(-1)"><i class="fas fa-backward me-1"></i>Previous</button>
                                    <button class="btn btn-sm btn-success" onclick="adminTogglePlay()" id="adminPlayBtn"><i class="fas fa-pause me-1"></i>Playing</button>
                                    <button class="btn btn-sm btn-outline-primary" onclick="adminSkipTrack(1)"><i class="fas fa-forward me-1"></i>Next</button>
                                    <button class="btn btn-sm btn-outline-warning" onclick="adminRefreshStatus()"><i class="fas fa-sync-alt me-1"></i>Refresh</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="admin-card">
                                <h5><i class="fas fa-list me-2 text-info"></i>Today's Schedule</h5>
                                <div class="table-responsive" style="max-height: 250px; overflow-y: auto;">
                                    <table class="table table-sm mb-0" id="radioScheduleTable">
                                        <thead><tr><th>Time</th><th>Program</th><th>Category</th><th>Status</th></tr></thead>
                                        <tbody>
                                            <tr class="table-success"><td>6:00 AM</td><td>Prabhati Sangeet</td><td>Devotional</td><td><span class="badge bg-success">Completed</span></td></tr>
                                            <tr class="table-success"><td>8:00 AM</td><td>Morning Ragas</td><td>Classical</td><td><span class="badge bg-success">Completed</span></td></tr>
                                            <tr class="table-success"><td>10:00 AM</td><td>Rabindra Sangeet</td><td>Classical</td><td><span class="badge bg-success">Completed</span></td></tr>
                                            <tr class="table-warning"><td>12:00 PM</td><td>Bengali Modern Hits</td><td>Modern Music</td><td><span class="badge bg-warning text-dark">Now Playing</span></td></tr>
                                            <tr><td>2:00 PM</td><td>Folk Melodies</td><td>Folk Music</td><td><span class="badge bg-secondary">Upcoming</span></td></tr>
                                            <tr><td>4:00 PM</td><td>Children's Hour</td><td>Children</td><td><span class="badge bg-secondary">Upcoming</span></td></tr>
                                            <tr><td>6:00 PM</td><td>Evening Ragas</td><td>Classical</td><td><span class="badge bg-secondary">Upcoming</span></td></tr>
                                            <tr><td>8:00 PM</td><td>Literature Corner</td><td>Literature</td><td><span class="badge bg-secondary">Upcoming</span></td></tr>
                                            <tr><td>10:00 PM</td><td>Night Music</td><td>Modern Music</td><td><span class="badge bg-secondary">Upcoming</span></td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Song Requests & Library -->
                    <div class="row g-4">
                        <div class="col-lg-6">
                            <div class="admin-card">
                                <h5><i class="fas fa-hand-paper me-2 text-warning"></i>Pending Song Requests</h5>
                                <div class="table-responsive">
                                    <table class="table table-sm" id="songRequestsTable">
                                        <thead><tr><th>Member</th><th>Song</th><th>Artist</th><th>Actions</th></tr></thead>
                                        <tbody>
                                            <tr>
                                                <td>Amit Roy</td>
                                                <td>Amar Sonar Bangla</td>
                                                <td>Rabindranath Tagore</td>
                                                <td>
                                                    <button class="btn btn-sm btn-success" onclick="approveSongRequest(this)" title="Approve"><i class="fas fa-check"></i></button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectSongRequest(this)" title="Reject"><i class="fas fa-times"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Shreya Das</td>
                                                <td>Ekla Cholo Re</td>
                                                <td>Rabindranath Tagore</td>
                                                <td>
                                                    <button class="btn btn-sm btn-success" onclick="approveSongRequest(this)" title="Approve"><i class="fas fa-check"></i></button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectSongRequest(this)" title="Reject"><i class="fas fa-times"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Rina Mukherjee</td>
                                                <td>Ami Tomay Joto</td>
                                                <td>Kishore Kumar</td>
                                                <td>
                                                    <button class="btn btn-sm btn-success" onclick="approveSongRequest(this)" title="Approve"><i class="fas fa-check"></i></button>
                                                    <button class="btn btn-sm btn-danger" onclick="rejectSongRequest(this)" title="Reject"><i class="fas fa-times"></i></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="admin-card">
                                <h5><i class="fas fa-database me-2 text-primary"></i>Music Library</h5>
                                <div class="row g-3 mb-3">
                                    <div class="col-6">
                                        <div class="p-2 rounded text-center" style="background: rgba(139,69,19,0.1);">
                                            <strong>🎻 Classical</strong><br><span class="text-muted">342 songs</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="p-2 rounded text-center" style="background: rgba(34,139,34,0.1);">
                                            <strong>🪘 Folk</strong><br><span class="text-muted">218 songs</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="p-2 rounded text-center" style="background: rgba(65,105,225,0.1);">
                                            <strong>🎵 Modern</strong><br><span class="text-muted">405 songs</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="p-2 rounded text-center" style="background: rgba(255,99,71,0.1);">
                                            <strong>🙏 Devotional</strong><br><span class="text-muted">157 songs</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="p-2 rounded text-center" style="background: rgba(128,0,128,0.1);">
                                            <strong>📚 Literature</strong><br><span class="text-muted">89 readings</span>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="p-2 rounded text-center" style="background: rgba(255,105,180,0.1);">
                                            <strong>👶 Children</strong><br><span class="text-muted">36 programs</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-sm btn-outline-primary" onclick="alert('Upload Song - Demo: Opens file browser to add songs to library')">
                                    <i class="fas fa-upload me-1"></i>Upload Song
                                </button>
                                <button class="btn btn-sm btn-outline-secondary ms-1" onclick="alert('Manage Library - Demo: Opens full library management view')">
                                    <i class="fas fa-list me-1"></i>Full Library
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="adminMagazine" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Magazine Administration</h2>
                            <p>Review submissions and manage BANF magazine content</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-newspaper"></i> Review Submissions</button>
                    </div>
                </section>

                <section id="adminBudget" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Budget & Finance</h2>
                            <p>Manage BANF financial records</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-file-pdf"></i> Generate Report</button>
                    </div>
                </section>

                <section id="adminVendors" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Vendors & Sponsors</h2>
                            <p>Manage event vendors and sponsors</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-plus"></i> Add Vendor</button>
                    </div>
                </section>

                <section id="adminVolunteers" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Volunteers</h2>
                            <p>Coordinate volunteer assignments and availability</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-hands-helping"></i> Assign Volunteers</button>
                    </div>
                </section>

                <section id="adminMeetings" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2>Meeting Minutes</h2>
                            <p>Upload and manage EC meeting minutes</p>
                        </div>
                        <button class="admin-primary"><i class="fas fa-upload"></i> Upload Minutes</button>
                    </div>
                </section>

                <!-- ========== GMAIL / EMAIL SECTION ========== -->
                <section id="adminGmail" class="admin-section">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-envelope me-2"></i>Email Management (Gmail)</h2>
                            <p>Read, send, and manage emails from <strong>banfjax@gmail.com</strong></p>
                        </div>
                        <div style="display:flex;gap:0.5rem;">
                            <button class="admin-secondary" onclick="gmailCheckConnection()"><i class="fas fa-plug me-1"></i> Check Connection</button>
                            <button class="admin-primary" onclick="gmailOpenCompose()"><i class="fas fa-pen me-1"></i> Compose Email</button>
                        </div>
                    </div>

                    <!-- Connection Status -->
                    <div id="gmailConnectionStatus" class="admin-card" style="border-left:4px solid #ccc;margin-bottom:1rem;">
                        <div style="display:flex;align-items:center;gap:1rem;">
                            <i class="fas fa-circle" id="gmailStatusIcon" style="color:#ccc;font-size:1.2rem;"></i>
                            <div>
                                <strong id="gmailStatusText">Checking connection...</strong>
                                <p class="mb-0 text-muted" id="gmailStatusDetail">Click "Check Connection" to verify Gmail access</p>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Row -->
                    <div class="admin-stats-grid" id="gmailStatsRow" style="margin-bottom:1.5rem;">
                        <div class="admin-stat-card"><div class="admin-stat-value" id="gmailStatInbox">--</div><div class="admin-stat-label">Inbox</div></div>
                        <div class="admin-stat-card"><div class="admin-stat-value" id="gmailStatUnread" style="color:#f44336">--</div><div class="admin-stat-label">Unread</div></div>
                        <div class="admin-stat-card"><div class="admin-stat-value" id="gmailStatSent">--</div><div class="admin-stat-label">Sent Today</div></div>
                        <div class="admin-stat-card"><div class="admin-stat-value" id="gmailStatGroups">--</div><div class="admin-stat-label">Contact Groups</div></div>
                    </div>

                    <!-- Tab Navigation -->
                    <ul class="nav nav-tabs mb-3" id="gmailTabs">
                        <li class="nav-item"><a class="nav-link active" href="#" onclick="gmailShowTab('inbox');return false;"><i class="fas fa-inbox me-1"></i> Inbox</a></li>
                        <li class="nav-item"><a class="nav-link" href="#" onclick="gmailShowTab('compose');return false;"><i class="fas fa-pen me-1"></i> Compose</a></li>
                        <li class="nav-item"><a class="nav-link" href="#" onclick="gmailShowTab('contacts');return false;"><i class="fas fa-address-book me-1"></i> Contact Groups</a></li>
                        <li class="nav-item"><a class="nav-link" href="#" onclick="gmailShowTab('search');return false;"><i class="fas fa-search me-1"></i> Search</a></li>
                    </ul>

                    <!-- INBOX TAB -->
                    <div id="gmailTabInbox" class="gmail-tab-content">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                            <h4><i class="fas fa-inbox me-2"></i>Inbox</h4>
                            <div style="display:flex;gap:0.5rem;">
                                <select class="form-control" id="gmailFolderSelect" style="width:auto" onchange="gmailLoadInbox()">
                                    <option value="INBOX">Inbox</option>
                                    <option value="[Gmail]/Sent Mail">Sent</option>
                                    <option value="[Gmail]/Drafts">Drafts</option>
                                    <option value="[Gmail]/Starred">Starred</option>
                                    <option value="[Gmail]/Spam">Spam</option>
                                    <option value="[Gmail]/Trash">Trash</option>
                                </select>
                                <button class="admin-secondary" onclick="gmailLoadInbox()"><i class="fas fa-sync-alt"></i> Refresh</button>
                            </div>
                        </div>
                        <div class="admin-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th style="width:25%">From</th>
                                        <th style="width:40%">Subject</th>
                                        <th style="width:15%">Date</th>
                                        <th style="width:5%"><i class="fas fa-paperclip"></i></th>
                                        <th style="width:15%">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="gmailInboxTableBody">
                                    <tr><td colspan="5" class="text-center text-muted"><i class="fas fa-spinner fa-spin me-2"></i>Loading emails...</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="display:flex;justify-content:center;gap:0.5rem;margin-top:1rem;" id="gmailPagination"></div>
                    </div>

                    <!-- COMPOSE TAB -->
                    <div id="gmailTabCompose" class="gmail-tab-content" style="display:none">
                        <div class="admin-card" style="border:2px solid var(--gold);">
                            <h4><i class="fas fa-pen-fancy me-2"></i>Compose Email</h4>
                            <form id="gmailComposeForm" onsubmit="return gmailSendEmail(event)">
                                <div class="row g-3">
                                    <div class="col-12">
                                        <label class="form-label fw-bold">To *</label>
                                        <input type="text" class="form-control" id="gmailComposeTo" required placeholder="recipient@email.com (comma-separated for multiple)">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">CC</label>
                                        <input type="text" class="form-control" id="gmailComposeCc" placeholder="cc@email.com">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label fw-bold">BCC</label>
                                        <input type="text" class="form-control" id="gmailComposeBcc" placeholder="bcc@email.com">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Subject *</label>
                                        <input type="text" class="form-control" id="gmailComposeSubject" required placeholder="Email subject">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label fw-bold">Message</label>
                                        <textarea class="form-control" id="gmailComposeBody" rows="10" placeholder="Write your message here..."></textarea>
                                    </div>
                                </div>
                                <div class="mt-3" style="display:flex;gap:0.5rem;">
                                    <button type="submit" class="admin-primary"><i class="fas fa-paper-plane me-1"></i> Send Email</button>
                                    <button type="button" class="admin-secondary" onclick="gmailShowTab('inbox')"><i class="fas fa-times me-1"></i> Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- CONTACT GROUPS TAB -->
                    <div id="gmailTabContacts" class="gmail-tab-content" style="display:none">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;">
                            <h4><i class="fas fa-address-book me-2"></i>Contact Groups</h4>
                            <button class="admin-primary" onclick="gmailCreateGroupPrompt()"><i class="fas fa-plus me-1"></i> New Group</button>
                        </div>
                        <div id="gmailContactGroupsList" class="admin-card-grid">
                            <div class="text-muted"><i class="fas fa-spinner fa-spin me-2"></i>Loading groups...</div>
                        </div>

                        <!-- Add Contact Form (hidden) -->
                        <div id="gmailAddContactForm" style="display:none;margin-top:1.5rem;">
                            <div class="admin-card" style="border:2px solid var(--gold);">
                                <h5><i class="fas fa-user-plus me-2"></i>Add Contact to <span id="gmailAddContactGroupName"></span></h5>
                                <div class="row g-3">
                                    <div class="col-md-5">
                                        <input type="text" class="form-control" id="gmailAddContactName" placeholder="Full Name">
                                    </div>
                                    <div class="col-md-5">
                                        <input type="email" class="form-control" id="gmailAddContactEmail" placeholder="email@example.com">
                                    </div>
                                    <div class="col-md-2">
                                        <button class="admin-primary w-100" onclick="gmailAddContactToGroup()"><i class="fas fa-plus"></i> Add</button>
                                    </div>
                                </div>
                                <button class="admin-secondary mt-2" onclick="document.getElementById('gmailAddContactForm').style.display='none'"><i class="fas fa-times me-1"></i> Close</button>
                            </div>
                        </div>
                    </div>

                    <!-- SEARCH TAB -->
                    <div id="gmailTabSearch" class="gmail-tab-content" style="display:none">
                        <div class="admin-card">
                            <h4><i class="fas fa-search me-2"></i>Search Emails</h4>
                            <div class="row g-3">
                                <div class="col-md-10">
                                    <input type="text" class="form-control" id="gmailSearchQuery" placeholder="Search by subject, sender, or content..." onkeydown="if(event.key==='Enter')gmailSearchEmails()">
                                </div>
                                <div class="col-md-2">
                                    <button class="admin-primary w-100" onclick="gmailSearchEmails()"><i class="fas fa-search"></i> Search</button>
                                </div>
                            </div>
                        </div>
                        <div id="gmailSearchResults" style="margin-top:1rem;"></div>
                    </div>

                    <!-- EMAIL READER MODAL -->
                    <div id="gmailReaderArea" style="display:none;margin-top:1.5rem;">
                        <div class="admin-card" style="border-left:4px solid var(--gold);">
                            <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem;">
                                <div>
                                    <h4 id="gmailReaderSubject" style="margin-bottom:0.25rem;"></h4>
                                    <p class="text-muted mb-1" id="gmailReaderFrom"></p>
                                    <small class="text-muted" id="gmailReaderDate"></small>
                                </div>
                                <div style="display:flex;gap:0.5rem;">
                                    <button class="admin-secondary" onclick="gmailReplyTo()"><i class="fas fa-reply me-1"></i> Reply</button>
                                    <button class="admin-secondary" onclick="gmailForwardEmail()"><i class="fas fa-share me-1"></i> Forward</button>
                                    <button class="admin-secondary" onclick="document.getElementById('gmailReaderArea').style.display='none'"><i class="fas fa-times"></i></button>
                                </div>
                            </div>
                            <hr>
                            <div id="gmailReaderBody" style="white-space:pre-wrap;line-height:1.6;max-height:500px;overflow-y:auto;"></div>
                            <div id="gmailReaderAttachments" style="margin-top:1rem;"></div>
                        </div>
                    </div>
                </section>

                <!-- ========== CAREERS DIRECTORY ADMIN (Feature 6) ========== -->
                <section id="adminCareers" class="admin-section" style="display:none;">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-briefcase me-2"></i>Career Directory Management</h2>
                            <p>Review, approve, and manage member career profiles</p>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="admin-btn" onclick="exportCareerDirectory()"><i class="fas fa-download me-1"></i>Export CSV</button>
                            <button class="admin-btn admin-btn-primary" onclick="openAddCareerModal()"><i class="fas fa-plus me-1"></i>Add Profile</button>
                        </div>
                    </div>

                    <!-- Stats Row -->
                    <div class="row g-3 mb-4">
                        <div class="col-sm-3"><div class="admin-stat-card"><div class="admin-stat-number" id="careerTotalStat">0</div><div class="admin-stat-label">Total Profiles</div></div></div>
                        <div class="col-sm-3"><div class="admin-stat-card"><div class="admin-stat-number text-success" id="careerVisibleStat">0</div><div class="admin-stat-label">Visible</div></div></div>
                        <div class="col-sm-3"><div class="admin-stat-card"><div class="admin-stat-number text-warning" id="careerHiddenStat">0</div><div class="admin-stat-label">Hidden</div></div></div>
                        <div class="col-sm-3"><div class="admin-stat-card"><div class="admin-stat-number text-info" id="careerIndustryStat">0</div><div class="admin-stat-label">Industries</div></div></div>
                    </div>

                    <!-- Profiles Table -->
                    <div class="admin-table">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Title</th>
                                    <th>Industry</th>
                                    <th>Guidance Types</th>
                                    <th>Visible</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminCareerTableBody">
                                <tr><td colspan="6" class="text-center text-muted py-3">Loading career profiles...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- ========== SITE CONFIGURATION SECTION (Feature 1) ========== -->
                <section id="adminSiteConfig" class="admin-section" style="display:none;">
                    <div class="admin-page-header">
                        <div>
                            <h2><i class="fas fa-wrench me-2"></i>Site Configuration</h2>
                            <p>Manage landing page sections, membership plans, sponsorship tiers, and ad slots</p>
                        </div>
                    </div>
                    <div id="siteConfigContent">
                        <div class="text-center text-muted py-4"><i class="fas fa-spinner fa-spin me-2"></i>Loading configuration...</div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- ========== MEMBER PORTAL MODAL ========== -->
    <div class="modal fade" id="memberPortalModal" tabindex="-1" aria-labelledby="memberPortalModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="border-radius: 16px; overflow: hidden; border: none;">
                
                <!-- Modal Header with gradient -->
                <div class="modal-header" style="background: var(--gradient-hero); border: none; padding: 1.5rem;">
                    <div class="d-flex align-items-center">
                        <div class="me-3" style="width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-user-circle fa-2x text-white"></i>
                        </div>
                        <div>
                            <h5 class="modal-title text-white mb-0" id="memberPortalModalLabel">Member Portal</h5>
                            <small class="text-white-50" id="modalSubtitle">Access your BANF account</small>
                        </div>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                
                <!-- Modal Body -->
                <div class="modal-body p-0">
                    
                    <!-- Visitor Notice (shown by default) -->
                    <div id="visitorNotice" class="p-4" style="background: linear-gradient(135deg, #fff8f0, #fff); display: block;">
                        <div class="alert alert-info mb-3" style="background: linear-gradient(135deg, #e3f2fd, #fff); border: 1px solid #bbdefb;">
                            <i class="fas fa-info-circle me-2"></i>
                            <strong>Members-Only Portal</strong><br>
                            <small>This area is for registered BANF members only. If you have paid your membership fee, you can create your account here.</small>
                        </div>
                        
                        <!-- Tab Navigation -->
                        <ul class="nav nav-pills nav-justified mb-4" id="memberPortalTabs">
                            <li class="nav-item">
                                <button class="nav-link active" id="login-tab" onclick="showPortalTab('login')" style="border-radius: 50px;">
                                    <i class="fas fa-sign-in-alt me-1"></i> Login
                                </button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" id="signup-tab" onclick="showPortalTab('signup')" style="border-radius: 50px;">
                                    <i class="fas fa-user-plus me-1"></i> Sign Up
                                </button>
                            </li>
                            <li class="nav-item">
                                <button class="nav-link" id="code-tab" onclick="showPortalTab('code')" style="border-radius: 50px;">
                                    <i class="fas fa-key me-1"></i> Registration Code
                                </button>
                            </li>
                        </ul>
                        
                        <!-- LOGIN FORM -->
                        <div id="loginForm" class="portal-form">
                            <form onsubmit="return handleLogin(event)">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-envelope me-2"></i>Email or Username</label>
                                    <input type="text" class="form-control form-control-lg" id="loginEmail" placeholder="Enter email or username" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-lock me-2"></i>Password</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control form-control-lg" id="loginPassword" placeholder="Enter password" required>
                                        <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('loginPassword', this)">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="rememberMe">
                                        <label class="form-check-label" for="rememberMe">Remember me</label>
                                    </div>
                                    <a href="#" onclick="showPortalTab('forgot'); return false;" class="small">Forgot Password?</a>
                                </div>
                                <button type="submit" class="btn btn-lg w-100" style="background: var(--gradient-primary); color: #fff; border: none;">
                                    <i class="fas fa-sign-in-alt me-2"></i>Login
                                </button>
                            </form>
                            <div class="text-center mt-3">
                                <small class="text-muted">Don't have an account? <a href="#" onclick="showPortalTab('signup'); return false;">Sign up here</a></small>
                            </div>
                            <!-- Demo Credentials Hint -->
                            <div class="mt-4 p-3 rounded" style="background: rgba(255,193,7,0.1); border: 1px dashed var(--gold);">
                                <small class="text-muted">
                                    <strong><i class="fas fa-lightbulb me-1"></i>Demo Mode:</strong><br>
                                    Username: <code>member_test</code> | Password: <code>test</code><br>
                                    <span class="text-warning">or</span> <code>admin_test</code> | <code>admin</code>
                                </small>
                            </div>
                        </div>
                        
                        <!-- SIGN UP FORM (Step 1: Basic Info) -->
                        <div id="signupForm" class="portal-form" style="display: none;">
                            <div class="alert alert-warning mb-3">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Important:</strong> You must have paid your membership fee before signing up. We will verify your payment in our records.
                            </div>
                            <form onsubmit="return handleSignup(event)">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label"><i class="fas fa-user me-2"></i>First Name *</label>
                                        <input type="text" class="form-control" id="signupFirstName" placeholder="Enter first name" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label"><i class="fas fa-user me-2"></i>Last Name *</label>
                                        <input type="text" class="form-control" id="signupLastName" placeholder="Enter last name" required>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label"><i class="fas fa-envelope me-2"></i>Email Address *</label>
                                        <input type="email" class="form-control" id="signupEmail" placeholder="Enter email address" required>
                                        <small class="text-muted">Use the same email used for payment</small>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label"><i class="fas fa-phone me-2"></i>Phone Number *</label>
                                        <input type="tel" class="form-control" id="signupPhone" placeholder="(904) 555-1234" required>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-lg w-100 mt-4" style="background: var(--gradient-green); color: #fff; border: none;">
                                    <i class="fas fa-search me-2"></i>Verify Payment & Get Registration Code
                                </button>
                            </form>
                            <div class="text-center mt-3">
                                <small class="text-muted">Already have an account? <a href="#" onclick="showPortalTab('login'); return false;">Login here</a></small>
                            </div>
                        </div>
                        
                        <!-- REGISTRATION CODE FORM (Step 2) -->
                        <div id="codeForm" class="portal-form" style="display: none;">
                            <div class="alert alert-success mb-3">
                                <i class="fas fa-envelope-open me-2"></i>
                                <strong>Check Your Email!</strong> Enter the registration code sent to your email address.
                            </div>
                            <form onsubmit="return handleCodeVerification(event)">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-key me-2"></i>Registration Code</label>
                                    <input type="text" class="form-control form-control-lg text-center" id="registrationCode" 
                                           placeholder="BANF-XXXX-XXXX" style="letter-spacing: 2px; font-family: monospace; font-size: 1.25rem;" required>
                                    <small class="text-muted">Code is valid for 7 days</small>
                                </div>
                                <button type="submit" class="btn btn-lg w-100" style="background: var(--gradient-primary); color: #fff; border: none;">
                                    <i class="fas fa-check-circle me-2"></i>Verify Code
                                </button>
                            </form>
                            <div class="text-center mt-3">
                                <small class="text-muted">Didn't receive code? <a href="#" onclick="resendRegistrationCode(); return false;">Resend Code</a></small>
                            </div>
                        </div>
                        
                        <!-- SETUP ACCOUNT FORM (Step 3: Username & Password) -->
                        <div id="setupForm" class="portal-form" style="display: none;">
                            <div class="alert alert-info mb-3">
                                <i class="fas fa-user-check me-2"></i>
                                <strong>Final Step!</strong> Set up your username and password to complete registration.
                            </div>
                            <form onsubmit="return handleAccountSetup(event)">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-at me-2"></i>Username</label>
                                    <input type="text" class="form-control" id="setupUsername" placeholder="Choose a username">
                                    <small class="text-muted">Leave blank to use your email as username</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-lock me-2"></i>Password *</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="setupPassword" placeholder="Create a strong password" required>
                                        <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('setupPassword', this)">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <small class="text-muted">Min 8 chars, uppercase, lowercase, and number required</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-lock me-2"></i>Confirm Password *</label>
                                    <input type="password" class="form-control" id="setupConfirmPassword" placeholder="Confirm your password" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-home me-2"></i>Address (Optional)</label>
                                    <input type="text" class="form-control" id="setupAddress" placeholder="Street address">
                                </div>
                                <div class="row g-2 mb-3">
                                    <div class="col-6">
                                        <input type="text" class="form-control" id="setupCity" placeholder="City" value="Jacksonville">
                                    </div>
                                    <div class="col-3">
                                        <input type="text" class="form-control" id="setupState" placeholder="State" value="FL">
                                    </div>
                                    <div class="col-3">
                                        <input type="text" class="form-control" id="setupZip" placeholder="ZIP">
                                    </div>
                                </div>
                                <input type="hidden" id="setupRegistrationId">
                                <input type="hidden" id="setupRegistrationCode">
                                <button type="submit" class="btn btn-lg w-100" style="background: var(--gradient-primary); color: #fff; border: none;">
                                    <i class="fas fa-check-circle me-2"></i>Complete Registration
                                </button>
                            </form>
                        </div>
                        
                        <!-- FORGOT PASSWORD FORM -->
                        <div id="forgotForm" class="portal-form" style="display: none;">
                            <form onsubmit="return handleForgotPassword(event)">
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-envelope me-2"></i>Email Address</label>
                                    <input type="email" class="form-control form-control-lg" id="forgotEmail" placeholder="Enter your registered email" required>
                                </div>
                                <button type="submit" class="btn btn-lg w-100 mb-2" style="background: var(--gradient-primary); color: #fff; border: none;">
                                    <i class="fas fa-key me-2"></i>Reset Password
                                </button>
                                <button type="button" onclick="handleForgotUsername(event)" class="btn btn-outline-warning btn-lg w-100">
                                    <i class="fas fa-user me-2"></i>Forgot Username?
                                </button>
                            </form>
                            <div class="text-center mt-3">
                                <small class="text-muted"><a href="#" onclick="showPortalTab('login'); return false;"><i class="fas fa-arrow-left me-1"></i>Back to Login</a></small>
                            </div>
                            <div class="mt-4 p-3 rounded" style="background: rgba(255,193,7,0.1); border: 1px dashed var(--gold);">
                                <small class="text-muted">
                                    <strong><i class="fas fa-lightbulb me-1"></i>Demo Mode:</strong><br>
                                    Test with email: <code>member@test.com</code><br>
                                    Or: <code>admin@test.com</code>
                                </small>
                            </div>
                        </div>
                        
                        <!-- PROFILE MANAGEMENT (shown after login) -->
                        <div id="profileSection" class="portal-form" style="display: none;">
                            <div class="text-center mb-4">
                                <div class="mx-auto mb-3" style="width: 80px; height: 80px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center;">
                                    <span id="profileInitials" class="text-white" style="font-size: 2rem; font-weight: bold;">--</span>
                                </div>
                                <h5 id="profileName" class="mb-1">Member Name</h5>
                                <span id="profileRole" class="badge" style="background: var(--gold); color: #1a1a2e;">Member</span>
                            </div>
                            
                            <div class="list-group mb-4">
                                <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" onclick="showProfileEdit(); return false;">
                                    <span><i class="fas fa-user-edit me-2"></i>Edit Profile</span>
                                    <i class="fas fa-chevron-right text-muted"></i>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-action="profile-payments">
                                    <span><i class="fas fa-credit-card me-2"></i>Payment History</span>
                                    <i class="fas fa-chevron-right text-muted"></i>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-action="profile-events">
                                    <span><i class="fas fa-calendar-check me-2"></i>My Events</span>
                                    <i class="fas fa-chevron-right text-muted"></i>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-action="profile-family">
                                    <span><i class="fas fa-users me-2"></i>Family Members</span>
                                    <i class="fas fa-chevron-right text-muted"></i>
                                </a>
                            </div>
                            
                            <button class="btn btn-outline-danger w-100" onclick="handleLogout()">
                                <i class="fas fa-sign-out-alt me-2"></i>Logout
                            </button>
                        </div>
                        
                        <!-- Status Messages -->
                        <div id="portalStatusMessage" class="mt-3" style="display: none;"></div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== DIAGNOSTICS MODAL ========== -->
    <div class="modal fade" id="diagnosticsModal" tabindex="-1" aria-labelledby="diagnosticsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="border-radius: 16px; overflow: hidden;">
                <div class="modal-header" style="background: linear-gradient(135deg, #006A4E, #00856F); color: white;">
                    <h5 class="modal-title" id="diagnosticsModalLabel"><i class="fas fa-stethoscope me-2"></i>System Check</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="diagnosticsResults"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== EVENT DETAILS MODAL ========== -->
    <div class="modal fade" id="eventDetailsModal" tabindex="-1" aria-labelledby="eventDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="border-radius: 16px; overflow: hidden;">
                <div class="modal-header" style="background: var(--gradient-primary); color: white;">
                    <h5 class="modal-title" id="eventDetailsModalLabel"><i class="fas fa-calendar-alt me-2"></i>Event Details</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="eventDetailsBody">
                    <div class="text-muted">Loading event details...</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn" style="background: var(--gradient-green); color: #fff;" onclick="openMemberLoginModal()">
                        <i class="fas fa-user-check me-1"></i> RSVP (Members)
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== SURVEY MODAL ========== -->
    <div class="modal fade" id="surveyModal" tabindex="-1" aria-labelledby="surveyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="border-radius: 16px; overflow: hidden;">
                <div class="modal-header" style="background: var(--gradient-green); color: white;">
                    <h5 class="modal-title" id="surveyModalLabel"><i class="fas fa-poll me-2"></i>Active Surveys</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="surveyModalBody">
                    <div class="text-muted">Loading surveys...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== COMPLAINT FORM MODAL ========== -->
    <div class="modal fade" id="complaintModal" tabindex="-1" aria-labelledby="complaintModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="border-radius: 16px; overflow: hidden;">
                <div class="modal-header" style="background: linear-gradient(135deg, #607D8B, #455A64); color: white;">
                    <h5 class="modal-title" id="complaintModalLabel"><i class="fas fa-shield-alt me-2"></i>Anonymous Complaint</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="complaintForm" onsubmit="return submitComplaint(event)">
                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <select class="form-control" id="complaintCategory" required>
                                <option value="">Select category...</option>
                                <option value="membership">Membership</option>
                                <option value="event">Event</option>
                                <option value="payment">Payment</option>
                                <option value="behavior">Conduct</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Subject</label>
                            <input type="text" class="form-control" id="complaintSubject" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Details</label>
                            <textarea class="form-control" id="complaintDetails" rows="5" required></textarea>
                        </div>
                        <div id="complaintStatus" class="mb-3"></div>
                        <button type="submit" class="btn w-100" style="background: linear-gradient(135deg, #607D8B, #455A64); color: #fff;">
                            <i class="fas fa-paper-plane me-1"></i> Submit Complaint
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Additional CSS for Member Portal Modal -->
    <style>
        /* Member Portal Modal Styles */
        #memberPortalModal .nav-pills .nav-link {
            color: var(--banf-deep-red);
            background: rgba(139,0,0,0.1);
            transition: all 0.3s ease;
        }
        #memberPortalModal .nav-pills .nav-link.active {
            background: var(--gradient-primary);
            color: #fff;
        }
        #memberPortalModal .nav-pills .nav-link:hover:not(.active) {
            background: rgba(139,0,0,0.2);
        }
        #memberPortalModal .form-control:focus {
            border-color: var(--banf-orange);
            box-shadow: 0 0 0 0.2rem rgba(255,107,53,0.25);
        }
        .portal-form {
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Role badges */
        .role-badge-super_admin { background: linear-gradient(135deg, #1a1a1a, #333) !important; }
        .role-badge-president { background: linear-gradient(135deg, #8B0000, #a50000) !important; }
        .role-badge-treasurer { background: linear-gradient(135deg, #00A86B, #008a64) !important; }
        .role-badge-vp { background: linear-gradient(135deg, #FF6B35, #ff8b5c) !important; }
        .role-badge-secretary { background: linear-gradient(135deg, #5c6bc0, #7986cb) !important; }
        .role-badge-ec { background: linear-gradient(135deg, #26a69a, #4db6ac) !important; }
        .role-badge-moderator { background: linear-gradient(135deg, #7e57c2, #9575cd) !important; }
        .role-badge-member { background: linear-gradient(135deg, #D4AF37, #e5c158) !important; color: #1a1a2e !important; }
        .role-badge-cultural_secretary { background: linear-gradient(135deg, #9C27B0, #E91E63) !important; }
        .role-badge-food_coord { background: linear-gradient(135deg, #FF5722, #FF9800) !important; }
        .role-badge-event_coord { background: linear-gradient(135deg, #2196F3, #03A9F4) !important; }
        .role-badge-puja_coord { background: linear-gradient(135deg, #673AB7, #9C27B0) !important; }
        .role-badge-joint_secretary { background: linear-gradient(135deg, #8B0000, #DC143C) !important; }
        .role-badge-assistant_secretary { background: linear-gradient(135deg, #546E7A, #90A4AE) !important; }
        .role-badge-assistant_treasurer { background: linear-gradient(135deg, #00A86B, #00C389) !important; }
        .role-badge-webmaster { background: linear-gradient(135deg, #1a237e, #3949ab) !important; }
        .role-badge-editor { background: linear-gradient(135deg, #5d4037, #8d6e63) !important; }
        .role-badge-communications { background: linear-gradient(135deg, #006A4E, #00A86B) !important; }
        .role-badge-community { background: linear-gradient(135deg, #2E7D32, #66BB6A) !important; }
        
        /* ========== FULL-SCREEN MEMBER PORTAL STYLES ========== */
        .member-portal-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f5f7fa;
            z-index: 9999;
            overflow: hidden;
        }
        
        .portal-header-bar {
            background: var(--gradient-green);
            color: #fff;
            padding: 0.75rem 1.5rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .portal-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .portal-logo-group {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .portal-logo-icon {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }
        
        .portal-logo-text h1 {
            font-size: 1.25rem;
            margin: 0;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
        }
        
        .portal-logo-text span {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .portal-user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .portal-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .portal-user-name {
            font-weight: 500;
        }
        
        .portal-btn-logout, .portal-btn-close {
            background: rgba(255,255,255,0.2);
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .portal-btn-logout:hover, .portal-btn-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .portal-btn-close {
            padding: 0.5rem 0.75rem;
            margin-left: 0.5rem;
        }
        
        .portal-main-container {
            display: flex;
            height: calc(100vh - 70px);
            overflow: hidden;
        }
        
        /* Sidebar */
        .portal-sidebar {
            width: 260px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            padding: 1.25rem 0;
            overflow-y: auto;
            flex-shrink: 0;
        }
        
        .sidebar-section {
            margin-bottom: 1.25rem;
            padding: 0 0.75rem;
        }
        
        .sidebar-section h6 {
            font-size: 0.7rem;
            text-transform: uppercase;
            color: #888;
            font-weight: 600;
            margin-bottom: 0.5rem;
            padding-left: 0.75rem;
            letter-spacing: 0.5px;
        }
        
        .portal-nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            color: var(--banf-charcoal, #2D2D2D);
            text-decoration: none;
            margin-bottom: 0.2rem;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .portal-nav-item:hover {
            background: rgba(0,106,78,0.08);
            color: var(--banf-green);
        }
        
        .portal-nav-item.active {
            background: var(--gradient-green);
            color: #fff;
        }
        
        .portal-nav-item i {
            width: 22px;
            text-align: center;
            font-size: 1rem;
        }
        
        .portal-badge {
            margin-left: auto;
            background: var(--banf-orange);
            color: #fff;
            font-size: 0.65rem;
            padding: 0.15rem 0.4rem;
            border-radius: 10px;
            font-weight: 600;
        }
        
        /* Content Area */
        .portal-content-area {
            flex: 1;
            padding: 1.5rem 2rem;
            overflow-y: auto;
        }
        
        .portal-page-header {
            margin-bottom: 1.5rem;
        }
        
        .portal-page-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--banf-charcoal, #2D2D2D);
            margin-bottom: 0.25rem;
            font-family: 'Playfair Display', serif;
        }
        
        .portal-page-header p {
            color: #666;
            margin: 0;
        }
        
        .portal-section {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        .portal-section.active {
            display: block;
        }
        
        /* Stats Grid */
        .portal-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .portal-stat-card {
            background: #fff;
            border-radius: 14px;
            padding: 1.25rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s;
        }
        
        .portal-stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .stat-icon {
            width: 55px;
            height: 55px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: #fff;
        }
        
        .stat-icon.green { background: var(--gradient-green); }
        .stat-icon.orange { background: var(--gradient-primary); }
        .stat-icon.gold { background: linear-gradient(135deg, #D4AF37, #FFD700); }
        .stat-icon.purple { background: linear-gradient(135deg, #673AB7, #9C27B0); }
        
        .stat-info h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            color: var(--banf-charcoal, #2D2D2D);
        }
        
        .stat-info p {
            font-size: 0.8rem;
            color: #888;
            margin: 0;
        }
        
        /* Features Grid */
        .portal-features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.25rem;
        }
        
        .portal-feature-card {
            background: #fff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .portal-feature-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            border-color: var(--banf-green);
        }
        
        .feature-icon-box {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            background: var(--gradient-green);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 1rem;
        }
        
        .portal-feature-card h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--banf-charcoal, #2D2D2D);
        }
        
        .portal-feature-card p {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .portal-feature-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.65rem 1.25rem;
            background: var(--gradient-green);
            color: #fff;
            border: none;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .portal-feature-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 6px 20px rgba(0,106,78,0.3);
            color: #fff;
        }
        
        .portal-feature-btn.secondary {
            background: #f0f0f0;
            color: var(--banf-charcoal, #2D2D2D);
        }
        
        .portal-feature-btn.secondary:hover {
            background: #e0e0e0;
            color: var(--banf-charcoal, #2D2D2D);
        }
        
        /* Form Card */
        .portal-form-card {
            background: #fff;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            margin-bottom: 1.5rem;
        }
        
        /* Data Table */
        .portal-data-table {
            background: #fff;
            border-radius: 14px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .portal-data-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .portal-data-table th {
            background: var(--banf-green);
            color: #fff;
            padding: 0.85rem 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .portal-data-table td {
            padding: 0.85rem 1rem;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        .portal-data-table tr:hover td {
            background: rgba(0,106,78,0.03);
        }
        
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.65rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .status-badge.active { background: #d4edda; color: #155724; }
        .status-badge.pending { background: #fff3cd; color: #856404; }
        .status-badge.expired { background: #f8d7da; color: #721c24; }

        /* ========== FULL-SCREEN ADMIN PORTAL STYLES ========== */
        .admin-portal-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f5f7fa;
            z-index: 10000;
            overflow: hidden;
        }

        .admin-portal-fullscreen .admin-header {
            background: linear-gradient(135deg, #8B0000, #DC143C);
            color: #fff;
            padding: 0.75rem 1.5rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(139,0,0,0.3);
        }

        .admin-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
        }

        .admin-logo-group {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .admin-logo-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .admin-logo-text h1 {
            font-size: 1.25rem;
            margin: 0;
            font-weight: 700;
        }

        .admin-logo-text span {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .admin-user-menu {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .admin-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-user-name {
            font-weight: 600;
        }

        .admin-role-badge {
            background: rgba(255,255,255,0.2);
            padding: 0.3rem 0.9rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .admin-btn {
            background: rgba(255,255,255,0.2);
            color: #fff;
            border: none;
            padding: 0.45rem 0.9rem;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .admin-btn-close {
            padding: 0.45rem 0.7rem;
        }

        .admin-portal-container {
            display: flex;
            height: calc(100vh - 70px);
            overflow: hidden;
        }

        .admin-sidebar {
            width: 270px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            padding: 1.25rem 0;
            overflow-y: auto;
            flex-shrink: 0;
        }

        .admin-sidebar-section {
            margin-bottom: 1.25rem;
            padding: 0 0.75rem;
        }

        .admin-sidebar-section h6 {
            font-size: 0.7rem;
            text-transform: uppercase;
            color: #888;
            font-weight: 600;
            margin-bottom: 0.5rem;
            padding-left: 0.75rem;
            letter-spacing: 0.5px;
        }

        .admin-nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            color: #2D2D2D;
            text-decoration: none;
            margin-bottom: 0.2rem;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .admin-nav-item:hover {
            background: rgba(139,0,0,0.08);
            color: #8B0000;
        }

        .admin-nav-item.active {
            background: linear-gradient(135deg, #8B0000, #DC143C);
            color: #fff;
        }

        .admin-nav-item i {
            width: 22px;
            text-align: center;
            font-size: 1rem;
        }

        .admin-badge {
            margin-left: auto;
            background: #DC143C;
            color: #fff;
            font-size: 0.65rem;
            padding: 0.15rem 0.4rem;
            border-radius: 10px;
            font-weight: 600;
        }

        .admin-badge.warning { background: #FFA000; }

        .admin-main-content {
            flex: 1;
            padding: 1.5rem 2rem;
            overflow-y: auto;
        }

        .admin-page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .admin-page-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }

        .admin-page-header p {
            margin: 0;
            color: #666;
        }

        .admin-section { display: none; }
        .admin-section.active { display: block; animation: fadeIn 0.4s ease; }

        .admin-primary {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.65rem 1.25rem;
            background: linear-gradient(135deg, #8B0000, #DC143C);
            color: #fff;
            border: none;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
        }

        .admin-secondary {
            padding: 0.5rem 0.9rem;
            border-radius: 8px;
            font-size: 0.8rem;
            border: 1px solid #ddd;
            background: #fff;
            cursor: pointer;
        }

        .admin-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .admin-stat-card {
            background: #fff;
            border-radius: 16px;
            padding: 1.25rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            gap: 1rem;
            align-items: center;
            border-left: 4px solid transparent;
        }

        .admin-stat-card.red { border-color: #DC143C; }
        .admin-stat-card.green { border-color: #4CAF50; }
        .admin-stat-card.orange { border-color: #FF6B35; }
        .admin-stat-card.blue { border-color: #2196F3; }

        .admin-stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #fff;
        }

        .admin-stat-icon.red { background: linear-gradient(135deg, #8B0000, #DC143C); }
        .admin-stat-icon.green { background: linear-gradient(135deg, #4CAF50, #8BC34A); }
        .admin-stat-icon.orange { background: linear-gradient(135deg, #FF6B35, #FF9800); }
        .admin-stat-icon.blue { background: linear-gradient(135deg, #2196F3, #03A9F4); }

        .admin-stat-info h3 { margin: 0; font-size: 1.4rem; font-weight: 700; }
        .admin-stat-info p { margin: 0; color: #777; font-size: 0.8rem; }

        .admin-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1rem;
        }

        .admin-card {
            background: #fff;
            border-radius: 16px;
            padding: 1.25rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .admin-card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .admin-card-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            background: linear-gradient(135deg, #8B0000, #DC143C);
        }

        .admin-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .admin-table {
            background: #fff;
            border-radius: 14px;
            overflow: hidden;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .admin-table table {
            min-width: 600px;
        }

        .admin-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th {
            background: #8B0000;
            color: #fff;
            padding: 0.85rem 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .admin-table td {
            padding: 0.85rem 1rem;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }

        /* Admin responsive */
        @media (max-width: 992px) {
            .admin-portal-container { flex-direction: column; }
            .admin-sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
                display: flex;
                overflow-x: auto;
                padding: 0.75rem;
                gap: 0.5rem;
            }
            .admin-sidebar-section { display: flex; gap: 0.25rem; margin-bottom: 0; padding: 0; }
            .admin-sidebar-section h6 { display: none; }
            .admin-nav-item { white-space: nowrap; padding: 0.5rem 0.75rem; font-size: 0.8rem; }
            .admin-nav-item span { display: none; }
            .admin-main-content { padding: 1rem; height: calc(100vh - 180px); }
        }
        
        /* Mobile Responsive */
        @media (max-width: 992px) {
            .portal-main-container {
                flex-direction: column;
            }
            
            .portal-sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
                display: flex;
                overflow-x: auto;
                padding: 0.75rem;
                gap: 0.5rem;
            }
            
            .sidebar-section {
                display: flex;
                gap: 0.25rem;
                margin-bottom: 0;
                padding: 0;
            }
            
            .sidebar-section h6 {
                display: none;
            }
            
            .portal-nav-item {
                white-space: nowrap;
                padding: 0.5rem 0.75rem;
                font-size: 0.8rem;
            }
            
            .portal-nav-item span {
                display: none;
            }
            
            .portal-content-area {
                padding: 1rem;
                height: calc(100vh - 180px);
            }
            
            .portal-features-grid {
                grid-template-columns: 1fr;
            }
            
            .portal-user-name {
                display: none;
            }
        }
        
        @media (max-width: 576px) {
            .portal-header-bar {
                padding: 0.5rem 1rem;
            }
            
            .portal-logo-text h1 {
                font-size: 1rem;
            }
            
            .portal-logo-text span {
                display: none;
            }
            
            .portal-page-header h2 {
                font-size: 1.25rem;
            }

            /* Portal sidebar — slide-in drawer on small screens */
            .portal-main-container { flex-direction: column; position: relative; }
            .portal-sidebar {
                position: fixed;
                left: -270px;
                top: 70px;
                width: 260px;
                height: calc(100vh - 70px);
                z-index: 1050;
                transition: left 0.3s ease;
                flex-direction: column;
                overflow-y: auto;
                overflow-x: hidden;
                border-right: 1px solid #e0e0e0;
                box-shadow: 4px 0 15px rgba(0,0,0,0.1);
            }
            .portal-sidebar.open { left: 0; }
            .sidebar-section { flex-direction: column; }
            .sidebar-section h6 { display: block; }
            .portal-nav-item span { display: inline; }
            .portal-content-area { margin-left: 0; padding: 1rem; height: calc(100vh - 70px); }
            .portal-mobile-toggle { display: flex !important; }
            .portal-sidebar-backdrop {
                display: none;
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.4);
                z-index: 1049;
            }
            .portal-sidebar-backdrop.show { display: block; }

            /* Admin sidebar — slide-in drawer on small screens */
            .admin-portal-container { flex-direction: column; position: relative; }
            .admin-sidebar {
                position: fixed;
                left: -280px;
                top: 70px;
                width: 270px;
                height: calc(100vh - 70px);
                z-index: 1050;
                transition: left 0.3s ease;
                flex-direction: column;
                overflow-y: auto;
                overflow-x: hidden;
                border-right: 1px solid #e0e0e0;
                box-shadow: 4px 0 15px rgba(0,0,0,0.1);
            }
            .admin-sidebar.open { left: 0; }
            .admin-sidebar-section { flex-direction: column; }
            .admin-sidebar-section h6 { display: block; }
            .admin-nav-item span { display: inline; }
            .admin-main-content { margin-left: 0; padding: 1rem; height: calc(100vh - 70px); }
            .admin-mobile-toggle { display: flex !important; }
            .admin-sidebar-backdrop {
                display: none;
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.4);
                z-index: 1049;
            }
            .admin-sidebar-backdrop.show { display: block; }

            /* Admin user menu — compact on mobile */
            .admin-user-name { display: none; }
            .admin-role-badge { font-size: 0.6rem; padding: 0.2rem 0.4rem; }
            .admin-btn { padding: 0.35rem 0.5rem; font-size: 0.75rem; }

            /* Modals — fullscreen on small screens */
            .modal-dialog { margin: 0; max-width: 100%; height: 100%; }
            .modal-content { border-radius: 0; height: 100%; }
        }

        /* ===== iPhone SE / very small phones — portal & admin (375px) ===== */
        @media (max-width: 375px) {
            /* Portal sidebar drawer — narrower for tiny screens */
            .portal-sidebar {
                left: -240px;
                width: 230px;
            }
            .portal-sidebar.open { left: 0; }
            .portal-nav-item { font-size: 0.8rem; padding: 0.5rem 0.75rem; }
            .portal-content-area { padding: 0.5rem !important; }
            .portal-page-header h2 { font-size: 1.1rem; }
            .portal-page-header p { font-size: 0.8rem; }
            .portal-features-grid { gap: 0.5rem; }
            .portal-feature-card { padding: 0.75rem; }
            .portal-feature-card h5 { font-size: 0.9rem; }
            .portal-feature-card p { font-size: 0.75rem; }
            .portal-header-bar { padding: 0.4rem 0.75rem; }
            .portal-logo-text h1 { font-size: 0.9rem; }

            /* Admin sidebar drawer — narrower for tiny screens */
            .admin-sidebar {
                left: -240px;
                width: 230px;
            }
            .admin-sidebar.open { left: 0; }
            .admin-nav-item { font-size: 0.8rem; padding: 0.5rem 0.75rem; }
            .admin-main-content { padding: 0.5rem !important; }
            .admin-section-header h3 { font-size: 1rem; }
            .admin-section-header p { font-size: 0.75rem; }
            .admin-btn { padding: 0.3rem 0.4rem; font-size: 0.7rem; }
            .admin-role-badge { font-size: 0.55rem; }
            .admin-stat-card h4 { font-size: 1.1rem; }
            .admin-stat-card p { font-size: 0.7rem; }
            .admin-stat-card { padding: 0.75rem; }

            /* Login/Registration forms — compact */
            .portal-login-card { padding: 1rem; }
            .portal-login-card h3 { font-size: 1.1rem; }
            .portal-login-card .form-control { font-size: 16px; padding: 0.5rem; }
            .portal-login-card .btn { width: 100%; font-size: 0.85rem; }

            /* Tables inside portals */
            .admin-main-content table th,
            .admin-main-content table td,
            .portal-content-area table th,
            .portal-content-area table td { font-size: 0.7rem; padding: 0.3rem; }

            /* Modals — tighter on tiny screens */
            .modal-header { padding: 0.5rem 0.75rem; }
            .modal-header h5 { font-size: 0.95rem; }
            .modal-body { padding: 0.5rem 0.75rem; font-size: 0.8rem; }
            .modal-footer { padding: 0.5rem 0.75rem; }
            .modal-footer .btn { font-size: 0.8rem; }
        }
    </style>
    
    <!-- Member Portal JavaScript -->
    <script>
        // Member Portal State
        const MemberPortal = {
            currentTab: 'login',
            isLoggedIn: false,
            member: null,
            registrationId: null,
            apiBase: BANF_API.siteUrl
        };

        // Admin Portal State
        const AdminPortal = {
            isLoggedIn: false,
            admin: null,
            currentSection: 'dashboard'
        };

        // Wix Collection Schema (expected fields)
        const WIX_MEMBER_SCHEMA = {
            required: ['id', 'firstName', 'lastName', 'email', 'role'],
            optional: ['phone', 'membershipType', 'memberSince', 'expiresOn', 'address', 'roles', 'adminRole', 'ecRole', 'isAdmin']
        };

        // Admin role allowlist (normalized values)
        const ADMIN_ROLE_ALLOWLIST = new Set([
            'super_admin', 'admin', 'ec_member', 'ec', 'president', 'vice_president', 'vp',
            'treasurer', 'assistant_treasurer', 'secretary', 'assistant_secretary', 'joint_secretary',
            'cultural_secretary', 'food_coord', 'event_coord', 'puja_coord', 'webmaster',
            'editor', 'communications', 'community', 'moderator'
        ]);

        const ADMIN_ROLE_LABELS = {
            super_admin: 'Super Admin',
            admin: 'Admin',
            ec_member: 'EC Member',
            ec: 'EC Member',
            president: 'President',
            vice_president: 'Vice President',
            vp: 'Vice President',
            treasurer: 'Treasurer',
            assistant_treasurer: 'Asst. Treasurer',
            secretary: 'Secretary',
            assistant_secretary: 'Asst. Secretary',
            joint_secretary: 'Joint Secretary',
            cultural_secretary: 'Cultural Secretary',
            food_coord: 'Food Coordinator',
            event_coord: 'Event Coordinator',
            puja_coord: 'Puja Coordinator',
            webmaster: 'Webmaster',
            editor: 'Editor',
            communications: 'Communications',
            community: 'Community Lead',
            moderator: 'Moderator'
        };

        function normalizeRoleValue(role) {
            return (role || '').toString().trim().toLowerCase().replace(/[^a-z0-9]+/g, '_');
        }

        function isAdminRoleValue(roleValue) {
            return ADMIN_ROLE_ALLOWLIST.has(normalizeRoleValue(roleValue));
        }

        // ===== SECTION-TO-PERMISSION MAPPING (Feature 3: Role-Based Enforcement) =====
        // Maps each admin sidebar section to the ecPermission string required to access it.
        // null = always visible (e.g. dashboard).  President/super_admin bypass all checks.
        const SECTION_PERMISSIONS = {
            dashboard:      null,           // always visible
            members:        'members',
            dataImport:     'members',      // data-import is a sub-feature of member mgmt
            dbExplorer:     'members',      // DB Explorer is a sub-feature of member mgmt
            payments:       'payments',
            gmail:          'communications',
            events:         'events',
            evite:          'evite',
            rsvps:          'rsvps',
            complaints:     'complaints',
            surveys:        'surveys',
            announcements:  'announcements',
            radio:          'radio',
            magazine:       'magazine',
            budget:         'budget',
            vendors:        'vendors',
            volunteers:     'volunteers',
            meetings:       'meetings',
            siteConfig:     'site_config',
            careers:        'careers'
        };

        // Roles that bypass all permission checks (full access)
        const FULL_ACCESS_ROLES = new Set([
            'super_admin', 'admin', 'president', 'vice_president', 'vp'
        ]);

        function getRoleBadgeClass(roleValue) {
            const normalized = normalizeRoleValue(roleValue) || 'member';
            if (normalized === 'vice_president') return 'role-badge-vp';
            if (normalized === 'ec_member') return 'role-badge-ec';
            return `role-badge-${normalized}`;
        }

        function extractRolesFromMember(member) {
            const roles = [];
            if (!member) return roles;
            const candidates = [member.role, member.memberRole, member.ecRole, member.adminRole, member.roleTitle];
            candidates.forEach(role => {
                if (role) roles.push(normalizeRoleValue(role));
            });
            if (Array.isArray(member.roles)) {
                member.roles.forEach(role => roles.push(normalizeRoleValue(role)));
            }
            return Array.from(new Set(roles.filter(Boolean)));
        }

        function normalizeMemberRecord(raw = {}) {
            const roles = extractRolesFromMember(raw);
            const primaryRole = roles[0] || normalizeRoleValue(raw.role) || (raw.isAdmin ? 'ec_member' : 'member');
            const isAdmin = raw.isAdmin === true || roles.some(isAdminRoleValue) || isAdminRoleValue(primaryRole);
            const adminRoleLabel = raw.adminRole || raw.ecRole || raw.roleTitle || (isAdmin ? (ADMIN_ROLE_LABELS[primaryRole] || 'EC Member') : null);

            const normalizedAddress = raw.address || {
                street: raw.street || raw.addressLine1 || raw.address_line1 || '',
                city: raw.city || raw.addressCity || raw.address_city || 'Jacksonville',
                state: raw.state || raw.addressState || raw.address_state || 'FL',
                zip: raw.zip || raw.addressZip || raw.address_zip || ''
            };

            const normalizedMember = {
                id: raw.id || raw._id || raw.memberId || raw.member_id || '',
                firstName: raw.firstName || raw.first_name || raw.givenName || raw.given_name || '',
                lastName: raw.lastName || raw.last_name || raw.familyName || raw.family_name || '',
                fullName: raw.fullName || raw.full_name || raw.name || '',
                email: raw.email || raw.memberEmail || raw.member_email || raw.loginEmail || '',
                phone: raw.phone || raw.mobile || raw.phoneNumber || raw.phone_number || '',
                membershipType: raw.membershipType || raw.membership_type || raw.memberType || raw.member_type || '',
                memberSince: raw.memberSince || raw.member_since || raw.joinedOn || raw.joined_on || '',
                expiresOn: raw.expiresOn || raw.expires_on || raw.expirationDate || raw.expiration_date || '',
                address: normalizedAddress
            };

            return {
                ...raw,
                ...normalizedMember,
                role: raw.role || primaryRole || 'member',
                roleNormalized: primaryRole || 'member',
                roles: roles.length ? roles : [primaryRole || 'member'],
                isAdmin,
                adminRoleLabel
            };
        }

        function validateMemberSchema(member) {
            const missing = [];
            WIX_MEMBER_SCHEMA.required.forEach(key => {
                if (!member || member[key] === undefined || member[key] === null || member[key] === '') {
                    missing.push(key);
                }
            });
            return {
                valid: missing.length === 0,
                missing
            };
        }

        function findAccountByCredentials(credential, password) {
            const normalizedCredential = (credential || '').trim().toLowerCase();
            const testAccount = DemoData.testAccounts[normalizedCredential];
            if (testAccount && testAccount.password === password) {
                return { member: normalizeMemberRecord(testAccount.member), source: 'demo' };
            }

            const dynamicAccount = Object.values(DemoData.pendingRegistrations).find(
                reg => reg.completed && (reg.username === normalizedCredential || reg.email.toLowerCase() === normalizedCredential) && reg.password === password
            );
            if (dynamicAccount) {
                return { member: normalizeMemberRecord(dynamicAccount.memberData), source: 'dynamic' };
            }

            return null;
        }

        /**
         * Open Member Portal Modal
         */
        function openMemberPortal(tab = 'login') {
            const modal = new bootstrap.Modal(document.getElementById('memberPortalModal'));
            showPortalTab(tab);
            modal.show();
        }

        /**
         * Show specific tab in portal
         */
        function showPortalTab(tab) {
            MemberPortal.currentTab = tab;
            
            // Hide all forms
            document.querySelectorAll('.portal-form').forEach(form => {
                form.style.display = 'none';
            });
            
            // Update tab buttons
            document.querySelectorAll('#memberPortalTabs .nav-link').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected form and activate tab
            switch(tab) {
                case 'login':
                    document.getElementById('loginForm').style.display = 'block';
                    document.getElementById('login-tab').classList.add('active');
                    break;
                case 'signup':
                    document.getElementById('signupForm').style.display = 'block';
                    document.getElementById('signup-tab').classList.add('active');
                    break;
                case 'code':
                    document.getElementById('codeForm').style.display = 'block';
                    document.getElementById('code-tab').classList.add('active');
                    break;
                case 'setup':
                    document.getElementById('setupForm').style.display = 'block';
                    break;
                case 'forgot':
                    document.getElementById('forgotForm').style.display = 'block';
                    break;
                case 'profile':
                    document.getElementById('profileSection').style.display = 'block';
                    break;
            }
            
            hideStatusMessage();
        }

        // ========== DEMO/TEST MODE DATA ==========
        // Global demo data object for testing without backend
        window.DemoData = {
            // Test accounts that work without backend
            testAccounts: {
                'member_test': {
                    password: 'test',
                    member: {
                        id: 'demo_001',
                        firstName: 'Test',
                        lastName: 'Member',
                        fullName: 'Test Member',
                        email: 'member@test.com',
                        phone: '(904) 555-1234',
                        role: 'member',
                        membershipType: 'Family',
                        memberSince: '2024-01-15',
                        expiresOn: '2026-12-31',
                        address: {
                            street: '123 Demo Street',
                            city: 'Jacksonville',
                            state: 'FL',
                            zip: '32256'
                        },
                        familyMembers: ['Spouse Demo', 'Child Demo (12)'],
                        paymentHistory: [
                            { date: '2024-01-15', amount: '$150', type: 'Family Membership', status: 'Paid' },
                            { date: '2024-10-01', amount: '$75', type: 'Durga Puja 2024', status: 'Paid' }
                        ]
                    }
                },
                'admin_test': {
                    password: 'admin',
                    member: {
                        id: 'demo_admin',
                        firstName: 'Admin',
                        lastName: 'User',
                        fullName: 'Admin User',
                        email: 'admin@test.com',
                        phone: '(904) 555-9999',
                        role: 'ec_member',
                        roles: ['member', 'ec_member', 'president'],
                        adminRole: 'President',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2020-01-01',
                        expiresOn: '2026-12-31'
                    }
                },
                // ===== EC ROLE-SPECIFIC ACCOUNTS =====
                'ec_events': {
                    password: 'events123',
                    member: {
                        id: 'ec_events_001',
                        firstName: 'Priya',
                        lastName: 'Sen',
                        fullName: 'Priya Sen',
                        email: 'events@banf.org',
                        phone: '(904) 555-2001',
                        role: 'event_coord',
                        roles: ['member', 'ec_member', 'event_coord'],
                        adminRole: 'Event Coordinator',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2023-01-15',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['events', 'rsvps', 'evite', 'volunteers']
                    }
                },
                'ec_sponsorship': {
                    password: 'sponsor123',
                    member: {
                        id: 'ec_sponsor_001',
                        firstName: 'Amit',
                        lastName: 'Roy',
                        fullName: 'Amit Roy',
                        email: 'sponsor@banf.org',
                        phone: '(904) 555-2002',
                        role: 'ec_member',
                        roles: ['member', 'ec_member'],
                        adminRole: 'Sponsorship Manager',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2022-06-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['vendors', 'budget']
                    }
                },
                'ec_members': {
                    password: 'members123',
                    member: {
                        id: 'ec_members_001',
                        firstName: 'Shreya',
                        lastName: 'Das',
                        fullName: 'Shreya Das',
                        email: 'members@banf.org',
                        phone: '(904) 555-2003',
                        role: 'secretary',
                        roles: ['member', 'ec_member', 'secretary'],
                        adminRole: 'Secretary',
                        isAdmin: true,
                        membershipType: 'Individual',
                        memberSince: '2021-01-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['members', 'meetings', 'directory']
                    }
                },
                'ec_vendors': {
                    password: 'vendor123',
                    member: {
                        id: 'ec_vendor_001',
                        firstName: 'Rina',
                        lastName: 'Mukherjee',
                        fullName: 'Rina Mukherjee',
                        email: 'vendors@banf.org',
                        phone: '(904) 555-2004',
                        role: 'food_coord',
                        roles: ['member', 'ec_member', 'food_coord'],
                        adminRole: 'Food/Vendor Coordinator',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2023-06-15',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['vendors', 'events']
                    }
                },
                'ec_accounts': {
                    password: 'accounts123',
                    member: {
                        id: 'ec_accounts_001',
                        firstName: 'Subir',
                        lastName: 'Ghosh',
                        fullName: 'Subir Ghosh',
                        email: 'accounts@banf.org',
                        phone: '(904) 555-2005',
                        role: 'treasurer',
                        roles: ['member', 'ec_member', 'treasurer'],
                        adminRole: 'Treasurer',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2020-01-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['payments', 'budget', 'vendors']
                    }
                },
                'ec_payments': {
                    password: 'payment123',
                    member: {
                        id: 'ec_payment_001',
                        firstName: 'Deepa',
                        lastName: 'Banerjee',
                        fullName: 'Deepa Banerjee',
                        email: 'payments@banf.org',
                        phone: '(904) 555-2006',
                        role: 'assistant_treasurer',
                        roles: ['member', 'ec_member', 'assistant_treasurer'],
                        adminRole: 'Asst. Treasurer',
                        isAdmin: true,
                        membershipType: 'Couple',
                        memberSince: '2022-01-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['payments']
                    }
                },
                'ec_comms': {
                    password: 'comms123',
                    member: {
                        id: 'ec_comms_001',
                        firstName: 'Tanmay',
                        lastName: 'Chatterjee',
                        fullName: 'Tanmay Chatterjee',
                        email: 'comms@banf.org',
                        phone: '(904) 555-2007',
                        role: 'communications',
                        roles: ['member', 'ec_member', 'communications'],
                        adminRole: 'Communications',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2023-03-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['announcements', 'surveys', 'complaints', 'magazine']
                    }
                },
                'ec_ads': {
                    password: 'ads123',
                    member: {
                        id: 'ec_ads_001',
                        firstName: 'Mousumi',
                        lastName: 'Basu',
                        fullName: 'Mousumi Basu',
                        email: 'ads@banf.org',
                        phone: '(904) 555-2008',
                        role: 'ec_member',
                        roles: ['member', 'ec_member'],
                        adminRole: 'Ad Manager',
                        isAdmin: true,
                        membershipType: 'Individual',
                        memberSince: '2024-01-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['vendors', 'announcements']
                    }
                },
                // ===== NEW EC ACCOUNTS (Feature 3: VP, Cultural Sec, Puja Coord) =====
                'ec_vp': {
                    password: 'vp123',
                    member: {
                        id: 'ec_vp_001',
                        firstName: 'Debashis',
                        lastName: 'Majumdar',
                        fullName: 'Debashis Majumdar',
                        email: 'vp@banf.org',
                        phone: '(904) 555-2009',
                        role: 'vice_president',
                        roles: ['member', 'ec_member', 'vice_president'],
                        adminRole: 'Vice President',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2021-01-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['events', 'members', 'meetings', 'budget']
                    }
                },
                'ec_cultural': {
                    password: 'cultural123',
                    member: {
                        id: 'ec_cultural_001',
                        firstName: 'Indrani',
                        lastName: 'Chakraborty',
                        fullName: 'Indrani Chakraborty',
                        email: 'cultural@banf.org',
                        phone: '(904) 555-2010',
                        role: 'cultural_secretary',
                        roles: ['member', 'ec_member', 'cultural_secretary'],
                        adminRole: 'Cultural Secretary',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2022-06-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['events', 'evite', 'magazine', 'announcements']
                    }
                },
                'ec_puja': {
                    password: 'puja123',
                    member: {
                        id: 'ec_puja_001',
                        firstName: 'Sanjib',
                        lastName: 'Bhattacharya',
                        fullName: 'Sanjib Bhattacharya',
                        email: 'puja@banf.org',
                        phone: '(904) 555-2011',
                        role: 'puja_coord',
                        roles: ['member', 'ec_member', 'puja_coord'],
                        adminRole: 'Puja Coordinator',
                        isAdmin: true,
                        membershipType: 'Family',
                        memberSince: '2023-01-01',
                        expiresOn: '2026-12-31',
                        ecPermissions: ['events', 'volunteers', 'budget']
                    }
                }
            },
            // ===== EVITE / INVITATION DATA =====
            eviteData: {
                invitations: [
                    {
                        id: 'EVT-2026-001',
                        eventName: 'Nabo Borsho 1433',
                        eventDate: '2026-04-25',
                        eventTime: '5:00 PM - 10:00 PM',
                        venue: 'Jacksonville Civic Center',
                        sentDate: '2026-03-15',
                        sentBy: 'ec_events',
                        totalSent: 156,
                        responses: [
                            { memberId: 'demo_001', name: 'Test Member', status: 'attending', adults: 2, kids: 1, dietary: 'Vegetarian', notes: 'Need high chair', respondedAt: '2026-03-16' },
                            { memberId: 'BANF-2024-001', name: 'Rajib Das', status: 'attending', adults: 2, kids: 2, dietary: 'None', notes: '', respondedAt: '2026-03-17' },
                            { memberId: 'BANF-2024-002', name: 'Anita Sharma', status: 'attending', adults: 1, kids: 0, dietary: 'Vegan', notes: 'Gluten-free needed', respondedAt: '2026-03-17' },
                            { memberId: 'BANF-2024-003', name: 'Suman Pal', status: 'not_attending', adults: 0, kids: 0, dietary: '', notes: 'Out of town', respondedAt: '2026-03-18' },
                            { memberId: 'BANF-2024-004', name: 'Ritu Dey', status: 'attending', adults: 3, kids: 1, dietary: 'Halal', notes: '', respondedAt: '2026-03-19' },
                            { memberId: 'BANF-2024-005', name: 'Kamal Bose', status: 'maybe', adults: 2, kids: 0, dietary: 'None', notes: 'Will confirm later', respondedAt: '2026-03-20' },
                            { memberId: 'BANF-2024-006', name: 'Priti Guha', status: 'attending', adults: 2, kids: 3, dietary: 'Vegetarian, Nut-free', notes: 'Peanut allergy', respondedAt: '2026-03-20' }
                        ]
                    },
                    {
                        id: 'EVT-2026-002',
                        eventName: 'Summer Camp 2026',
                        eventDate: '2026-06-15',
                        eventTime: '9:00 AM - 5:00 PM',
                        venue: 'Hanna Park',
                        sentDate: '2026-05-01',
                        sentBy: 'ec_events',
                        totalSent: 80,
                        responses: [
                            { memberId: 'demo_001', name: 'Test Member', status: 'attending', adults: 1, kids: 2, dietary: 'None', notes: 'Bringing board games', respondedAt: '2026-05-02' },
                            { memberId: 'BANF-2024-002', name: 'Anita Sharma', status: 'attending', adults: 1, kids: 0, dietary: 'Vegan', notes: '', respondedAt: '2026-05-03' }
                        ]
                    }
                ],
                templates: [
                    { id: 'TPL-001', name: 'Cultural Event', subject: '🪷 You\'re Invited to {eventName}!', body: 'Dear {memberName},\n\nYou are cordially invited to {eventName} on {eventDate}.\n\nVenue: {venue}\nTime: {eventTime}\n\nPlease RSVP by clicking the link below.\n\nজয় বাংলা!\nBANF Executive Committee' },
                    { id: 'TPL-002', name: 'Meeting', subject: '📋 BANF Meeting Invitation: {eventName}', body: 'Dear {memberName},\n\nPlease join us for {eventName} on {eventDate}.\n\nAgenda will be shared prior to the meeting.\n\nRegards,\nBANF EC' },
                    { id: 'TPL-003', name: 'Picnic/Outing', subject: '🌳 BANF {eventName} - Save the Date!', body: 'Dear {memberName},\n\nJoin us for a fun day out at {eventName}!\n\nDate: {eventDate}\nLocation: {venue}\nTime: {eventTime}\n\nPlease bring your family and friends!\n\nBANF Team' }
                ]
            },
            // ===== MEMBER DIRECTORY DATA =====
            memberDirectory: [
                { id: 'BANF-2024-001', firstName: 'Rajib', lastName: 'Das', email: 'rajib.das@email.com', phone: '(904) 555-1001', type: 'Family', status: 'Active', joinDate: '2024-01-15' },
                { id: 'BANF-2024-002', firstName: 'Anita', lastName: 'Sharma', email: 'anita.sharma@email.com', phone: '(904) 555-1002', type: 'Individual', status: 'Active', joinDate: '2024-02-20' },
                { id: 'BANF-2024-003', firstName: 'Suman', lastName: 'Pal', email: 'suman.pal@email.com', phone: '(904) 555-1003', type: 'Family', status: 'Active', joinDate: '2024-03-10' },
                { id: 'BANF-2024-004', firstName: 'Ritu', lastName: 'Dey', email: 'ritu.dey@email.com', phone: '(904) 555-1004', type: 'Family', status: 'Active', joinDate: '2024-04-05' },
                { id: 'BANF-2024-005', firstName: 'Kamal', lastName: 'Bose', email: 'kamal.bose@email.com', phone: '(904) 555-1005', type: 'Couple', status: 'Active', joinDate: '2024-05-12' },
                { id: 'BANF-2024-006', firstName: 'Priti', lastName: 'Guha', email: 'priti.guha@email.com', phone: '(904) 555-1006', type: 'Family', status: 'Active', joinDate: '2024-06-01' },
                { id: 'BANF-2024-007', firstName: 'Arjun', lastName: 'Mitra', email: 'arjun.mitra@email.com', phone: '(904) 555-1007', type: 'Student', status: 'Active', joinDate: '2024-07-20' },
                { id: 'BANF-2024-008', firstName: 'Laboni', lastName: 'Dutta', email: 'laboni.dutta@email.com', phone: '(904) 555-1008', type: 'Family', status: 'Expired', joinDate: '2023-01-01' }
            ],
            // Demo registration data
            pendingRegistrations: {},
            registrationCodeCounter: 100000
        };
        
        // Alias for compatibility
        const DemoData = window.DemoData;
        console.log('✅ DemoData initialized:', Object.keys(DemoData.testAccounts));

        /**
         * ========== FULL-SCREEN MEMBER PORTAL FUNCTIONS ==========
         */
        
        /**
         * Show the full-screen member portal
         */
        function showFullPortal(memberData) {
            const normalizedMember = normalizeMemberRecord(memberData);
            MemberPortal.member = normalizedMember;
            memberData = normalizedMember;
            console.log('🏠 Opening full member portal for:', memberData.firstName);
            
            const overlay = document.getElementById('memberPortalOverlay');
            if (!overlay) {
                console.error('❌ memberPortalOverlay not found');
                return;
            }
            
            // Set user info in header
            document.getElementById('portalUserName').textContent = memberData.firstName || 'Member';
            document.getElementById('dashboardMemberName').textContent = memberData.firstName || 'Member';
            
            // Populate profile form
            const profileFields = ['firstName', 'lastName', 'email', 'phone'];
            profileFields.forEach(field => {
                const input = document.getElementById('portal' + capitalizeFirst(field));
                if (input && memberData[field]) {
                    input.value = memberData[field];
                }
            });
            const addressInput = document.getElementById('portalAddress');
            if (addressInput) addressInput.value = memberData.address?.street || memberData.address || '';
            const cityInput = document.getElementById('portalCity');
            if (cityInput) cityInput.value = memberData.address?.city || memberData.city || 'Jacksonville';
            const stateInput = document.getElementById('portalState');
            if (stateInput) stateInput.value = memberData.address?.state || memberData.state || 'FL';
            const zipInput = document.getElementById('portalZip');
            if (zipInput) zipInput.value = memberData.address?.zip || memberData.zip || '';
            
            // Set membership status badge
            const statusEl = document.querySelector('#portalDashboard .portal-stat-card .status-badge');
            if (statusEl) {
                const isActive = memberData.expiresOn && new Date(memberData.expiresOn) > new Date();
                statusEl.textContent = isActive ? 'Active' : 'Expired';
                statusEl.className = 'status-badge ' + (isActive ? 'active' : 'expired');
            }
            
            // Show dashboard section by default
            showPortalSection('dashboard', document.querySelector('.portal-nav-item.active'));
            
            // Hide the modal if open
            const modal = document.getElementById('memberPortalModal');
            if (modal) {
                const bsModal = bootstrap.Modal.getInstance(modal);
                if (bsModal) bsModal.hide();
            }
            
            // Show full portal overlay
            overlay.style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            console.log('✅ Full portal opened');
        }
        
        /**
         * Close full-screen portal
         */
        function closeFullPortal() {
            const overlay = document.getElementById('memberPortalOverlay');
            if (overlay) {
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            }
            console.log('✅ Portal closed');
        }
        
        /**
         * Toggle portal sidebar drawer on mobile (≤576px)
         */
        function togglePortalSidebar() {
            const sidebar = document.querySelector('.portal-sidebar');
            const backdrop = document.querySelector('.portal-sidebar-backdrop');
            if (!sidebar) return;
            sidebar.classList.toggle('open');
            if (backdrop) backdrop.classList.toggle('show');
        }

        /**
         * Toggle admin sidebar drawer on mobile (≤576px)
         */
        function toggleAdminSidebar() {
            const sidebar = document.querySelector('.admin-sidebar');
            const backdrop = document.querySelector('.admin-sidebar-backdrop');
            if (!sidebar) return;
            sidebar.classList.toggle('open');
            if (backdrop) backdrop.classList.toggle('show');
        }
        
        /**
         * Switch between portal sections
         */
        function showPortalSection(sectionId, clickedNav) {
            console.log('📑 Switching to section:', sectionId);
            
            // Hide all sections
            document.querySelectorAll('.portal-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show target section
            const targetId = 'portal' + capitalizeFirst(sectionId);
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.classList.add('active');
            } else {
                console.warn('⚠️ Section not found:', targetId);
                // Fallback to dashboard
                document.getElementById('portalDashboard')?.classList.add('active');
            }
            
            // Update navigation active state
            document.querySelectorAll('.portal-nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            if (clickedNav) {
                clickedNav.classList.add('active');
            }

            // Close sidebar drawer on mobile after nav click
            if (window.innerWidth <= 576) {
                const sidebar = document.querySelector('.portal-sidebar');
                const backdrop = document.querySelector('.portal-sidebar-backdrop');
                if (sidebar) sidebar.classList.remove('open');
                if (backdrop) backdrop.classList.remove('show');
            }

            // Auto-render content for specific sections
            if (sectionId === 'events') renderMyRsvps();
        }

        /* ================================================================
         *  MEMBER RSVP FUNCTIONS
         * ================================================================ */

        let memberRsvps = []; // Track member's RSVPs

        function openMemberRsvp(eventId, eventName) {
            document.getElementById('memberRsvpFormContainer').style.display = 'block';
            document.getElementById('rsvpFormTitle').textContent = 'RSVP — ' + eventName;
            document.getElementById('rsvpEventId').value = eventId;
            document.getElementById('rsvpStatus').value = '';
            document.getElementById('rsvpAdults').value = 1;
            document.getElementById('rsvpKids').value = 0;
            document.getElementById('rsvpDietary').value = 'None';
            document.getElementById('rsvpNotes').value = '';
            document.getElementById('memberRsvpFormContainer').scrollIntoView({ behavior: 'smooth' });
        }

        function toggleRsvpDetails() {
            const status = document.getElementById('rsvpStatus').value;
            const show = (status === 'attending' || status === 'maybe');
            document.getElementById('rsvpDietaryCol').style.display = show ? '' : 'none';
        }

        function handleMemberRsvp(e) {
            e.preventDefault();
            const eventId = document.getElementById('rsvpEventId').value;
            const status = document.getElementById('rsvpStatus').value;
            const adults = parseInt(document.getElementById('rsvpAdults').value) || 0;
            const kids = parseInt(document.getElementById('rsvpKids').value) || 0;
            const dietary = document.getElementById('rsvpDietary').value;
            const notes = document.getElementById('rsvpNotes').value;

            const memberName = MemberPortal.member ? MemberPortal.member.name : 'Demo Member';

            // Find the invitation and add/update response
            const inv = DemoData.eviteData.invitations.find(i => i.id === eventId);
            if (inv) {
                const existingIdx = inv.responses.findIndex(r => r.name === memberName);
                const response = {
                    memberId: MemberPortal.member ? MemberPortal.member.id : 'DEMO',
                    name: memberName,
                    status: status,
                    adults: status === 'attending' ? adults : 0,
                    kids: status === 'attending' ? kids : 0,
                    dietary: status === 'attending' ? dietary : '',
                    notes: notes,
                    respondedAt: new Date().toISOString().split('T')[0]
                };
                if (existingIdx >= 0) {
                    inv.responses[existingIdx] = response;
                } else {
                    inv.responses.push(response);
                }
            }

            // Track in local array
            const localIdx = memberRsvps.findIndex(r => r.eventId === eventId);
            const rsvpRecord = { eventId, eventName: inv ? inv.eventName : eventId, status, adults, kids, dietary, notes };
            if (localIdx >= 0) memberRsvps[localIdx] = rsvpRecord;
            else memberRsvps.push(rsvpRecord);

            document.getElementById('memberRsvpFormContainer').style.display = 'none';
            renderMyRsvps();

            const statusEmoji = { attending: '✅', maybe: '🤔', not_attending: '❌' };
            alert(`${statusEmoji[status] || ''} RSVP submitted!\n\nEvent: ${inv ? inv.eventName : eventId}\nStatus: ${status}\nAdults: ${adults} • Kids: ${kids}\nDietary: ${dietary}`);
            return false;
        }

        function renderMyRsvps() {
            const tbody = document.getElementById('myRsvpTableBody');
            if (!tbody) return;

            if (memberRsvps.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center py-3 text-muted">No RSVPs yet. RSVP to an event above!</td></tr>';
                return;
            }

            tbody.innerHTML = memberRsvps.map(r => {
                const statusBadge = r.status === 'attending' ? '<span class="status-badge active">✅ Attending</span>'
                    : r.status === 'maybe' ? '<span class="status-badge pending">🤔 Maybe</span>'
                    : '<span class="status-badge inactive">❌ Declined</span>';
                return `<tr>
                    <td>${r.eventName}</td>
                    <td>${statusBadge}</td>
                    <td>${r.adults}</td>
                    <td>${r.kids}</td>
                    <td>${r.dietary || '-'}</td>
                    <td><button class="portal-feature-btn secondary" style="padding:0.25rem 0.75rem; font-size:0.8rem;" onclick="openMemberRsvp('${r.eventId}', '${r.eventName}')"><i class="fas fa-edit"></i> Edit</button></td>
                </tr>`;
            }).join('');
        }
        
        /**
         * Handle portal logout
         */
        function handlePortalLogout() {
            MemberPortal.isLoggedIn = false;
            MemberPortal.member = null;
            closeFullPortal();
            
            // Reset login form
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            
            showStatusMessage('info', '<i class="fas fa-sign-out-alt me-2"></i>You have been logged out.');
            console.log('✅ User logged out');
        }

        /**
         * Show the full-screen admin portal
         */
        function showAdminPortal(adminData) {
            const normalizedAdmin = normalizeMemberRecord(adminData);
            AdminPortal.isLoggedIn = true;
            AdminPortal.admin = normalizedAdmin;

            const overlay = document.getElementById('adminPortalOverlay');
            if (!overlay) {
                console.error('❌ adminPortalOverlay not found');
                return;
            }

            const roleLabel = ADMIN_ROLE_LABELS[normalizedAdmin.roleNormalized] || normalizedAdmin.adminRoleLabel || 'EC Member';
            document.getElementById('adminRoleBadge').textContent = roleLabel;
            document.getElementById('adminPortalName').textContent = normalizedAdmin.firstName || normalizedAdmin.email || 'Admin';

            // ===== Feature 3: Permission-based sidebar filtering =====
            const adminPermissions = adminData.ecPermissions || normalizedAdmin.ecPermissions || [];
            const adminRoles = extractRolesFromMember(adminData);
            const hasFullAccess = adminRoles.some(r => FULL_ACCESS_ROLES.has(r));
            AdminPortal.permissions = adminPermissions;
            AdminPortal.hasFullAccess = hasFullAccess;

            enforceAdminPermissions(adminPermissions, hasFullAccess);
            console.log(`🔐 Admin permissions: ${hasFullAccess ? 'FULL ACCESS' : adminPermissions.join(', ') || 'none'}`);

            showAdminSection('dashboard', document.querySelector('.admin-nav-item.active'));

            const adminModal = document.getElementById('adminLoginModal');
            if (adminModal) {
                const bsModal = bootstrap.Modal.getInstance(adminModal);
                if (bsModal) bsModal.hide();
            }

            overlay.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        /**
         * Enforce admin permissions: hide/show sidebar nav items and section headers
         * based on the logged-in admin's ecPermissions array.
         */
        function enforceAdminPermissions(permissions, hasFullAccess) {
            const navItems = document.querySelectorAll('.admin-nav-item[data-permission]');
            const permsSet = new Set(permissions);

            navItems.forEach(nav => {
                const requiredPerm = nav.getAttribute('data-permission');
                if (!requiredPerm || hasFullAccess || permsSet.has(requiredPerm)) {
                    nav.style.display = '';
                } else {
                    nav.style.display = 'none';
                }
            });

            // Hide sidebar section headers if ALL their child nav items are hidden
            document.querySelectorAll('.admin-sidebar-section').forEach(section => {
                const visibleNavs = section.querySelectorAll('.admin-nav-item:not([style*="display: none"])');
                const header = section.querySelector('h6');
                if (header) {
                    header.style.display = visibleNavs.length > 0 ? '' : 'none';
                }
            });
        }

        /**
         * Close admin portal
         */
        function closeAdminPortal() {
            const overlay = document.getElementById('adminPortalOverlay');
            if (overlay) {
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        /**
         * Switch admin sections (with permission enforcement)
         */
        function showAdminSection(sectionId, clickedNav) {
            // ===== Feature 3: Check permission before switching =====
            const requiredPerm = SECTION_PERMISSIONS[sectionId];
            if (requiredPerm && AdminPortal.admin && !AdminPortal.hasFullAccess) {
                const perms = AdminPortal.permissions || [];
                if (!perms.includes(requiredPerm)) {
                    console.warn(`🚫 Access denied to "${sectionId}" — requires "${requiredPerm}" permission`);
                    // Show brief toast instead of hard-blocking
                    const toast = document.createElement('div');
                    toast.className = 'position-fixed top-0 start-50 translate-middle-x mt-3 px-4 py-2 rounded-pill shadow';
                    toast.style.cssText = 'background:#dc3545;color:#fff;z-index:99999;font-size:0.9rem;opacity:0;transition:opacity 0.3s';
                    toast.innerHTML = '<i class="fas fa-lock me-2"></i>You don\'t have access to this section';
                    document.body.appendChild(toast);
                    requestAnimationFrame(() => toast.style.opacity = '1');
                    setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 2500);
                    return;
                }
            }

            const targetId = 'admin' + capitalizeFirst(sectionId);
            document.querySelectorAll('.admin-section').forEach(section => section.classList.remove('active'));
            const target = document.getElementById(targetId);
            if (target) {
                target.classList.add('active');
                // Feature 1: Render site config panel when section is activated
                if (sectionId === 'siteConfig') {
                    SiteConfigManager.renderConfigPanel();
                }
                // Feature 7: Render DB Explorer when section is activated
                if (sectionId === 'dbExplorer') {
                    MemberDBExplorer.render();
                }
                // Feature 6: Render Career Directory when section is activated
                if (sectionId === 'careers') {
                    renderAdminCareerTable();
                }
                // Zelle: Load payment data when payments section is activated (cloud service — always available)
                if (sectionId === 'payments') {
                    zelleLoadPayments();
                    zelleLoadStats();
                }
            } else {
                document.getElementById('adminDashboard')?.classList.add('active');
            }

            document.querySelectorAll('.admin-nav-item').forEach(nav => nav.classList.remove('active'));
            if (clickedNav) clickedNav.classList.add('active');
            AdminPortal.currentSection = sectionId;

            // Close sidebar drawer on mobile after nav click
            if (window.innerWidth <= 576) {
                const sidebar = document.querySelector('.admin-sidebar');
                const backdrop = document.querySelector('.admin-sidebar-backdrop');
                if (sidebar) sidebar.classList.remove('open');
                if (backdrop) backdrop.classList.remove('show');
            }
        }

        /**
         * Admin logout
         */
        function handleAdminLogout() {
            AdminPortal.isLoggedIn = false;
            AdminPortal.admin = null;
            closeAdminPortal();
        }

        /* ================================================================
         *  EVITE / INVITATION MANAGEMENT FUNCTIONS
         * ================================================================ */

        function openSendEviteForm() {
            document.getElementById('sendEviteFormContainer').style.display = 'block';
            document.getElementById('sendEviteForm').reset();
        }

        function applyEviteTemplate() {
            const tplId = document.getElementById('eviteTemplate').value;
            if (!tplId) return;
            const tpl = DemoData.eviteData.templates.find(t => t.id === tplId);
            if (!tpl) return;
            document.getElementById('eviteSubject').value = tpl.subject;
            document.getElementById('eviteMessage').value = tpl.body;
        }

        function handleSendEvite(e) {
            e.preventDefault();
            const eventName = document.getElementById('eviteEventName').value;
            const date = document.getElementById('eviteDate').value;
            const venue = document.getElementById('eviteVenue').value || 'TBD';
            const recipients = document.getElementById('eviteRecipients').value;
            const subject = document.getElementById('eviteSubject').value;
            const message = document.getElementById('eviteMessage').value;

            const recipientCount = { all: 156, active: 148, family: 92, ec: 10 }[recipients] || 156;

            // Create new invitation record
            const newInvite = {
                id: 'EVT-' + String(DemoData.eviteData.invitations.length + 1).padStart(3, '0'),
                eventName: eventName,
                eventDate: date,
                venue: venue,
                sentDate: new Date().toISOString().split('T')[0],
                sentTo: recipientCount,
                sentBy: AdminPortal.admin ? AdminPortal.admin.name : 'Admin',
                subject: subject,
                collectDietary: document.getElementById('eviteCollectDietary').checked,
                collectKids: document.getElementById('eviteCollectKids').checked,
                responses: []
            };

            DemoData.eviteData.invitations.push(newInvite);
            document.getElementById('sendEviteFormContainer').style.display = 'none';
            renderEviteHistory();

            // === SEND REAL EMAIL VIA GMAIL BACKEND ===
            (async function sendRealEviteEmail() {
                try {
                    // Build recipient list from member directory (use test email for now)
                    const testRecipient = 'ranadhir.ghosh@gmail.com';
                    let recipientEmails = [testRecipient];

                    // In production, gather all member emails from DemoData.memberDirectory
                    // For now we use the test recipient
                    const time = document.getElementById('eviteTime') ? document.getElementById('eviteTime').value : '';

                    const evitePayload = {
                        recipients: recipientEmails.map(em => ({ name: em.split('@')[0], email: em })),
                        event_name: eventName,
                        event_date: date,
                        event_time: time || '6:00 PM',
                        venue: venue,
                        message: message || subject,
                        rsvp_deadline: date
                    };

                    const r = await apiFetch('/send-evite', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(evitePayload)
                    });
                    const d = await r.json();
                    if (d.success) {
                        alert(`✅ Evite sent successfully!\n\n📧 Real email delivered via Gmail!\nEvent: ${eventName}\nRecipients: ${recipientEmails.join(', ')}\nDate: ${date}\n\nSent ${d.sent_count} email(s) from banfjax@gmail.com`);
                    } else {
                        alert(`⚠️ Evite recorded but email delivery failed:\n${d.error || 'Unknown error'}\n\nNote: The evite was saved locally. Fix Gmail connection to resend.`);
                    }
                } catch(emailErr) {
                    console.error('Gmail send error:', emailErr);
                    alert(`✅ Evite recorded locally!\n\n⚠️ Could not send real email (Gmail service may be offline).\nEvent: ${eventName}\nRecipients: ${recipientCount} members\nDate: ${date}`);
                }
            })();

            return false;
        }

        function previewEvite() {
            const eventName = document.getElementById('eviteEventName').value || 'Event Name';
            const date = document.getElementById('eviteDate').value || 'TBD';
            const venue = document.getElementById('eviteVenue').value || 'TBD';
            const time = document.getElementById('eviteTime').value || '';
            const subject = document.getElementById('eviteSubject').value || 'You\'re invited!';
            let message = document.getElementById('eviteMessage').value || 'Please join us for this wonderful event.';

            message = message.replace(/{eventName}/g, eventName)
                           .replace(/{eventDate}/g, date)
                           .replace(/{venue}/g, venue)
                           .replace(/{eventTime}/g, time)
                           .replace(/{memberName}/g, 'Dear Member');

            alert(`📧 EVITE PREVIEW\n\nSubject: ${subject}\n\n${message}\n\n📍 Venue: ${venue}\n📅 Date: ${date}\n🕐 Time: ${time}`);
        }

        function renderEviteHistory() {
            const container = document.getElementById('eviteHistoryList');
            if (!container) return;
            const invitations = DemoData.eviteData.invitations;

            container.innerHTML = invitations.map(inv => {
                const attending = inv.responses.filter(r => r.status === 'attending').length;
                const maybe = inv.responses.filter(r => r.status === 'maybe').length;
                const declined = inv.responses.filter(r => r.status === 'not_attending').length;
                const totalAdults = inv.responses.filter(r => r.status === 'attending').reduce((s, r) => s + (r.adults || 0), 0);
                const totalKids = inv.responses.filter(r => r.status === 'attending').reduce((s, r) => s + (r.kids || 0), 0);
                const responseRate = inv.sentTo > 0 ? Math.round((inv.responses.length / inv.sentTo) * 100) : 0;

                return `
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <div class="admin-card-icon"><i class="fas fa-envelope"></i></div>
                            <div>
                                <h4>${inv.eventName}</h4>
                                <small>Sent: ${inv.sentDate} • ${inv.sentTo} recipients</small>
                            </div>
                        </div>
                        <div style="display:flex; gap:1rem; flex-wrap:wrap; margin: 0.5rem 0;">
                            <span class="status-badge active">✅ ${attending} Attending</span>
                            <span class="status-badge pending">🤔 ${maybe} Maybe</span>
                            <span class="status-badge inactive">❌ ${declined} Declined</span>
                        </div>
                        <p style="margin:0.5rem 0;">
                            <strong>Response Rate:</strong> ${responseRate}% (${inv.responses.length}/${inv.sentTo})<br>
                            <strong>Expected Headcount:</strong> ${totalAdults} adults, ${totalKids} kids
                        </p>
                        <div class="admin-actions">
                            <button class="admin-primary" onclick="showEviteReport('${inv.id}')"><i class="fas fa-chart-bar me-1"></i> Report</button>
                            <button class="admin-secondary" onclick="sendEviteReminder('${inv.id}')"><i class="fas fa-bell me-1"></i> Remind</button>
                        </div>
                    </div>`;
            }).join('');
        }

        function showEviteReport(inviteId) {
            const inv = DemoData.eviteData.invitations.find(i => i.id === inviteId);
            if (!inv) return;

            const reportArea = document.getElementById('eviteReportArea');
            reportArea.style.display = 'block';
            document.getElementById('eviteReportTitle').innerHTML = `<i class="fas fa-chart-bar me-2"></i>RSVP Report — ${inv.eventName}`;

            const attending = inv.responses.filter(r => r.status === 'attending');
            const maybe = inv.responses.filter(r => r.status === 'maybe');
            const declined = inv.responses.filter(r => r.status === 'not_attending');
            const totalAdults = attending.reduce((s, r) => s + (r.adults || 0), 0);
            const totalKids = attending.reduce((s, r) => s + (r.kids || 0), 0);

            // Stats
            document.getElementById('eviteReportStats').innerHTML = `
                <div class="admin-stat-card"><div class="admin-stat-value">${inv.responses.length}</div><div class="admin-stat-label">Total Responses</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value" style="color:#4CAF50">${attending.length}</div><div class="admin-stat-label">Attending</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value" style="color:#FF9800">${maybe.length}</div><div class="admin-stat-label">Maybe</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value" style="color:#f44336">${declined.length}</div><div class="admin-stat-label">Declined</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value">${totalAdults}</div><div class="admin-stat-label">Total Adults</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value">${totalKids}</div><div class="admin-stat-label">Total Kids</div></div>
            `;

            // Dietary summary
            const dietaryCounts = {};
            attending.forEach(r => {
                const d = r.dietary || 'Not specified';
                dietaryCounts[d] = (dietaryCounts[d] || 0) + (r.adults || 0);
            });
            document.getElementById('eviteReportDietary').innerHTML = `
                <h5><i class="fas fa-utensils me-2"></i>Dietary Summary</h5>
                <div style="display:flex; gap:0.5rem; flex-wrap:wrap;">
                    ${Object.entries(dietaryCounts).map(([diet, count]) =>
                        `<span class="status-badge active">${diet}: ${count} adults</span>`
                    ).join('')}
                </div>`;

            // Response table
            document.getElementById('eviteReportTableBody').innerHTML = inv.responses.map(r => `
                <tr>
                    <td>${r.name}</td>
                    <td><span class="status-badge ${r.status === 'attending' ? 'active' : r.status === 'maybe' ? 'pending' : 'inactive'}">${r.status === 'attending' ? '✅ Attending' : r.status === 'maybe' ? '🤔 Maybe' : '❌ Declined'}</span></td>
                    <td>${r.adults || '-'}</td>
                    <td>${r.kids || '-'}</td>
                    <td>${r.dietary || '-'}</td>
                    <td>${r.notes || '-'}</td>
                    <td>${r.respondedAt || '-'}</td>
                </tr>
            `).join('');
        }

        function sendEviteReminder(inviteId) {
            const inv = DemoData.eviteData.invitations.find(i => i.id === inviteId);
            if (!inv) return;
            const noResponse = inv.sentTo - inv.responses.length;
            alert(`📬 Reminder sent!\n\nEvent: ${inv.eventName}\nSent to: ${noResponse} members who haven't responded yet.`);
        }

        function exportEviteReport() {
            let csv = 'Event,Member,Status,Adults,Kids,Dietary,Notes,Responded\n';
            DemoData.eviteData.invitations.forEach(inv => {
                inv.responses.forEach(r => {
                    csv += `"${inv.eventName}","${r.name}","${r.status}",${r.adults || 0},${r.kids || 0},"${r.dietary || ''}","${r.notes || ''}","${r.respondedAt || ''}"\n`;
                });
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = 'evite_rsvp_report.csv'; a.click();
            URL.revokeObjectURL(url);
        }

        function renderRsvpDashboard() {
            const statsEl = document.getElementById('rsvpSummaryStats');
            const tbody = document.getElementById('rsvpTableBody');
            if (!statsEl || !tbody) return;

            let totalAttending = 0, totalMaybe = 0, totalDeclined = 0, totalAdults = 0, totalKids = 0;
            const allRows = [];

            DemoData.eviteData.invitations.forEach(inv => {
                inv.responses.forEach(r => {
                    if (r.status === 'attending') { totalAttending++; totalAdults += (r.adults || 0); totalKids += (r.kids || 0); }
                    else if (r.status === 'maybe') totalMaybe++;
                    else totalDeclined++;
                    allRows.push({ event: inv.eventName, ...r });
                });
            });

            statsEl.innerHTML = `
                <div class="admin-stat-card"><div class="admin-stat-value" style="color:#4CAF50">${totalAttending}</div><div class="admin-stat-label">Attending</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value" style="color:#FF9800">${totalMaybe}</div><div class="admin-stat-label">Maybe</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value">${totalAdults + totalKids}</div><div class="admin-stat-label">Total Headcount</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value">${totalAdults}</div><div class="admin-stat-label">Adults</div></div>
                <div class="admin-stat-card"><div class="admin-stat-value">${totalKids}</div><div class="admin-stat-label">Kids</div></div>
            `;

            tbody.innerHTML = allRows.map(r => `
                <tr>
                    <td>${r.event}</td>
                    <td>${r.name}</td>
                    <td><span class="status-badge ${r.status === 'attending' ? 'active' : r.status === 'maybe' ? 'pending' : 'inactive'}">${r.status === 'attending' ? '✅ Attending' : r.status === 'maybe' ? '🤔 Maybe' : '❌ Declined'}</span></td>
                    <td>${r.adults || '-'}</td>
                    <td>${r.kids || '-'}</td>
                    <td>${r.dietary || '-'}</td>
                    <td>${r.notes || '-'}</td>
                    <td><button class="admin-secondary" onclick="alert('✅ ${r.name} checked in!')">Check-in</button></td>
                </tr>
            `).join('');
        }

        /* ================================================================
         *  EXCEL / CSV IMPORT FUNCTIONS
         * ================================================================ */

        let pendingImportData = { type: '', rows: [], headers: [] };

        function handleExcelUpload(type, inputEl) {
            const file = inputEl.files[0];
            if (!file) return;
            const ext = file.name.split('.').pop().toLowerCase();

            if (ext === 'csv') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    parseCSVData(e.target.result, type, file.name);
                };
                reader.readAsText(file);
            } else if (ext === 'xlsx' || ext === 'xls') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const workbook = XLSX.read(e.target.result, { type: 'array' });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                        if (jsonData.length < 2) { alert('❌ Excel file is empty or has no data rows.'); inputEl.value = ''; return; }
                        const headers = jsonData[0].map(h => String(h || '').trim());
                        const rows = jsonData.slice(1).map(row => {
                            const obj = {};
                            headers.forEach((h, i) => obj[h] = row[i] !== undefined ? String(row[i]).trim() : '');
                            return obj;
                        }).filter(row => Object.values(row).some(v => v));
                        if (rows.length === 0) { alert('❌ No valid data rows found in Excel file.'); inputEl.value = ''; return; }
                        pendingImportData = { type, rows, headers };
                        showImportPreview(type, headers, rows, file.name);
                    } catch (err) {
                        alert('❌ Error reading Excel file: ' + err.message);
                        inputEl.value = '';
                    }
                };
                reader.readAsArrayBuffer(file);
            } else {
                alert('❌ Unsupported file format. Please use .xlsx, .xls, or .csv files.');
                inputEl.value = '';
            }
        }

        function parseCSVData(csvText, type, fileName) {
            const lines = csvText.split('\n').filter(l => l.trim());
            if (lines.length < 2) { alert('❌ File is empty or has no data rows.'); return; }

            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const rows = [];
            for (let i = 1; i < lines.length; i++) {
                const vals = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                if (vals.length === headers.length) {
                    const row = {};
                    headers.forEach((h, idx) => row[h] = vals[idx]);
                    rows.push(row);
                }
            }

            if (rows.length === 0) { alert('❌ No valid data rows found.'); return; }

            pendingImportData = { type, rows, headers };
            showImportPreview(type, headers, rows, fileName);
        }

        function showImportPreview(type, headers, rows, fileName) {
            const area = document.getElementById('importPreviewArea');
            area.style.display = 'block';
            document.getElementById('importPreviewTitle').innerHTML = `<i class="fas fa-table me-2"></i>Preview: ${fileName} (${rows.length} rows)`;

            document.getElementById('importPreviewStats').innerHTML = `
                <span class="status-badge active"><i class="fas fa-columns me-1"></i>${headers.length} columns</span>
                <span class="status-badge active"><i class="fas fa-rows me-1"></i>${rows.length} rows</span>
                <span class="status-badge pending"><i class="fas fa-tag me-1"></i>Type: ${type}</span>
            `;

            document.getElementById('importPreviewHead').innerHTML = `<tr>${headers.map(h => `<th>${h}</th>`).join('')}<th>Valid</th></tr>`;
            document.getElementById('importPreviewBody').innerHTML = rows.slice(0, 20).map(row => {
                const cells = headers.map(h => `<td>${row[h] || ''}</td>`).join('');
                return `<tr>${cells}<td><span class="status-badge active">✓</span></td></tr>`;
            }).join('') + (rows.length > 20 ? `<tr><td colspan="${headers.length + 1}" style="text-align:center;color:#666;">... and ${rows.length - 20} more rows</td></tr>` : '');
        }

        function confirmImport() {
            const { type, rows } = pendingImportData;
            if (!rows.length) return;

            if (type === 'members') {
                rows.forEach(row => {
                    DemoData.memberDirectory.push({
                        id: 'MEM-' + String(DemoData.memberDirectory.length + 1).padStart(3, '0'),
                        firstName: row['First Name'] || row['FirstName'] || '',
                        lastName: row['Last Name'] || row['LastName'] || '',
                        email: row['Email'] || '',
                        phone: row['Phone'] || '',
                        type: row['Membership Type'] || row['Type'] || 'Individual',
                        status: 'Active',
                        joinDate: row['Join Date'] || row['JoinDate'] || new Date().toISOString().split('T')[0],
                        address: row['Address'] || '',
                        city: row['City'] || '',
                        state: row['State'] || '',
                        zip: row['Zip'] || '',
                        familyMembers: row['Family Members'] || '',
                        expiryDate: row['Expiry Date'] || row['ExpiryDate'] || ''
                    });
                });
            }

            // Add import history
            const historyBody = document.getElementById('importHistoryBody');
            if (historyBody) {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td>${new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</td>
                    <td>${type.charAt(0).toUpperCase() + type.slice(1)}</td>
                    <td>${rows.length} records</td>
                    <td><span class="status-badge active">Success</span></td>
                    <td>${AdminPortal.admin ? AdminPortal.admin.name : 'Admin'}</td>
                `;
                historyBody.insertBefore(newRow, historyBody.firstChild);
            }

            document.getElementById('importPreviewArea').style.display = 'none';
            alert(`✅ Import Successful!\n\n${rows.length} ${type} records imported successfully.`);
            pendingImportData = { type: '', rows: [], headers: [] };
        }

        function downloadTemplate(type) {
            let csv = '';
            if (type === 'members') {
                csv = 'First Name,Last Name,Email,Phone,Membership Type,Address,City,State,Zip,Family Members,Join Date,Expiry Date\n'
                    + 'John,Doe,john@example.com,555-0101,Family,123 Main St,Jacksonville,FL,32256,3,2026-01-01,2027-01-01\n'
                    + 'Jane,Smith,jane@example.com,555-0102,Individual,456 Oak Ave,Jacksonville,FL,32257,1,2026-02-15,2027-02-15\n';
            } else if (type === 'events') {
                csv = 'Event Name,Date,Time,Venue,Description\nSample Event,2026-06-01,5:00 PM,Community Center,Annual celebration\n';
            } else if (type === 'payments') {
                csv = 'Member Name,Amount,Date,Type,Status\nJohn Doe,100,2026-01-15,Annual Dues,Completed\n';
            }
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = `banf_${type}_template.csv`; a.click();
            URL.revokeObjectURL(url);
        }

        /* ================================================================
         *  MEMBER DB EXPLORER (Feature 7)
         * ================================================================ */

        const MemberDBExplorer = {
            currentPage: 1,
            perPage: 15,
            filtered: [],

            // Role-based CRUD permissions
            CRUD_ROLES: {
                add:      new Set(['president', 'secretary', 'super_admin']),
                edit:     new Set(['president', 'secretary', 'super_admin']),
                delete:   new Set(['president', 'super_admin']),
                export:   new Set(['president', 'treasurer', 'secretary', 'super_admin']),
                bulkImport: new Set(['president', 'secretary', 'super_admin'])
            },

            canDo(action) {
                if (!AdminPortal.admin) return false;
                const role = normalizeRoleValue(AdminPortal.admin.role || '');
                if (FULL_ACCESS_ROLES.has(role)) return true;
                return this.CRUD_ROLES[action] && this.CRUD_ROLES[action].has(role);
            },

            render() {
                this.renderStats();
                this.applyFilters();
                this.renderActionButtons();
            },

            renderStats() {
                const members = DemoData.memberDirectory;
                const active = members.filter(m => (m.status || '').toLowerCase() === 'active').length;
                const expired = members.filter(m => (m.status || '').toLowerCase() === 'expired').length;
                const pending = members.filter(m => (m.status || '').toLowerCase() === 'pending').length;
                const types = {};
                members.forEach(m => { const t = m.type || m.membershipType || 'Unknown'; types[t] = (types[t] || 0) + 1; });
                const topType = Object.entries(types).sort((a,b) => b[1] - a[1])[0];

                document.getElementById('dbExpStats').innerHTML = `
                    <div class="admin-card" style="text-align:center;"><h3 style="color:#1a237e;">${members.length}</h3><p style="margin:0;font-size:0.85rem;">Total Members</p></div>
                    <div class="admin-card" style="text-align:center;"><h3 style="color:#4CAF50;">${active}</h3><p style="margin:0;font-size:0.85rem;">Active</p></div>
                    <div class="admin-card" style="text-align:center;"><h3 style="color:#f44336;">${expired}</h3><p style="margin:0;font-size:0.85rem;">Expired</p></div>
                    <div class="admin-card" style="text-align:center;"><h3 style="color:#ff9800;">${pending || 0}</h3><p style="margin:0;font-size:0.85rem;">Pending</p></div>
                    <div class="admin-card" style="text-align:center;"><h3 style="color:#673ab7;">${topType ? topType[0] : '-'}</h3><p style="margin:0;font-size:0.85rem;">Top Type (${topType ? topType[1] : 0})</p></div>
                `;
            },

            renderActionButtons() {
                const show = (id, action) => { const el = document.getElementById(id); if (el) el.style.display = this.canDo(action) ? '' : 'none'; };
                show('dbExpAddBtn', 'add');
                show('dbExpExportCsvBtn', 'export');
                show('dbExpExportXlsxBtn', 'export');
            },

            applyFilters() {
                const search = (document.getElementById('dbExpSearch')?.value || '').toLowerCase();
                const statusFilter = document.getElementById('dbExpFilterStatus')?.value || '';
                const typeFilter = document.getElementById('dbExpFilterType')?.value || '';
                const sortBy = document.getElementById('dbExpSort')?.value || 'lastName';

                let data = DemoData.memberDirectory.slice();

                // Filter
                if (search) {
                    data = data.filter(m => {
                        const haystack = [m.firstName, m.lastName, m.email, m.phone, m.id].join(' ').toLowerCase();
                        return haystack.includes(search);
                    });
                }
                if (statusFilter) data = data.filter(m => (m.status || '') === statusFilter);
                if (typeFilter) data = data.filter(m => (m.type || m.membershipType || '') === typeFilter);

                // Sort
                data.sort((a, b) => {
                    const valA = String(a[sortBy] || '').toLowerCase();
                    const valB = String(b[sortBy] || '').toLowerCase();
                    return valA.localeCompare(valB);
                });

                this.filtered = data;
                this.currentPage = 1;
                this.renderTable();
            },

            renderTable() {
                const start = (this.currentPage - 1) * this.perPage;
                const page = this.filtered.slice(start, start + this.perPage);
                const totalPages = Math.max(1, Math.ceil(this.filtered.length / this.perPage));
                const canEdit = this.canDo('edit');
                const canDelete = this.canDo('delete');

                const tbody = document.getElementById('dbExpTableBody');
                if (!tbody) return;
                tbody.innerHTML = page.map((m, i) => {
                    const statusClass = (m.status || '').toLowerCase() === 'active' ? 'active' : (m.status || '').toLowerCase() === 'expired' ? 'danger' : 'pending';
                    const actions = [];
                    if (canEdit) actions.push(`<button class="admin-secondary" style="padding:2px 8px;font-size:0.8rem;" onclick="MemberDBExplorer.editMember('${m.id}')"><i class="fas fa-edit"></i></button>`);
                    if (canDelete) actions.push(`<button class="admin-secondary" style="padding:2px 8px;font-size:0.8rem;color:#f44336;" onclick="MemberDBExplorer.deleteMember('${m.id}')"><i class="fas fa-trash"></i></button>`);
                    return `<tr>
                        <td>${start + i + 1}</td>
                        <td style="font-size:0.8rem;color:#666;">${m.id || ''}</td>
                        <td><strong>${m.lastName || ''}, ${m.firstName || ''}</strong></td>
                        <td>${m.email || ''}</td>
                        <td>${m.phone || ''}</td>
                        <td>${m.type || m.membershipType || ''}</td>
                        <td><span class="status-badge ${statusClass}">${m.status || ''}</span></td>
                        <td style="font-size:0.85rem;">${m.joinDate || ''}</td>
                        <td>${actions.join(' ') || '<span style="color:#999;">—</span>'}</td>
                    </tr>`;
                }).join('');

                if (page.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="9" style="text-align:center;color:#999;padding:2rem;">No members found matching your criteria</td></tr>';
                }

                document.getElementById('dbExpPageInfo').textContent = `Showing ${this.filtered.length ? start + 1 : 0}–${Math.min(start + this.perPage, this.filtered.length)} of ${this.filtered.length} members (Page ${this.currentPage} of ${totalPages})`;
                document.getElementById('dbExpPrevBtn').disabled = this.currentPage <= 1;
                document.getElementById('dbExpNextBtn').disabled = this.currentPage >= totalPages;
            },

            prevPage() { if (this.currentPage > 1) { this.currentPage--; this.renderTable(); } },
            nextPage() { const totalPages = Math.ceil(this.filtered.length / this.perPage); if (this.currentPage < totalPages) { this.currentPage++; this.renderTable(); } },

            showAddModal() {
                const fields = ['firstName', 'lastName', 'email', 'phone'];
                const typeOptions = ['Family', 'Individual', 'Couple', 'Student', 'Senior'];
                const vals = {};
                fields.forEach(f => vals[f] = prompt(`Enter ${f.replace(/([A-Z])/g, ' $1').trim()}:`) || '');
                if (!vals.firstName && !vals.lastName) return;
                const mType = prompt('Membership Type (' + typeOptions.join('/') + '):', 'Family') || 'Family';
                const newMember = {
                    id: 'BANF-' + new Date().getFullYear() + '-' + String(DemoData.memberDirectory.length + 1).padStart(3, '0'),
                    firstName: vals.firstName, lastName: vals.lastName,
                    email: vals.email, phone: vals.phone,
                    type: mType, status: 'Active',
                    joinDate: new Date().toISOString().split('T')[0]
                };
                DemoData.memberDirectory.push(newMember);
                alert('✅ Member added: ' + newMember.firstName + ' ' + newMember.lastName);
                this.render();
            },

            editMember(id) {
                const idx = DemoData.memberDirectory.findIndex(m => m.id === id);
                if (idx === -1) return;
                const m = DemoData.memberDirectory[idx];
                const newFirst = prompt('First Name:', m.firstName);
                if (newFirst === null) return;
                m.firstName = newFirst || m.firstName;
                m.lastName = prompt('Last Name:', m.lastName) || m.lastName;
                m.email = prompt('Email:', m.email) || m.email;
                m.phone = prompt('Phone:', m.phone) || m.phone;
                m.type = prompt('Membership Type (Family/Individual/Couple/Student/Senior):', m.type || m.membershipType) || m.type;
                m.status = prompt('Status (Active/Expired/Pending):', m.status) || m.status;
                alert('✅ Member updated: ' + m.firstName + ' ' + m.lastName);
                this.render();
            },

            deleteMember(id) {
                const idx = DemoData.memberDirectory.findIndex(m => m.id === id);
                if (idx === -1) return;
                const m = DemoData.memberDirectory[idx];
                if (!confirm(`⚠️ Delete member "${m.firstName} ${m.lastName}" (${m.id})?\nThis cannot be undone.`)) return;
                DemoData.memberDirectory.splice(idx, 1);
                alert('🗑️ Member deleted.');
                this.render();
            },

            exportCSV() {
                const headers = ['ID','First Name','Last Name','Email','Phone','Type','Status','Join Date'];
                const rows = this.filtered.map(m => [m.id, m.firstName, m.lastName, m.email, m.phone, m.type || m.membershipType, m.status, m.joinDate].map(v => '"' + (v||'').replace(/"/g,'""') + '"').join(','));
                const csv = [headers.join(','), ...rows].join('\n');
                const blob = new Blob([csv], { type: 'text/csv' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'banf_members_export_' + new Date().toISOString().slice(0,10) + '.csv';
                a.click();
                URL.revokeObjectURL(a.href);
            },

            exportExcel() {
                if (typeof XLSX === 'undefined') { alert('❌ SheetJS library not loaded. Cannot export Excel.'); return; }
                const data = this.filtered.map(m => ({
                    'ID': m.id, 'First Name': m.firstName, 'Last Name': m.lastName,
                    'Email': m.email, 'Phone': m.phone, 'Type': m.type || m.membershipType,
                    'Status': m.status, 'Join Date': m.joinDate
                }));
                const ws = XLSX.utils.json_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Members');
                XLSX.writeFile(wb, 'banf_members_export_' + new Date().toISOString().slice(0,10) + '.xlsx');
            }
        };

        /* ================================================================
         *  GMAIL / EMAIL MANAGEMENT FUNCTIONS
         * ================================================================ */

        let gmailState = { connected: false, currentPage: 1, perPage: 15, currentEmail: null, contactGroups: {} };

        async function gmailCheckConnection() {
            const icon = document.getElementById('gmailStatusIcon');
            const text = document.getElementById('gmailStatusText');
            const detail = document.getElementById('gmailStatusDetail');
            const bar = document.getElementById('gmailConnectionStatus');
            icon.style.color = '#ff9800'; text.textContent = 'Connecting...'; detail.textContent = 'Connecting to BANF Email Service...';
            const { ok, status, data } = await safeApiFetch('/status');
            if (ok && data.status === 'connected') {
                icon.style.color = '#4CAF50'; text.textContent = '✅ Connected to BANF Email Service';
                detail.textContent = `Service: ${data.service_type || data.service || 'Wix'} | Sent Today: ${data.sentToday || data.sent_today || 0}`;
                bar.style.borderLeftColor = '#4CAF50'; gmailState.connected = true;
                gmailLoadUnreadCount();
            } else if (status === 404) {
                icon.style.color = '#ff9800'; text.textContent = '⚠️ Email Backend Not Yet Deployed';
                detail.innerHTML = 'The Wix Velo email backend needs to be published. '
                    + '<strong>Steps:</strong> Open Wix Editor → Dev Mode → publish <code>email-gateway.jsw</code> + <code>http-functions.js</code> → Publish Site. '
                    + '<br><small class="text-muted">Endpoint: ' + WIX_API_BASE + '/email_status → 404</small>';
                bar.style.borderLeftColor = '#ff9800';
            } else {
                icon.style.color = '#f44336'; text.textContent = '❌ Connection Failed';
                detail.textContent = data.error || 'Email service temporarily unavailable';
                bar.style.borderLeftColor = '#f44336';
            }
        }

        async function gmailLoadUnreadCount() {
            const { ok, data } = await safeApiFetch('/unread');
            const badge = document.getElementById('gmailUnreadBadge');
            const stat = document.getElementById('gmailStatUnread');
            if (ok && data.unread_count > 0) { badge.style.display = 'inline-block'; badge.textContent = data.unread_count; stat.textContent = data.unread_count; }
            else { badge.style.display = 'none'; stat.textContent = '0'; }
        }

        function gmailShowTab(tab) {
            ['inbox','compose','contacts','search'].forEach(t => {
                const el = document.getElementById('gmailTab' + t.charAt(0).toUpperCase() + t.slice(1));
                if (el) el.style.display = (t === tab) ? 'block' : 'none';
            });
            document.querySelectorAll('#gmailTabs .nav-link').forEach(a => a.classList.remove('active'));
            event.target.classList.add('active');
            if (tab === 'inbox') gmailLoadInbox();
            if (tab === 'contacts') gmailLoadContactGroups();
        }

        function gmailOpenCompose(to, subject, body) {
            gmailShowTab('compose');
            document.querySelectorAll('#gmailTabs .nav-link').forEach(a => a.classList.remove('active'));
            document.querySelectorAll('#gmailTabs .nav-link')[1].classList.add('active');
            if (to) document.getElementById('gmailComposeTo').value = to;
            if (subject) document.getElementById('gmailComposeSubject').value = subject;
            if (body) document.getElementById('gmailComposeBody').value = body;
        }

        async function gmailLoadInbox() {
            const tbody = document.getElementById('gmailInboxTableBody');
            const folder = document.getElementById('gmailFolderSelect').value;
            tbody.innerHTML = '<tr><td colspan="5" class="text-center"><i class="fas fa-spinner fa-spin me-2"></i>Loading...</td></tr>';
            const { ok, status, data } = await safeApiFetch(`/inbox?page=${gmailState.currentPage}&per_page=${gmailState.perPage}&folder=${encodeURIComponent(folder)}`);
            if (!ok) {
                const msg = status === 404
                    ? '⚠️ Email backend not deployed yet. Publish Wix Velo code to enable inbox.'
                    : `❌ Failed to load inbox: ${data.error || 'Service unavailable'}`;
                tbody.innerHTML = `<tr><td colspan="5" class="text-center text-muted">${msg}</td></tr>`;
                document.getElementById('gmailStatInbox').textContent = '--'; return;
            }
            const d = data;
            if (!d.emails || d.emails.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center text-muted">No emails found</td></tr>';
                document.getElementById('gmailStatInbox').textContent = '0'; return;
            }
            document.getElementById('gmailStatInbox').textContent = d.total || d.emails.length;
            tbody.innerHTML = d.emails.map(em => {
                const unread = !em.seen;
                const fw = unread ? 'fw-bold' : '';
                const bg = unread ? 'background:#fff8e1;' : '';
                const fromShort = (em.from || 'Unknown').replace(/<.*>/,'').trim().substring(0,30);
                const subjShort = (em.subject || '(no subject)').substring(0,60);
                const dateShort = em.date ? new Date(em.date).toLocaleDateString() : '';
                return `<tr style="${bg}" onclick="gmailViewEmail('${em.id}','${encodeURIComponent(folder)}')" class="cursor-pointer">
                    <td class="${fw}">${escapeHtml(fromShort)}</td>
                    <td class="${fw}">${escapeHtml(subjShort)}</td>
                    <td>${dateShort}</td>
                    <td>${em.has_attachments ? '<i class="fas fa-paperclip text-muted"></i>' : ''}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="event.stopPropagation();gmailReplyToId('${em.id}','${encodeURIComponent(folder)}')"><i class="fas fa-reply"></i></button>
                        <button class="btn btn-sm btn-outline-danger" onclick="event.stopPropagation();gmailDeleteEmail('${em.id}','${encodeURIComponent(folder)}')"><i class="fas fa-trash"></i></button>
                    </td></tr>`;
            }).join('');
            // Pagination
            const totalPages = Math.ceil((d.total || d.emails.length) / gmailState.perPage);
            const pag = document.getElementById('gmailPagination');
            pag.innerHTML = '';
            if (totalPages > 1) {
                for (let p = 1; p <= Math.min(totalPages, 10); p++) {
                    pag.innerHTML += `<button class="btn btn-sm ${p===gmailState.currentPage?'btn-primary':'btn-outline-secondary'}" onclick="gmailState.currentPage=${p};gmailLoadInbox()">${p}</button>`;
                }
            }
        }

        async function gmailViewEmail(emailId, folder) {
            document.getElementById('gmailReaderArea').style.display = 'block';
            document.getElementById('gmailReaderBody').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
            const { ok, status, data } = await safeApiFetch(`/email/${emailId}?folder=${folder || 'INBOX'}`);
            if (!ok) {
                document.getElementById('gmailReaderBody').innerHTML = status === 404
                    ? '<div class="text-warning">⚠️ Email backend not deployed yet.</div>'
                    : `<div class="text-danger">Error loading email: ${data.error}</div>`;
                return;
            }
            const em = data;
            gmailState.currentEmail = em;
            document.getElementById('gmailReaderSubject').textContent = em.subject || '(no subject)';
            document.getElementById('gmailReaderFrom').textContent = `From: ${em.from || 'Unknown'}`;
            document.getElementById('gmailReaderDate').textContent = em.date || '';
            const body = em.body_html || escapeHtml(em.body || 'No content');
            document.getElementById('gmailReaderBody').innerHTML = em.body_html ? body : `<pre style="white-space:pre-wrap">${body}</pre>`;
            // Mark as read
            safeApiFetch(`/mark-read/${emailId}`, { method: 'POST' });
            gmailLoadUnreadCount();
        }

        function gmailReplyTo() {
            if (!gmailState.currentEmail) return;
            const em = gmailState.currentEmail;
            const fromEmail = (em.from || '').match(/<([^>]+)>/);
            const to = fromEmail ? fromEmail[1] : em.from;
            gmailOpenCompose(to, 'Re: ' + (em.subject || ''), `\n\n--- Original Message ---\nFrom: ${em.from}\nDate: ${em.date}\n\n${em.body || ''}`);
        }

        async function gmailReplyToId(emailId, folder) {
            const { ok, data } = await safeApiFetch(`/email/${emailId}?folder=${decodeURIComponent(folder)}`);
            if (!ok) { alert('Could not load email for reply'); return; }
            const em = data;
            const fromEmail = (em.from || '').match(/<([^>]+)>/);
            const to = fromEmail ? fromEmail[1] : em.from;
            gmailOpenCompose(to, 'Re: ' + (em.subject || ''), `\n\n--- Original Message ---\nFrom: ${em.from}\nDate: ${em.date}\n\n${em.body || ''}`);
        }

        function gmailForwardEmail() {
            if (!gmailState.currentEmail) return;
            const em = gmailState.currentEmail;
            gmailOpenCompose('', 'Fwd: ' + (em.subject || ''), `\n\n--- Forwarded Message ---\nFrom: ${em.from}\nDate: ${em.date}\nSubject: ${em.subject}\n\n${em.body || ''}`);
        }

        async function gmailSendEmail(e) {
            e.preventDefault();
            const to = document.getElementById('gmailComposeTo').value;
            const cc = document.getElementById('gmailComposeCc').value;
            const bcc = document.getElementById('gmailComposeBcc').value;
            const subject = document.getElementById('gmailComposeSubject').value;
            const body = document.getElementById('gmailComposeBody').value;
            if (!to || !subject) { alert('Please fill in To and Subject fields'); return false; }
            const { ok, status, data } = await safeApiFetch('/send', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ to, cc: cc || undefined, bcc: bcc || undefined, subject, body })
            });
            if (ok && data.success) {
                alert('✅ Email sent successfully!');
                document.getElementById('gmailComposeForm').reset();
                gmailShowTab('inbox');
            } else if (status === 404) {
                alert('⚠️ Email backend not deployed yet. Please publish the Wix Velo code first.');
            } else {
                alert('❌ Failed to send: ' + (data.error || 'Unknown error'));
            }
            return false;
        }

        async function gmailDeleteEmail(emailId, folder) {
            if (!confirm('Move this email to Trash?')) return;
            const { ok, status, data } = await safeApiFetch(`/delete/${emailId}`, { method: 'DELETE' });
            if (!ok && status === 404) { alert('⚠️ Email backend not deployed yet.'); return; }
            gmailLoadInbox();
        }

        async function gmailSearchEmails() {
            const q = document.getElementById('gmailSearchQuery').value;
            if (!q) return;
            const results = document.getElementById('gmailSearchResults');
            results.innerHTML = '<div class="text-center"><i class="fas fa-spinner fa-spin me-2"></i>Searching...</div>';
            const { ok, status, data } = await safeApiFetch(`/search?q=${encodeURIComponent(q)}`);
            if (!ok) {
                results.innerHTML = status === 404
                    ? '<div class="admin-card text-warning">⚠️ Search unavailable — email backend not deployed yet.</div>'
                    : `<div class="admin-card text-danger">Search failed: ${data.error}</div>`;
                return;
            }
            if (!data.results || data.results.length === 0) {
                results.innerHTML = '<div class="admin-card text-muted">No results found</div>'; return;
            }
            results.innerHTML = '<div class="admin-card"><h5>Found ' + data.results.length + ' results</h5><div class="admin-table"><table><thead><tr><th>From</th><th>Subject</th><th>Date</th></tr></thead><tbody>' +
                data.results.map(em => `<tr style="cursor:pointer" onclick="gmailViewEmail('${em.id}','INBOX')"><td>${escapeHtml((em.from||'').substring(0,30))}</td><td>${escapeHtml((em.subject||'').substring(0,50))}</td><td>${em.date?new Date(em.date).toLocaleDateString():''}</td></tr>`).join('') +
                '</tbody></table></div></div>';
        }

        // === CONTACT GROUPS ===

        async function gmailLoadContactGroups() {
            const container = document.getElementById('gmailContactGroupsList');
            const { ok, status, data } = await safeApiFetch('/contacts');
            if (!ok) {
                const msg = status === 404
                    ? '<div class="admin-card" style="border-left:4px solid #ff9800;"><i class="fas fa-info-circle me-2 text-warning"></i>Contact groups will be available after the Wix Velo backend is published.</div>'
                    : `<div class="admin-card text-danger"><i class="fas fa-exclamation-circle me-2"></i>Error loading groups: ${data.error}</div>`;
                container.innerHTML = msg;
                document.getElementById('gmailStatGroups').textContent = '--'; return;
            }
            gmailState.contactGroups = data.groups || {};
            const groupNames = Object.keys(gmailState.contactGroups);
            document.getElementById('gmailStatGroups').textContent = groupNames.length;
            if (groupNames.length === 0) {
                container.innerHTML = '<div class="admin-card text-muted"><i class="fas fa-address-book me-2"></i>No contact groups yet. Click "New Group" to create one.</div>';
                return;
            }
                container.innerHTML = groupNames.map(name => {
                    const contacts = gmailState.contactGroups[name];
                    return `<div class="admin-card" style="border-left:4px solid var(--gold);">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <h5><i class="fas fa-users me-2"></i>${escapeHtml(name)} <span class="badge bg-primary">${contacts.length}</span></h5>
                            <div style="display:flex;gap:0.3rem;">
                                <button class="btn btn-sm btn-outline-primary" onclick="gmailShowAddContact('${escapeHtml(name)}')" title="Add contact"><i class="fas fa-user-plus"></i></button>
                                <button class="btn btn-sm btn-outline-success" onclick="gmailSendToGroup('${escapeHtml(name)}')" title="Send email to group"><i class="fas fa-paper-plane"></i></button>
                                <button class="btn btn-sm btn-outline-danger" onclick="gmailDeleteGroup('${escapeHtml(name)}')" title="Delete group"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        ${contacts.length > 0 ? '<div class="mt-2">' + contacts.map((c,i) =>
                            `<span class="badge bg-secondary me-1 mb-1" style="font-size:0.8rem;">${escapeHtml(c.name || c.email)} &lt;${escapeHtml(c.email)}&gt; <i class="fas fa-times ms-1" style="cursor:pointer" onclick="gmailRemoveFromGroup('${escapeHtml(name)}','${escapeHtml(c.email)}')"></i></span>`
                        ).join('') + '</div>' : '<p class="text-muted mb-0 mt-2">No contacts in this group</p>'}
                    </div>`;
                }).join('');
        }

        async function gmailCreateGroupPrompt() {
            const name = prompt('Enter group name (e.g., "EC Members", "All Members", "Volunteers"):');
            if (!name) return;
            const { ok, status, data } = await safeApiFetch('/contacts/group', {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ group_name: name })
            });
            if (ok && data.success) { alert('✅ Group "' + name + '" created!'); gmailLoadContactGroups(); }
            else if (status === 404) { alert('⚠️ Contact groups unavailable — email backend not deployed yet.'); }
            else { alert('❌ ' + (data.error || 'Failed to create group')); }
        }

        function gmailShowAddContact(groupName) {
            document.getElementById('gmailAddContactForm').style.display = 'block';
            document.getElementById('gmailAddContactGroupName').textContent = groupName;
            document.getElementById('gmailAddContactForm').dataset.group = groupName;
            document.getElementById('gmailAddContactName').value = '';
            document.getElementById('gmailAddContactEmail').value = '';
        }

        async function gmailAddContactToGroup() {
            const group = document.getElementById('gmailAddContactForm').dataset.group;
            const name = document.getElementById('gmailAddContactName').value;
            const email = document.getElementById('gmailAddContactEmail').value;
            if (!email) { alert('Email is required'); return; }
            const { ok, status, data } = await safeApiFetch(`/contacts/group/${encodeURIComponent(group)}/add`, {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contacts: [{ name: name || email, email }] })
            });
            if (ok && data.success) { gmailLoadContactGroups(); document.getElementById('gmailAddContactName').value = ''; document.getElementById('gmailAddContactEmail').value = ''; }
            else if (status === 404) { alert('⚠️ Email backend not deployed yet.'); }
            else { alert('❌ ' + (data.error || 'Failed')); }
        }

        async function gmailRemoveFromGroup(groupName, email) {
            if (!confirm(`Remove ${email} from "${groupName}"?`)) return;
            const { ok, status } = await safeApiFetch(`/contacts/group/${encodeURIComponent(groupName)}/remove`, {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ emails: [email] })
            });
            if (!ok && status === 404) { alert('⚠️ Email backend not deployed yet.'); return; }
            gmailLoadContactGroups();
        }

        async function gmailDeleteGroup(name) {
            if (!confirm(`Delete group "${name}" and all its contacts?`)) return;
            const { ok, status } = await safeApiFetch(`/contacts/group/${encodeURIComponent(name)}`, { method: 'DELETE' });
            if (!ok && status === 404) { alert('⚠️ Email backend not deployed yet.'); return; }
            gmailLoadContactGroups();
        }

        function gmailSendToGroup(groupName) {
            const contacts = gmailState.contactGroups[groupName] || [];
            if (contacts.length === 0) { alert('No contacts in this group'); return; }
            const emails = contacts.map(c => c.email).join(', ');
            gmailOpenCompose(emails, '', '');
        }

        /* ================================================================
         *  ENHANCED ADMIN SECTION LOADER
         * ================================================================ */
        (function patchShowAdminSection() {
            const orig = showAdminSection;
            showAdminSection = function(sectionId, clickedNav) {
                orig(sectionId, clickedNav);
                if (sectionId === 'evite') renderEviteHistory();
                if (sectionId === 'rsvps') renderRsvpDashboard();
                if (sectionId === 'gmail') { gmailCheckConnection(); gmailLoadInbox(); gmailLoadContactGroups(); }
            };
        })();

        /**
         * Run due diligence checks for member/admin workflows
         */
        function runDueDiligenceChecks(scope = 'all') {
            const results = [];
            const addCheck = (name, status, details) => results.push({ name, status, details });

            const memberSections = ['portalDashboard', 'portalProfile', 'portalFamily', 'portalPayments', 'portalBudget', 'portalMeetings', 'portalEvents', 'portalSurveys', 'portalDirectory', 'portalRadio', 'portalMagazine'];
            const adminSections = ['adminDashboard', 'adminMembers', 'adminPayments', 'adminEvents', 'adminRsvps', 'adminEvite', 'adminDataImport', 'adminDbExplorer', 'adminComplaints', 'adminSurveys', 'adminAnnouncements', 'adminRadio', 'adminMagazine', 'adminBudget', 'adminVendors', 'adminVolunteers', 'adminMeetings', 'adminGmail', 'adminCareers', 'adminSiteConfig'];

            if (scope === 'all' || scope === 'member') {
                addCheck('Member portal overlay', !!document.getElementById('memberPortalOverlay'), 'Member full-screen overlay available');
                addCheck('Member login modal', !!document.getElementById('memberPortalModal'), 'Member login modal available');

                const missingMemberSections = memberSections.filter(id => !document.getElementById(id));
                addCheck('Member portal sections', missingMemberSections.length === 0, missingMemberSections.length ? `Missing: ${missingMemberSections.join(', ')}` : 'All sections present');

                if (MemberPortal.member) {
                    const schemaCheck = validateMemberSchema(MemberPortal.member);
                    addCheck('Member schema validation', schemaCheck.valid, schemaCheck.valid ? 'Schema OK' : `Missing: ${schemaCheck.missing.join(', ')}`);
                } else {
                    addCheck('Member session', false, 'No member is logged in');
                }
            }

            if (scope === 'all' || scope === 'admin') {
                addCheck('Admin portal overlay', !!document.getElementById('adminPortalOverlay'), 'Admin full-screen overlay available');
                addCheck('Admin login modal', !!document.getElementById('adminLoginModal'), 'Admin login modal available');

                const missingAdminSections = adminSections.filter(id => !document.getElementById(id));
                addCheck('Admin portal sections', missingAdminSections.length === 0, missingAdminSections.length ? `Missing: ${missingAdminSections.join(', ')}` : 'All sections present');

                if (AdminPortal.admin) {
                    const schemaCheck = validateMemberSchema(AdminPortal.admin);
                    addCheck('Admin schema validation', schemaCheck.valid, schemaCheck.valid ? 'Schema OK' : `Missing: ${schemaCheck.missing.join(', ')}`);
                    addCheck('Admin role validation', AdminPortal.admin.isAdmin === true, AdminPortal.admin.isAdmin ? 'Admin role confirmed' : 'Admin role missing');
                } else {
                    addCheck('Admin session', false, 'No admin is logged in');
                }
            }

            const title = scope === 'member' ? 'Member System Check' : scope === 'admin' ? 'Admin System Check' : 'Full System Check';
            renderDiagnosticsResults(results, title);
            return results;
        }

        function renderDiagnosticsResults(results, title) {
            const container = document.getElementById('diagnosticsResults');
            const modalTitle = document.getElementById('diagnosticsModalLabel');
            if (!container || !modalTitle) {
                console.table(results);
                alert(`${title} complete. Check console for details.`);
                return;
            }

            modalTitle.textContent = title;
            const rows = results.map(result => {
                const statusClass = result.status ? 'success' : 'danger';
                const icon = result.status ? 'fa-check-circle' : 'fa-times-circle';
                const detail = result.details ? `<div class="small text-muted">${result.details}</div>` : '';
                return `
                    <div class="alert alert-${statusClass} mb-2">
                        <div class="d-flex align-items-center gap-2">
                            <i class="fas ${icon}"></i>
                            <strong>${result.name}</strong>
                        </div>
                        ${detail}
                    </div>
                `;
            }).join('');

            container.innerHTML = rows || '<div class="alert alert-info">No checks executed.</div>';
            const modal = new bootstrap.Modal(document.getElementById('diagnosticsModal'));
            modal.show();
        }
        
        /**
         * Handle profile form update
         */
        function handleProfileUpdate(event) {
            event.preventDefault();
            
            const formData = {
                firstName: document.getElementById('portalFirstName')?.value,
                lastName: document.getElementById('portalLastName')?.value,
                email: document.getElementById('portalEmail')?.value,
                phone: document.getElementById('portalPhone')?.value,
                address: document.getElementById('portalAddress')?.value,
                city: document.getElementById('portalCity')?.value,
                state: document.getElementById('portalState')?.value,
                zip: document.getElementById('portalZip')?.value
            };
            
            console.log('💾 Saving profile:', formData);
            
            // Update local member data
            if (MemberPortal.member) {
                MemberPortal.member = {
                    ...MemberPortal.member,
                    ...formData,
                    address: {
                        street: formData.address || MemberPortal.member.address?.street || '',
                        city: formData.city || MemberPortal.member.address?.city || '',
                        state: formData.state || MemberPortal.member.address?.state || '',
                        zip: formData.zip || MemberPortal.member.address?.zip || ''
                    }
                };
            }
            
            // Show success notification
            alert('✅ Profile updated successfully! (Demo Mode)');
        }
        
        /**
         * Handle event RSVP
         */
        function handleEventRSVP(eventName, response) {
            console.log('🎉 RSVP:', eventName, response);
            alert(`RSVP "${response}" recorded for ${eventName}! (Demo Mode)`);
        }
        
        /**
         * Handle song request
         */
        function handleSongRequest(event) {
            event.preventDefault();
            const song = document.getElementById('songTitle')?.value;
            const artist = document.getElementById('artistName')?.value;
            const dedication = document.getElementById('dedication')?.value;
            
            console.log('🎵 Song request:', { song, artist, dedication });
            alert(`Song request submitted: "${song}" by ${artist}! (Demo Mode)`);
            
            // Reset form
            event.target.reset();
        }
        
        /**
         * Handle magazine submission
         */
        function handleMagazineSubmission(event) {
            event.preventDefault();
            const title = document.getElementById('submissionTitle')?.value;
            const type = document.getElementById('submissionType')?.value;
            
            console.log('📝 Magazine submission:', { title, type });
            alert(`Submission "${title}" received! Our editorial team will review it. (Demo Mode)`);
            
            // Reset form
            event.target.reset();
        }
        
        /**
         * Helper: Capitalize first letter
         */
        function capitalizeFirst(str) {
            if (!str) return '';
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        /**
         * Handle Login - With Demo Mode Support
         */
        async function handleLogin(event) {
            event.preventDefault();
            
            const emailOrUsername = document.getElementById('loginEmail').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            
            console.log('🔐 Login attempt:', emailOrUsername, '| Password length:', password.length);
            
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Logging in...');
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // Check demo/test accounts first
            console.log('📋 Checking DemoData.testAccounts:', Object.keys(DemoData.testAccounts));
            const testAccount = DemoData.testAccounts[emailOrUsername];
            console.log('🔍 Found account:', testAccount ? 'YES' : 'NO');
            
            if (testAccount) {
                console.log('🔑 Password check:', testAccount.password, '===', password, '?', testAccount.password === password);
            }
            
            if (testAccount && testAccount.password === password) {
                MemberPortal.isLoggedIn = true;
                MemberPortal.member = normalizeMemberRecord(testAccount.member);
                
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i>Welcome back, ${testAccount.member.firstName}!
                    <br><small class="text-muted">(Demo Mode - All features are simulated)</small>`);
                
                updateProfileDisplay(MemberPortal.member);
                
                setTimeout(() => {
                    showFullPortal(MemberPortal.member);
                }, 1500);
                return false;
            }
            
            // Check dynamically registered demo accounts
            const dynamicAccount = Object.values(DemoData.pendingRegistrations).find(
                reg => reg.completed && (reg.username === emailOrUsername || reg.email.toLowerCase() === emailOrUsername) && reg.password === password
            );
            
            if (dynamicAccount) {
                MemberPortal.isLoggedIn = true;
                MemberPortal.member = normalizeMemberRecord(dynamicAccount.memberData);
                
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i>Welcome back, ${dynamicAccount.memberData.firstName}!
                    <br><small class="text-muted">(Demo Mode)</small>`);
                
                updateProfileDisplay(MemberPortal.member);
                
                setTimeout(() => {
                    showFullPortal(MemberPortal.member);
                }, 1500);
                return false;
            }
            
            // Demo mode - no backend needed
            // Show login failed with helpful demo credentials
            showStatusMessage('error', 
                `<i class="fas fa-exclamation-circle me-2"></i><strong>Login failed.</strong>
                <br><br>Try demo credentials:
                <br>Username: <code>member_test</code> | Password: <code>test</code>
                <br>Or: <code>admin_test</code> | Password: <code>admin</code>`);
            
            return false;
        }

        /**
         * Handle Sign Up - With Demo Mode Support
         */
        async function handleSignup(event) {
            event.preventDefault();
            
            const signupData = {
                firstName: document.getElementById('signupFirstName').value.trim(),
                lastName: document.getElementById('signupLastName').value.trim(),
                email: document.getElementById('signupEmail').value.trim(),
                phone: document.getElementById('signupPhone').value.trim()
            };
            
            // Validate
            if (!signupData.firstName || !signupData.lastName || !signupData.email) {
                showStatusMessage('error', '<i class="fas fa-exclamation-circle me-2"></i>Please fill in all required fields.');
                return false;
            }
            
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Verifying your membership fee payment...');
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 1200));
            
            // Demo mode - simulate successful payment verification
            const registrationCode = 'BANF' + (++DemoData.registrationCodeCounter);
            const registrationId = 'REG_' + Date.now();
            
            DemoData.pendingRegistrations[registrationId] = {
                id: registrationId,
                code: registrationCode,
                ...signupData,
                membershipType: 'Family',
                createdAt: new Date().toISOString(),
                completed: false
            };
            
            MemberPortal.registrationId = registrationId;
            
            showStatusMessage('success', 
                `<i class="fas fa-check-circle me-2"></i><strong>Payment verified!</strong>
                <br>Membership type: <strong>Family</strong>
                <br><br><span class="text-warning"><i class="fas fa-envelope me-1"></i>Your registration code: <strong>${registrationCode}</strong></span>
                <br><small class="text-muted">(Demo Mode - In production, this would be sent via email)</small>`);
            
            // Move to registration code step
            setTimeout(() => {
                showPortalTab('code');
                // Pre-fill the code in demo mode
                document.getElementById('registrationCode').value = registrationCode;
            }, 2500);
            
            return false;
        }

        /**
         * Handle Registration Code Verification - With Demo Mode Support
         */
        async function handleCodeVerification(event) {
            event.preventDefault();
            
            const code = document.getElementById('registrationCode').value.trim().toUpperCase();
            
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Verifying registration code...');
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // Find registration by code in demo data
            const registration = Object.values(DemoData.pendingRegistrations).find(reg => reg.code === code);
            
            if (registration) {
                document.getElementById('setupRegistrationId').value = registration.id;
                document.getElementById('setupRegistrationCode').value = code;
                document.getElementById('setupUsername').placeholder = registration.email + ' (or choose your own)';
                
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i><strong>Code verified!</strong>
                    <br>Welcome ${registration.firstName}! Please set up your account credentials.`);
                
                setTimeout(() => {
                    showPortalTab('setup');
                }, 1500);
                return false;
            }
            
            // Demo mode - invalid code
            showStatusMessage('error', 
                `<i class="fas fa-exclamation-circle me-2"></i><strong>Invalid registration code</strong>
                <br><small>Please sign up first to get a valid code.</small>
                <br><br><a href="#" onclick="showPortalTab('signup'); return false;" class="btn btn-sm btn-warning mt-2">Go to Sign Up</a>`);
            
            return false;
        }

        /**
         * Handle Account Setup - With Demo Mode Support
         */
        async function handleAccountSetup(event) {
            event.preventDefault();
            
            const password = document.getElementById('setupPassword').value;
            const confirmPassword = document.getElementById('setupConfirmPassword').value;
            const username = document.getElementById('setupUsername').value.trim();
            
            // Validate passwords match
            if (password !== confirmPassword) {
                showStatusMessage('error', '<i class="fas fa-exclamation-circle me-2"></i>Passwords do not match.');
                return false;
            }
            
            // Validate password strength
            if (password.length < 8) {
                showStatusMessage('error', '<i class="fas fa-exclamation-circle me-2"></i>Password must be at least 8 characters.');
                return false;
            }
            
            // Validate username
            if (!username) {
                showStatusMessage('error', '<i class="fas fa-exclamation-circle me-2"></i>Please choose a username.');
                return false;
            }
            
            const registrationId = document.getElementById('setupRegistrationId').value;
            
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Creating your account...');
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Demo mode - complete registration
            const registration = DemoData.pendingRegistrations[registrationId];
            if (registration) {
                registration.username = username.toLowerCase();
                registration.password = password;
                registration.completed = true;
                registration.memberData = {
                    id: 'MEMBER_' + Date.now(),
                    firstName: registration.firstName,
                    lastName: registration.lastName,
                    fullName: registration.firstName + ' ' + registration.lastName,
                    email: registration.email,
                    phone: registration.phone,
                    role: 'member',
                    roles: ['member'],
                    isAdmin: false,
                    membershipType: registration.membershipType,
                    memberSince: new Date().toISOString().split('T')[0],
                    expiresOn: '2026-12-31',
                    address: {
                        street: document.getElementById('setupAddress')?.value || '',
                        city: document.getElementById('setupCity')?.value || 'Jacksonville',
                        state: document.getElementById('setupState')?.value || 'FL',
                        zip: document.getElementById('setupZip')?.value || ''
                    }
                };
                
                MemberPortal.isLoggedIn = true;
                MemberPortal.member = normalizeMemberRecord(registration.memberData);
                
                showStatusMessage('success', 
                    `<i class="fas fa-party-horn me-2"></i><strong>Account created successfully!</strong>
                    <br>Welcome to BANF, ${registration.firstName}!
                    <br><br><small class="text-warning">Your login: <code>${username}</code> / your chosen password</small>
                    <br><small class="text-muted">(Demo Mode)</small>`);
                
                updateProfileDisplay(MemberPortal.member);
                
                setTimeout(() => {
                    showFullPortal(MemberPortal.member);
                }, 2500);
                
                return false;
            }
            
            // Demo mode - no registration found
            showStatusMessage('error', 
                '<i class="fas fa-exclamation-circle me-2"></i>Registration not found. Please start the sign-up process first.');
            
            return false;
        }

        /**
         * Handle Forgot Password - With Demo Mode Support
         */
        async function handleForgotPassword(event) {
            event.preventDefault();
            
            const email = document.getElementById('forgotEmail').value.trim();
            
            if (!email) {
                showStatusMessage('error', '<i class="fas fa-exclamation-circle me-2"></i>Please enter your email address.');
                return false;
            }
            
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Looking up your account...');
            
            // Simulate network delay
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Check demo accounts
            const demoAccount = Object.entries(DemoData.testAccounts).find(([key, acc]) => 
                acc.member.email.toLowerCase() === email.toLowerCase()
            );
            
            if (demoAccount) {
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i><strong>Account found!</strong>
                    <br><br>Username: <code>${demoAccount[0]}</code>
                    <br>Password: <code>${demoAccount[1].password}</code>
                    <br><br><small class="text-muted">(Demo Mode - In production, a reset link would be emailed)</small>`);
                return false;
            }
            
            // Check dynamically registered accounts
            const dynamicAccount = Object.values(DemoData.pendingRegistrations).find(
                reg => reg.completed && reg.email.toLowerCase() === email.toLowerCase()
            );
            
            if (dynamicAccount) {
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i><strong>Account found!</strong>
                    <br><br>Username: <code>${dynamicAccount.username}</code>
                    <br>Password: <em>(the password you set during sign-up)</em>
                    <br><br><small class="text-muted">(Demo Mode)</small>`);
                return false;
            }
            
            // Demo mode - account not found
            showStatusMessage('info', 
                `<i class="fas fa-info-circle me-2"></i>No account found with that email.
                <br><br><strong>Demo accounts:</strong>
                <br><code>member@test.com</code> or <code>admin@test.com</code>
                <br><br><a href="#" onclick="showPortalTab('signup'); return false;" class="text-warning">Sign up as new member</a>`);
            
            return false;
        }
        
        /**
         * Handle Forgot Username - Demo Mode
         */
        async function handleForgotUsername(event) {
            if (event) event.preventDefault();
            
            const email = document.getElementById('forgotEmail').value.trim();
            
            if (!email) {
                showStatusMessage('error', '<i class="fas fa-exclamation-circle me-2"></i>Please enter your email address first.');
                return false;
            }
            
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Looking up your username...');
            
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // Check demo accounts
            const demoAccount = Object.entries(DemoData.testAccounts).find(([key, acc]) => 
                acc.member.email.toLowerCase() === email.toLowerCase()
            );
            
            if (demoAccount) {
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i>Your username is: <code>${demoAccount[0]}</code>
                    <br><br><a href="#" onclick="showPortalTab('login'); return false;" class="btn btn-sm btn-warning mt-2">Go to Login</a>`);
                return false;
            }
            
            // Check dynamic accounts
            const dynamicAccount = Object.values(DemoData.pendingRegistrations).find(
                reg => reg.completed && reg.email.toLowerCase() === email.toLowerCase()
            );
            
            if (dynamicAccount) {
                showStatusMessage('success', 
                    `<i class="fas fa-check-circle me-2"></i>Your username is: <code>${dynamicAccount.username}</code>
                    <br><br><a href="#" onclick="showPortalTab('login'); return false;" class="btn btn-sm btn-warning mt-2">Go to Login</a>`);
                return false;
            }
            
            showStatusMessage('info', 
                `<i class="fas fa-info-circle me-2"></i>If an account exists with this email, your username has been sent.
                <br><br><small>No account? <a href="#" onclick="showPortalTab('signup'); return false;" class="text-warning">Sign up here</a></small>`);
            
            return false;
        }

        /**
         * Handle Logout
         */
        function handleLogout() {
            MemberPortal.isLoggedIn = false;
            MemberPortal.member = null;
            
            // Clear forms
            document.querySelectorAll('.portal-form input').forEach(input => {
                if (input.type !== 'hidden') input.value = '';
            });
            
            showStatusMessage('info', '<i class="fas fa-sign-out-alt me-2"></i>You have been logged out.');
            
            setTimeout(() => {
                showPortalTab('login');
            }, 1000);
        }

        /**
         * Resend Registration Code
         */
        async function resendRegistrationCode() {
            showStatusMessage('info', '<i class="fas fa-spinner fa-spin me-2"></i>Resending registration code...');
            
            // This would call the signup API again to resend code
            showStatusMessage('success', '<i class="fas fa-check-circle me-2"></i>Registration code has been resent. Please check your email.');
        }

        /**
         * Update Profile Display
         */
        function updateProfileDisplay(member) {
            if (!member) return;

            const normalized = normalizeMemberRecord(member);
            
            // Set initials
            const initials = (member.firstName?.charAt(0) || '') + (member.lastName?.charAt(0) || '');
            document.getElementById('profileInitials').textContent = initials.toUpperCase() || member.fullName?.charAt(0) || '?';
            
            // Set name
            document.getElementById('profileName').textContent = normalized.fullName || normalized.email;
            
            // Set role badge
            const roleEl = document.getElementById('profileRole');
            const roleLabel = ADMIN_ROLE_LABELS[normalized.roleNormalized] || normalized.role?.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase()) || 'Member';
            roleEl.textContent = roleLabel;
            roleEl.className = `badge ${getRoleBadgeClass(normalized.roleNormalized)}`;
        }

        /**
         * Show Profile Edit Form
         */
        function showProfileEdit() {
            // Navigate to Wix profile edit page or show edit form
            navigateToWixPage('member-profile');
        }

        /**
         * Toggle Password Visibility
         */
        function togglePasswordVisibility(inputId, button) {
            const input = document.getElementById(inputId);
            const icon = button.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        /**
         * Show Status Message
         */
        function showStatusMessage(type, message) {
            const el = document.getElementById('portalStatusMessage');
            
            let bgClass = 'alert-info';
            if (type === 'success') bgClass = 'alert-success';
            if (type === 'error') bgClass = 'alert-danger';
            if (type === 'warning') bgClass = 'alert-warning';
            
            el.className = `alert ${bgClass} mt-3`;
            el.innerHTML = message;
            el.style.display = 'block';
        }

        /**
         * Hide Status Message
         */
        function hideStatusMessage() {
            document.getElementById('portalStatusMessage').style.display = 'none';
        }

        // ========== PORTAL NAVIGATION FUNCTIONS ==========
        
        /**
         * Scroll to a specific section
         */
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        /**
         * Open Member Login Modal
         */
        function openMemberLoginModal() {
            // Use the same Bootstrap modal as openMemberPortal
            openMemberPortal('login');
        }
        
        /**
         * Open Admin Login Modal
         */
        function openAdminLoginModal() {
            if (AdminPortal.isLoggedIn && AdminPortal.admin) {
                showAdminPortal(AdminPortal.admin);
                return;
            }
            // Create admin login modal dynamically if it doesn't exist
            let adminModal = document.getElementById('adminLoginModal');
            if (!adminModal) {
                adminModal = document.createElement('div');
                adminModal.className = 'modal fade';
                adminModal.id = 'adminLoginModal';
                adminModal.setAttribute('tabindex', '-1');
                adminModal.innerHTML = `
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 2px solid var(--gold); border-radius: 20px;">
                            <div class="modal-header border-0" style="background: linear-gradient(135deg, #8B0000, #DC143C); border-radius: 18px 18px 0 0;">
                                <h5 class="modal-title text-white"><i class="fas fa-user-shield me-2"></i>Admin Portal Login</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body p-4">
                                <p class="text-light mb-4">EC Members Only - Please enter your admin credentials</p>
                                <form id="adminLoginForm" onsubmit="handleAdminLogin(event)">
                                    <div class="mb-3">
                                        <label class="form-label text-light">Email or Username</label>
                                        <input type="text" class="form-control" id="adminEmail" required 
                                               style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white;">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label text-light">Password</label>
                                        <input type="password" class="form-control" id="adminPassword" required
                                               style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white;">
                                    </div>
                                    <div id="adminLoginStatus" class="mb-3"></div>
                                    <button type="submit" class="btn w-100" style="background: linear-gradient(135deg, #8B0000, #DC143C); color: white; font-weight: 600;">
                                        <i class="fas fa-sign-in-alt me-2"></i>Login to Admin Portal
                                    </button>
                                </form>
                                <p class="text-muted small mt-3 mb-0"><i class="fas fa-lock me-1"></i>This portal is restricted to Executive Committee members only.</p>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(adminModal);
            }
            const modal = new bootstrap.Modal(adminModal);
            modal.show();
        }
        
        /**
         * Handle Admin Login Form Submission
         */
        function handleAdminLogin(event) {
            event.preventDefault();
            const email = document.getElementById('adminEmail').value.trim().toLowerCase();
            const password = document.getElementById('adminPassword').value;
            const statusDiv = document.getElementById('adminLoginStatus');
            
            // Show loading
            statusDiv.innerHTML = '<div class="text-info"><i class="fas fa-spinner fa-spin me-2"></i>Verifying credentials...</div>';
            
            setTimeout(() => {
                // Check DemoData.testAccounts for matching admin credentials
                const account = DemoData.testAccounts[email];
                
                if (account && account.password === password) {
                    const member = account.member;
                    // Verify this account has admin/EC privileges
                    if (member.isAdmin || member.role === 'ec_member' || (member.roles && member.roles.includes('ec_member'))) {
                        statusDiv.innerHTML = '<div class="alert alert-success"><i class="fas fa-check-circle me-2"></i>Welcome, ' + member.firstName + '! Opening Admin Portal...</div>';
                        setTimeout(() => {
                            showAdminPortal(member);
                        }, 800);
                        return;
                    } else {
                        statusDiv.innerHTML = '<div class="alert alert-warning"><i class="fas fa-exclamation-triangle me-2"></i>This account does not have admin privileges. EC members only.</div>';
                        return;
                    }
                }
                
                // Also check dynamic registrations with admin flag
                const dynamicAdmin = Object.values(DemoData.pendingRegistrations).find(
                    reg => reg.completed && (reg.username === email || (reg.email && reg.email.toLowerCase() === email)) && reg.password === password && reg.memberData && reg.memberData.isAdmin
                );
                
                if (dynamicAdmin) {
                    statusDiv.innerHTML = '<div class="alert alert-success"><i class="fas fa-check-circle me-2"></i>Welcome! Opening Admin Portal...</div>';
                    setTimeout(() => {
                        showAdminPortal(dynamicAdmin.memberData);
                    }, 800);
                    return;
                }
                
                // Login failed
                statusDiv.innerHTML = `<div class="alert alert-danger"><i class="fas fa-exclamation-circle me-2"></i><strong>Login failed.</strong><br><br>Try demo admin credentials:<br>Username: <code>admin_test</code> | Password: <code>admin</code></div>`;
            }, 800);
        }
        
        /**
         * Open Survey Section
         */
        function openSurveySection() {
            // Navigate to surveys
            scrollToSection('surveys');
        }
        
        /**
         * Open Anonymous Complaint Form
         */
        function openComplaintForm() {
            const modal = new bootstrap.Modal(document.getElementById('complaintModal'));
            modal.show();
        }

        /**
         * Open surveys modal and load active surveys
         */
        async function openSurveyModal() {
            const modal = new bootstrap.Modal(document.getElementById('surveyModal'));
            modal.show();
            await loadSurveys();
        }

        /**
         * Load active surveys from Wix API
         */
        async function loadSurveys() {
            const container = document.getElementById('surveyModalBody');
            if (!container) return;
            container.innerHTML = '<div class="text-muted">Loading surveys...</div>';

            try {
                const data = await fetchFromAPI(BANF_API.endpoints.surveys.active);
                const surveys = data?.surveys || data?.items || [];
                if (!surveys.length) {
                    throw new Error('No surveys from API');
                }

                container.innerHTML = surveys.map(survey => `
                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title">${survey.title || survey.name || 'Community Survey'}</h5>
                            <p class="card-text text-muted">${survey.description || 'Share your feedback with BANF.'}</p>
                            <button class="btn btn-sm" style="background: var(--gradient-green); color: #fff;" onclick="openMemberLoginModal()">
                                <i class="fas fa-vote-yea me-1"></i> Take Survey
                            </button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                container.innerHTML = `
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>Surveys will appear here when published. (Demo Mode)
                    </div>
                `;
            }
        }

        /**
         * Submit anonymous complaint to Wix API
         */
        async function submitComplaint(event) {
            event.preventDefault();
            const status = document.getElementById('complaintStatus');
            status.innerHTML = '<div class="text-info"><i class="fas fa-spinner fa-spin me-2"></i>Submitting...</div>';

            const payload = {
                category: document.getElementById('complaintCategory').value,
                subject: document.getElementById('complaintSubject').value,
                details: document.getElementById('complaintDetails').value
            };

            try {
                const response = await fetch(BANF_API.siteUrl + BANF_API.endpoints.complaints.submit, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) throw new Error('Submission failed');
                const data = await response.json();
                status.innerHTML = `<div class="alert alert-success"><i class="fas fa-check-circle me-2"></i>Complaint submitted. Reference: <strong>${data.code || data.id || 'BANF-REF'}</strong></div>`;
                document.getElementById('complaintForm').reset();
            } catch (error) {
                status.innerHTML = '<div class="alert alert-warning"><i class="fas fa-info-circle me-2"></i>Complaint submitted in demo mode. A reference code will be emailed.</div>';
            }
            return false;
        }

        /**
         * Open event details modal
         */
        function openEventDetails(title, date, location, notes) {
            const body = document.getElementById('eventDetailsBody');
            body.innerHTML = `
                <div>
                    <h4>${title}</h4>
                    <p class="text-muted mb-1"><i class="fas fa-calendar me-2"></i>${date}</p>
                    <p class="text-muted mb-1"><i class="fas fa-map-marker-alt me-2"></i>${location}</p>
                    <p class="mt-3">${notes}</p>
                </div>
            `;
            const modal = new bootstrap.Modal(document.getElementById('eventDetailsModal'));
            modal.show();
        }

        // ========== WIX EMBED INTEGRATION ==========
        
        /**
         * Detect if running in Wix iframe
         */
        function isWixEmbed() {
            try {
                return window.self !== window.top;
            } catch (e) {
                return true; // Blocked by CORS = we're in an iframe
            }
        }

        /**
         * Calculate actual document height including all content
         */
        function getDocumentHeight() {
            const body = document.body;
            const html = document.documentElement;
            
            // Get the maximum of all possible height values
            const height = Math.max(
                body.scrollHeight,
                body.offsetHeight,
                html.clientHeight,
                html.scrollHeight,
                html.offsetHeight
            );
            
            // Add some padding to ensure no content is cut off
            return height + 100;
        }

        /**
         * Send height to parent Wix page for auto-resize
         */
        function sendHeightToWix() {
            const height = getDocumentHeight();
            
            // Send to all possible parent origins
            const origins = ['*', 'https://www.jaxbengali.org', 'https://banfwix.wixsite.com'];
            origins.forEach(origin => {
                try {
                    window.parent.postMessage({
                        type: 'BANF_EMBED_HEIGHT',
                        height: height
                    }, origin);
                    
                    // Also send Wix-specific message format
                    window.parent.postMessage({
                        type: 'set-height',
                        data: height
                    }, origin);
                    
                    // Wix HtmlComponent message format
                    window.parent.postMessage(JSON.stringify({
                        height: height,
                        type: 'ready'
                    }), origin);
                } catch (e) {
                    console.log('[BANF] PostMessage error:', e);
                }
            });
            
            console.log('[BANF Embed] Sent height:', height);
        }

        /* ================================================================
         *  CAREERS & PROFESSIONAL NETWORK (Feature 6)
         *  LinkedIn-style member expertise directory
         * ================================================================ */

        const CAREER_PROFILES = [
            {
                memberId: 'BANF-2024-001', name: 'Dr. Ranadhir Ghosh', title: 'Software Architect',
                company: 'Fortune 500 Tech Company', industry: 'Technology', yearsExperience: 20,
                skills: ['Software Architecture', 'Cloud Computing', 'AI/ML', 'Python', 'Team Leadership'],
                guidanceOffered: ['Career Mentorship', 'Resume Review', 'Interview Prep'],
                education: 'Ph.D. Computer Science',
                linkedinUrl: '', bio: 'Passionate about helping the next generation of Bengali-American technologists succeed in their careers.',
                photoPath: 'assets/ec-photos/president/ranadhir-ghosh.jpg',
                availableForMeeting: true, isVisible: true
            },
            {
                memberId: 'BANF-2024-002', name: 'Suchismita Chandak', title: 'Senior Data Scientist',
                company: 'Healthcare Analytics Corp', industry: 'Healthcare', yearsExperience: 12,
                skills: ['Data Science', 'Machine Learning', 'Statistics', 'R', 'Clinical Research'],
                guidanceOffered: ['Career Mentorship', 'Industry Insights'],
                education: 'M.S. Biostatistics',
                linkedinUrl: '', bio: 'Helping aspiring data professionals navigate the healthcare analytics landscape.',
                photoPath: '', availableForMeeting: true, isVisible: true
            },
            {
                memberId: 'BANF-2024-003', name: 'Amitava Roy', title: 'Financial Advisor',
                company: 'RBC Wealth Management', industry: 'Finance', yearsExperience: 15,
                skills: ['Financial Planning', 'Investment Strategy', 'Tax Planning', 'Retirement Planning'],
                guidanceOffered: ['Career Mentorship', 'Networking', 'Industry Insights'],
                education: 'MBA Finance, CFA',
                linkedinUrl: '', bio: 'Available to mentor young professionals interested in finance and wealth management.',
                photoPath: '', availableForMeeting: true, isVisible: true
            },
            {
                memberId: 'BANF-2024-004', name: 'Priyanka Sen', title: 'Civil Engineer, PE',
                company: 'State DOT', industry: 'Engineering', yearsExperience: 10,
                skills: ['Structural Engineering', 'Project Management', 'AutoCAD', 'PE License Prep'],
                guidanceOffered: ['Career Mentorship', 'Interview Prep', 'Industry Insights'],
                education: 'M.S. Civil Engineering',
                linkedinUrl: '', bio: 'Happy to guide engineers through the PE licensing process and government career paths.',
                photoPath: '', availableForMeeting: false, isVisible: true
            },
            {
                memberId: 'BANF-2024-005', name: 'Dr. Shreya Mukherjee', title: 'Pediatrician',
                company: 'Children\'s Hospital', industry: 'Healthcare', yearsExperience: 8,
                skills: ['Pediatric Medicine', 'USMLE Prep', 'Residency Applications', 'Clinical Skills'],
                guidanceOffered: ['Career Mentorship', 'Resume Review', 'Interview Prep'],
                education: 'MD, Board Certified Pediatrics',
                linkedinUrl: '', bio: 'Mentoring pre-med students and IMGs navigating the US medical system.',
                photoPath: '', availableForMeeting: true, isVisible: true
            },
            {
                memberId: 'BANF-2024-006', name: 'Debanjan Gupta', title: 'Immigration Attorney',
                company: 'Gupta Law Group', industry: 'Legal', yearsExperience: 14,
                skills: ['Immigration Law', 'H1B/Green Card', 'Business Law', 'Contract Review'],
                guidanceOffered: ['Industry Insights', 'Networking'],
                education: 'J.D., Bar Admitted',
                linkedinUrl: '', bio: 'Offering guidance on legal career paths and immigration-related professional questions.',
                photoPath: '', availableForMeeting: true, isVisible: true
            }
        ];

        /**
         * Render career cards on landing page
         */
        function renderCareerCards() {
            const grid = document.getElementById('careerCardGrid');
            if (!grid) return;

            const searchVal = (document.getElementById('careerSearch')?.value || '').toLowerCase();
            const industryVal = document.getElementById('industryFilter')?.value || '';
            const guidanceVal = document.getElementById('guidanceFilter')?.value || '';

            const filtered = CAREER_PROFILES.filter(p => {
                if (!p.isVisible) return false;
                if (industryVal && p.industry !== industryVal) return false;
                if (guidanceVal && !p.guidanceOffered.includes(guidanceVal)) return false;
                if (searchVal) {
                    const haystack = [p.name, p.title, p.company, p.industry, ...p.skills, ...p.guidanceOffered].join(' ').toLowerCase();
                    if (!haystack.includes(searchVal)) return false;
                }
                return true;
            });

            if (filtered.length === 0) {
                grid.innerHTML = '<div class="col-12 text-center py-5 text-muted"><i class="fas fa-search fa-3x mb-3 d-block"></i>No career profiles match your search criteria.</div>';
                return;
            }

            grid.innerHTML = filtered.map(p => {
                const initials = p.name.split(' ').map(w => w[0]).join('').substring(0, 2);
                const avatarBg = p.photoPath
                    ? `<img src="${p.photoPath}" alt="${p.name}" style="width:100%;height:100%;object-fit:cover;border-radius:50%;">`
                    : `<span style="font-size:1.4rem;font-weight:700;color:#fff;">${initials}</span>`;
                const avatarStyle = p.photoPath ? '' : 'background:var(--gradient-hero);display:flex;align-items:center;justify-content:center;';

                return `
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100 shadow-sm border-0" style="border-radius:14px;overflow:hidden;transition:transform 0.2s;">
                        <div class="card-body p-4">
                            <div class="d-flex align-items-center mb-3">
                                <div style="width:56px;height:56px;border-radius:50%;overflow:hidden;flex-shrink:0;${avatarStyle}">${avatarBg}</div>
                                <div class="ms-3">
                                    <h6 class="mb-0 fw-bold">${p.name}</h6>
                                    <small class="text-muted">${p.title}</small><br>
                                    <small class="text-muted"><i class="fas fa-building me-1"></i>${p.company}</small>
                                </div>
                            </div>
                            <div class="mb-2">
                                <span class="badge bg-primary bg-opacity-10 text-primary me-1"><i class="fas fa-industry me-1"></i>${p.industry}</span>
                                <span class="badge bg-secondary bg-opacity-10 text-secondary">${p.yearsExperience}+ yrs</span>
                                ${p.availableForMeeting ? '<span class=\"badge bg-success bg-opacity-10 text-success ms-1\"><i class=\"fas fa-check-circle me-1\"></i>Available</span>' : ''}
                            </div>
                            <p class="small text-muted mb-2" style="min-height:40px;">${p.bio.substring(0, 120)}${p.bio.length > 120 ? '...' : ''}</p>
                            <div class="mb-2">${p.skills.slice(0, 4).map(s => '<span class=\"badge bg-light text-dark border me-1 mb-1\" style=\"font-size:0.7rem;\">' + s + '</span>').join('')}</div>
                            <div class="mb-3">${p.guidanceOffered.map(g => '<span class=\"badge\" style=\"background:#fff3cd;color:#856404;font-size:0.7rem;margin-right:4px;\">' + g + '</span>').join('')}</div>
                            <div class="d-flex gap-2">
                                ${p.linkedinUrl ? '<a href=\"' + p.linkedinUrl + '\" target=\"_blank\" class=\"btn btn-sm btn-outline-primary\"><i class=\"fab fa-linkedin me-1\"></i>LinkedIn</a>' : ''}
                                <button class="btn btn-sm btn-outline-secondary" onclick="alert('Contact feature coming soon — please use Member Directory for now.')"><i class="fas fa-envelope me-1"></i>Connect</button>
                            </div>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }

        /**
         * Save career profile from member portal
         */
        function saveMyCareerProfile() {
            const profile = {
                memberId: 'BANF-SELF-' + Date.now(),
                name: document.getElementById('portalUserName')?.textContent || 'Member',
                title: document.getElementById('careerTitle')?.value || '',
                company: document.getElementById('careerCompany')?.value || '',
                industry: document.getElementById('careerIndustry')?.value || '',
                yearsExperience: parseInt(document.getElementById('careerYears')?.value) || 0,
                skills: (document.getElementById('careerSkills')?.value || '').split(',').map(s => s.trim()).filter(Boolean),
                guidanceOffered: [...document.querySelectorAll('#guidanceCheckboxes input:checked')].map(cb => cb.value),
                education: document.getElementById('careerEducation')?.value || '',
                linkedinUrl: document.getElementById('careerLinkedin')?.value || '',
                bio: document.getElementById('careerBio')?.value || '',
                photoPath: '',
                availableForMeeting: document.getElementById('careerAvailable')?.checked ?? true,
                isVisible: document.getElementById('careerProfileVisible')?.checked ?? true
            };

            // Check if profile already exists for this member
            const existingIdx = CAREER_PROFILES.findIndex(p => p.name === profile.name);
            if (existingIdx >= 0) {
                CAREER_PROFILES[existingIdx] = { ...CAREER_PROFILES[existingIdx], ...profile };
            } else {
                CAREER_PROFILES.push(profile);
            }

            renderCareerCards();
            renderAdminCareerTable();
            alert('✅ Career profile saved successfully!');
        }

        /**
         * Delete own career profile from member portal
         */
        function deleteMyCareerProfile() {
            if (!confirm('Remove your career profile from the directory?')) return;
            const name = document.getElementById('portalUserName')?.textContent || '';
            const idx = CAREER_PROFILES.findIndex(p => p.name === name);
            if (idx >= 0) {
                CAREER_PROFILES.splice(idx, 1);
                renderCareerCards();
                renderAdminCareerTable();
                alert('Profile removed.');
            }
        }

        /**
         * Render admin career directory table
         */
        function renderAdminCareerTable() {
            const tbody = document.getElementById('adminCareerTableBody');
            if (!tbody) return;

            // Update stats
            const el = id => document.getElementById(id);
            if (el('careerTotalStat'))   el('careerTotalStat').textContent = CAREER_PROFILES.length;
            if (el('careerVisibleStat')) el('careerVisibleStat').textContent = CAREER_PROFILES.filter(p => p.isVisible).length;
            if (el('careerHiddenStat'))  el('careerHiddenStat').textContent = CAREER_PROFILES.filter(p => !p.isVisible).length;
            if (el('careerIndustryStat')) el('careerIndustryStat').textContent = new Set(CAREER_PROFILES.map(p => p.industry)).size;

            if (CAREER_PROFILES.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted py-3">No career profiles yet.</td></tr>';
                return;
            }

            tbody.innerHTML = CAREER_PROFILES.map((p, i) => `
                <tr>
                    <td><strong>${p.name}</strong></td>
                    <td>${p.title}</td>
                    <td><span class="badge bg-primary bg-opacity-10 text-primary">${p.industry}</span></td>
                    <td>${p.guidanceOffered.map(g => '<span class=\"badge bg-warning bg-opacity-25 text-dark me-1\">' + g + '</span>').join('')}</td>
                    <td>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" ${p.isVisible ? 'checked' : ''} onchange="toggleCareerVisibility(${i}, this.checked)">
                        </div>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-outline-danger" onclick="removeCareerProfile(${i})"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
            `).join('');
        }

        function toggleCareerVisibility(index, visible) {
            if (CAREER_PROFILES[index]) {
                CAREER_PROFILES[index].isVisible = visible;
                renderCareerCards();
            }
        }

        function removeCareerProfile(index) {
            if (!confirm('Remove this career profile?')) return;
            CAREER_PROFILES.splice(index, 1);
            renderAdminCareerTable();
            renderCareerCards();
        }

        function openAddCareerModal() {
            const name = prompt('Member name:');
            if (!name) return;
            const title = prompt('Professional title:');
            const industry = prompt('Industry (Technology, Healthcare, Finance, Education, Engineering, Legal, Business):');
            CAREER_PROFILES.push({
                memberId: 'BANF-ADMIN-' + Date.now(), name, title: title || '',
                company: '', industry: industry || 'Technology', yearsExperience: 0,
                skills: [], guidanceOffered: ['Career Mentorship'],
                education: '', linkedinUrl: '', bio: '',
                photoPath: '', availableForMeeting: true, isVisible: true
            });
            renderAdminCareerTable();
            renderCareerCards();
        }

        function exportCareerDirectory() {
            const headers = ['Name', 'Title', 'Company', 'Industry', 'Years', 'Skills', 'Guidance', 'Education', 'LinkedIn', 'Visible'];
            const rows = CAREER_PROFILES.map(p => [
                p.name, p.title, p.company, p.industry, p.yearsExperience,
                p.skills.join('; '), p.guidanceOffered.join('; '),
                p.education, p.linkedinUrl, p.isVisible ? 'Yes' : 'No'
            ]);
            const csv = [headers, ...rows].map(r => r.map(c => '"' + String(c).replace(/"/g, '""') + '"').join(',')).join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'BANF_Career_Directory.csv';
            a.click();
        }

        /**
         * ========== SITE CONFIGURATION MANAGER (Feature 1) ==========
         * Manages section visibility, membership fees, sponsorship tiers, and ad slots
         */
        const SiteConfigManager = {
            config: null,

            defaultConfig: {
                sectionVisibility: {
                    about:       true,  // President's Message
                    'ec-team':   true,  // EC Team
                    services:    true,  // Services Portal
                    events:      true,  // Events Calendar
                    radio:       true,  // Radio Player
                    guide:       true,  // Jacksonville Guide
                    surveys:     true,  // Surveys & Complaints
                    magazine:    true,  // E-Magazine
                    sponsors:    true,  // Sponsorship Tiers
                    'admin-ads': true,  // Ad Slots
                    membership:  true,  // Membership Plans
                    photos:      true,  // Photo Gallery
                    contact:     true   // Contact Section
                },
                membershipPlans: [
                    { id: 'plan_1', name: 'Individual', amount: 50,  period: 'Annual',   active: true },
                    { id: 'plan_2', name: 'Family',     amount: 100, period: 'Annual',   active: true },
                    { id: 'plan_3', name: 'Lifetime',   amount: 500, period: 'One-time', active: true }
                ],
                sponsorshipTiers: [
                    { id: 'tier_1', name: 'Community', amount: 250,  benefits: 'Name listed on website',               active: true },
                    { id: 'tier_2', name: 'Silver',    amount: 500,  benefits: 'Logo on website, 2 event tickets',      active: true },
                    { id: 'tier_3', name: 'Gold',      amount: 1000, benefits: 'Logo + 4 event tickets + newsletter',   active: true },
                    { id: 'tier_4', name: 'Title',     amount: 2500, benefits: 'Title sponsor, banner, 6 tickets',      active: true }
                ],
                adSlots: [
                    { id: 'slot_1', slot: 1, flierUrl: '', businessName: '', amount: 200, yearStart: '2026-01', yearEnd: '2026-12', active: true },
                    { id: 'slot_2', slot: 2, flierUrl: '', businessName: '', amount: 200, yearStart: '2026-01', yearEnd: '2026-12', active: true },
                    { id: 'slot_3', slot: 3, flierUrl: '', businessName: '', amount: 200, yearStart: '2026-01', yearEnd: '2026-12', active: true }
                ]
            },

            load: function() {
                try {
                    const saved = localStorage.getItem('banf_site_config');
                    this.config = saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(this.defaultConfig));
                } catch(e) {
                    console.warn('[SiteConfig] Failed to load, using defaults:', e);
                    this.config = JSON.parse(JSON.stringify(this.defaultConfig));
                }
                return this.config;
            },

            save: function() {
                try {
                    localStorage.setItem('banf_site_config', JSON.stringify(this.config));
                    console.log('[SiteConfig] Configuration saved');
                    this.applySectionVisibility();
                    this.showToast('Configuration saved successfully!', 'success');
                } catch(e) {
                    console.error('[SiteConfig] Failed to save:', e);
                    this.showToast('Failed to save configuration', 'error');
                }
            },

            reset: function() {
                this.config = JSON.parse(JSON.stringify(this.defaultConfig));
                localStorage.removeItem('banf_site_config');
                this.applySectionVisibility();
                this.renderConfigPanel();
                this.showToast('Configuration reset to defaults', 'info');
            },

            applySectionVisibility: function() {
                if (!this.config) this.load();
                const vis = this.config.sectionVisibility;
                Object.entries(vis).forEach(([sectionId, visible]) => {
                    const el = document.getElementById(sectionId);
                    if (el) {
                        el.style.display = visible ? '' : 'none';
                    }
                });
                console.log('[SiteConfig] Section visibility applied');
            },

            renderConfigPanel: function() {
                const container = document.getElementById('siteConfigContent');
                if (!container) return;
                if (!this.config) this.load();

                const sectionLabels = {
                    about:       "President's Message",
                    'ec-team':   'EC Team',
                    services:    'Services Portal',
                    events:      'Events Calendar',
                    radio:       'Radio Player',
                    guide:       'Jacksonville Guide',
                    surveys:     'Surveys & Complaints',
                    magazine:    'E-Magazine',
                    sponsors:    'Sponsorship Tiers',
                    'admin-ads': 'Ad Slots',
                    membership:  'Membership Plans',
                    photos:      'Photo Gallery',
                    contact:     'Contact Section'
                };

                container.innerHTML = `
                    <!-- Section Visibility -->
                    <div class="admin-card mb-4">
                        <div class="admin-card-header">
                            <div class="admin-card-icon" style="background:rgba(99,102,241,0.1);color:#6366F1"><i class="fas fa-eye"></i></div>
                            <div><h4>Section Visibility</h4><small class="text-muted">Show or hide landing page sections</small></div>
                        </div>
                        <div class="row g-2 mt-2">
                            ${Object.entries(sectionLabels).map(([id, label]) => `
                                <div class="col-md-4 col-6">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="vis_${id}" ${this.config.sectionVisibility[id] ? 'checked' : ''} onchange="SiteConfigManager.toggleSection('${id}', this.checked)">
                                        <label class="form-check-label" for="vis_${id}">${label}</label>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Membership Plans -->
                    <div class="admin-card mb-4">
                        <div class="admin-card-header">
                            <div class="admin-card-icon" style="background:rgba(16,185,129,0.1);color:#10B981"><i class="fas fa-id-card"></i></div>
                            <div><h4>Membership Plans</h4><small class="text-muted">Manage membership tiers and pricing</small></div>
                        </div>
                        <div class="table-responsive mt-2">
                            <table class="table table-sm table-hover mb-0">
                                <thead><tr><th>Plan</th><th>Amount</th><th>Period</th><th>Active</th><th></th></tr></thead>
                                <tbody id="membershipPlanRows">
                                    ${this.config.membershipPlans.map((p, i) => `
                                        <tr>
                                            <td><input class="form-control form-control-sm" value="${p.name}" onchange="SiteConfigManager.config.membershipPlans[${i}].name=this.value"></td>
                                            <td><div class="input-group input-group-sm"><span class="input-group-text">$</span><input type="number" class="form-control" value="${p.amount}" onchange="SiteConfigManager.config.membershipPlans[${i}].amount=parseInt(this.value)"></div></td>
                                            <td><select class="form-select form-select-sm" onchange="SiteConfigManager.config.membershipPlans[${i}].period=this.value"><option ${p.period==='Annual'?'selected':''}>Annual</option><option ${p.period==='One-time'?'selected':''}>One-time</option><option ${p.period==='Monthly'?'selected':''}>Monthly</option></select></td>
                                            <td><input type="checkbox" class="form-check-input" ${p.active?'checked':''} onchange="SiteConfigManager.config.membershipPlans[${i}].active=this.checked"></td>
                                            <td><button class="btn btn-sm btn-outline-danger" onclick="SiteConfigManager.removePlan(${i})" title="Remove"><i class="fas fa-trash-alt"></i></button></td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <button class="btn btn-sm btn-outline-success mt-2" onclick="SiteConfigManager.addPlan()"><i class="fas fa-plus me-1"></i>Add Plan</button>
                    </div>

                    <!-- Sponsorship Tiers -->
                    <div class="admin-card mb-4">
                        <div class="admin-card-header">
                            <div class="admin-card-icon" style="background:rgba(245,158,11,0.1);color:#F59E0B"><i class="fas fa-handshake"></i></div>
                            <div><h4>Sponsorship Tiers</h4><small class="text-muted">Manage sponsorship levels and benefits</small></div>
                        </div>
                        <div class="table-responsive mt-2">
                            <table class="table table-sm table-hover mb-0">
                                <thead><tr><th>Tier</th><th>Amount</th><th>Benefits</th><th>Active</th><th></th></tr></thead>
                                <tbody id="sponsorshipTierRows">
                                    ${this.config.sponsorshipTiers.map((t, i) => `
                                        <tr>
                                            <td><input class="form-control form-control-sm" value="${t.name}" onchange="SiteConfigManager.config.sponsorshipTiers[${i}].name=this.value"></td>
                                            <td><div class="input-group input-group-sm"><span class="input-group-text">$</span><input type="number" class="form-control" value="${t.amount}" onchange="SiteConfigManager.config.sponsorshipTiers[${i}].amount=parseInt(this.value)"></div></td>
                                            <td><input class="form-control form-control-sm" value="${t.benefits}" onchange="SiteConfigManager.config.sponsorshipTiers[${i}].benefits=this.value"></td>
                                            <td><input type="checkbox" class="form-check-input" ${t.active?'checked':''} onchange="SiteConfigManager.config.sponsorshipTiers[${i}].active=this.checked"></td>
                                            <td><button class="btn btn-sm btn-outline-danger" onclick="SiteConfigManager.removeTier(${i})" title="Remove"><i class="fas fa-trash-alt"></i></button></td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <button class="btn btn-sm btn-outline-success mt-2" onclick="SiteConfigManager.addTier()"><i class="fas fa-plus me-1"></i>Add Tier</button>
                    </div>

                    <!-- Ad Slots -->
                    <div class="admin-card mb-4">
                        <div class="admin-card-header">
                            <div class="admin-card-icon" style="background:rgba(239,68,68,0.1);color:#EF4444"><i class="fas fa-ad"></i></div>
                            <div><h4>Ad Slots</h4><small class="text-muted">Manage advertisement slots and fliers</small></div>
                        </div>
                        <div class="table-responsive mt-2">
                            <table class="table table-sm table-hover mb-0">
                                <thead><tr><th>Slot</th><th>Business</th><th>Amount</th><th>Start</th><th>End</th><th>Active</th><th></th></tr></thead>
                                <tbody id="adSlotRows">
                                    ${this.config.adSlots.map((a, i) => `
                                        <tr>
                                            <td class="text-center">${a.slot}</td>
                                            <td><input class="form-control form-control-sm" value="${a.businessName}" placeholder="Business name" onchange="SiteConfigManager.config.adSlots[${i}].businessName=this.value"></td>
                                            <td><div class="input-group input-group-sm"><span class="input-group-text">$</span><input type="number" class="form-control" value="${a.amount}" onchange="SiteConfigManager.config.adSlots[${i}].amount=parseInt(this.value)"></div></td>
                                            <td><input type="month" class="form-control form-control-sm" value="${a.yearStart}" onchange="SiteConfigManager.config.adSlots[${i}].yearStart=this.value"></td>
                                            <td><input type="month" class="form-control form-control-sm" value="${a.yearEnd}" onchange="SiteConfigManager.config.adSlots[${i}].yearEnd=this.value"></td>
                                            <td><input type="checkbox" class="form-check-input" ${a.active?'checked':''} onchange="SiteConfigManager.config.adSlots[${i}].active=this.checked"></td>
                                            <td><button class="btn btn-sm btn-outline-danger" onclick="SiteConfigManager.removeAdSlot(${i})" title="Remove"><i class="fas fa-trash-alt"></i></button></td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <button class="btn btn-sm btn-outline-success mt-2" onclick="SiteConfigManager.addAdSlot()"><i class="fas fa-plus me-1"></i>Add Slot</button>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex gap-2 mt-3">
                        <button class="admin-primary" onclick="SiteConfigManager.save()"><i class="fas fa-save me-1"></i>Save Configuration</button>
                        <button class="admin-secondary" onclick="SiteConfigManager.reset()"><i class="fas fa-undo me-1"></i>Reset to Defaults</button>
                    </div>
                `;
            },

            toggleSection: function(sectionId, visible) {
                this.config.sectionVisibility[sectionId] = visible;
            },

            addPlan: function() {
                const id = 'plan_' + Date.now();
                this.config.membershipPlans.push({ id, name: 'New Plan', amount: 0, period: 'Annual', active: true });
                this.renderConfigPanel();
            },
            removePlan: function(idx) {
                this.config.membershipPlans.splice(idx, 1);
                this.renderConfigPanel();
            },

            addTier: function() {
                const id = 'tier_' + Date.now();
                this.config.sponsorshipTiers.push({ id, name: 'New Tier', amount: 0, benefits: '', active: true });
                this.renderConfigPanel();
            },
            removeTier: function(idx) {
                this.config.sponsorshipTiers.splice(idx, 1);
                this.renderConfigPanel();
            },

            addAdSlot: function() {
                const nextSlot = this.config.adSlots.length + 1;
                const id = 'slot_' + Date.now();
                this.config.adSlots.push({ id, slot: nextSlot, flierUrl: '', businessName: '', amount: 200, yearStart: '2026-01', yearEnd: '2026-12', active: true });
                this.renderConfigPanel();
            },
            removeAdSlot: function(idx) {
                this.config.adSlots.splice(idx, 1);
                // Re-number slots
                this.config.adSlots.forEach((a, i) => a.slot = i + 1);
                this.renderConfigPanel();
            },

            showToast: function(message, type) {
                const colors = { success: '#10B981', error: '#EF4444', info: '#3B82F6' };
                const icons  = { success: 'check-circle', error: 'exclamation-circle', info: 'info-circle' };
                const toast = document.createElement('div');
                toast.style.cssText = 'position:fixed;top:20px;right:20px;z-index:100000;padding:12px 24px;border-radius:8px;color:#fff;font-weight:500;display:flex;align-items:center;gap:8px;box-shadow:0 4px 12px rgba(0,0,0,0.3);animation:slideInRight 0.3s ease;';
                toast.style.background = colors[type] || colors.info;
                toast.innerHTML = `<i class="fas fa-${icons[type] || icons.info}"></i> ${message}`;
                document.body.appendChild(toast);
                setTimeout(() => { toast.style.opacity = '0'; toast.style.transition = 'opacity 0.3s'; setTimeout(() => toast.remove(), 300); }, 3000);
            }
        };

        /**
         * ========== ADMIN ADVERTISEMENT MANAGEMENT ==========
         */
        
        // Store ad configurations (loaded from Wix CMS or backend)
        const AdManager = {
            ads: [],
            isAdmin: false,
            
            /**
             * Initialize ad system
             */
            init: function() {
                // Check if user is admin (message from Wix parent)
                window.addEventListener('message', (event) => {
                    if (event.data && event.data.type === 'ADMIN_STATUS') {
                        this.isAdmin = event.data.isAdmin;
                        this.updateAdminControls();
                    }
                    if (event.data && event.data.type === 'AD_DATA') {
                        this.ads = event.data.ads;
                        this.renderAds();
                    }
                });
                
                // Request admin status from Wix parent
                if (window.parent !== window) {
                    window.parent.postMessage({ type: 'GET_ADMIN_STATUS' }, '*');
                    window.parent.postMessage({ type: 'GET_ADS' }, '*');
                }
            },
            
            /**
             * Show/hide admin controls based on user role
             */
            updateAdminControls: function() {
                const adminControls = document.getElementById('ad-admin-controls');
                if (adminControls) {
                    adminControls.style.display = this.isAdmin ? 'block' : 'none';
                }
            },
            
            /**
             * Render ads from CMS data
             */
            renderAds: function() {
                const container = document.getElementById('ad-carousel-container');
                if (!container || !this.ads.length) return;
                
                // Clear existing ads
                container.innerHTML = '';
                
                this.ads.forEach((ad, index) => {
                    const adHtml = `
                        <div class="col-md-4" data-ad-slot="${index + 1}" data-ad-id="${ad.id}">
                            <div class="ad-card h-100 p-4 rounded-4 text-center shadow" style="${ad.style}">
                                <div class="ad-content">
                                    ${ad.icon ? `<i class="${ad.icon} fa-3x mb-3"></i>` : ''}
                                    ${ad.image ? `<img src="${ad.image}" alt="${ad.title}" class="mb-3" style="max-width: 100%; border-radius: 10px;">` : ''}
                                    <h5>${ad.title}</h5>
                                    <p class="small opacity-85">${ad.description}</p>
                                    ${ad.link ? `<a href="${ad.link}" target="_blank" class="btn btn-sm ${ad.buttonClass || 'btn-outline-light'}">${ad.buttonText || 'Learn More'}</a>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                    container.innerHTML += adHtml;
                });
            }
        };
        
        /**
         * Open Ad Manager (Admin only)
         */
        function openAdManager() {
            if (window.parent !== window) {
                window.parent.postMessage({ 
                    type: 'NAVIGATE', 
                    target: '/admin/ads' 
                }, '*');
            } else {
                alert('Ad Manager is available in the admin portal.');
            }
        }

        /**
         * ========== PHOTO GALLERY ACCESS FOR MEMBERS ==========
         */
        
        const PhotoGallery = {
            albums: [],
            isLoggedIn: false,
            
            /**
             * Load photo albums (public or member-only)
             */
            loadAlbums: async function(memberOnly = false) {
                try {
                    const endpoint = memberOnly 
                        ? '/_functions/getMemberPhotos'
                        : '/_functions/getPublicPhotos';
                    
                    const response = await fetch(MemberPortal.apiBase + endpoint);
                    const data = await response.json();
                    
                    if (data.success) {
                        this.albums = data.albums;
                        return this.albums;
                    }
                } catch (error) {
                    console.error('Error loading photos:', error);
                }
                return [];
            },
            
            /**
             * Open photo gallery for specific event
             */
            openGallery: function(eventId) {
                if (window.parent !== window) {
                    window.parent.postMessage({ 
                        type: 'NAVIGATE', 
                        target: `/photos/${eventId}` 
                    }, '*');
                } else {
                    window.location.href = `/photos?event=${eventId}`;
                }
            },
            
            /**
             * Request member photos access
             */
            requestMemberAccess: function() {
                if (!this.isLoggedIn) {
                    openMemberPortal('login');
                    showStatusMessage('info', 'Please log in to access member-only photos');
                    return false;
                }
                return true;
            }
        };

        /**
         * Initialize embed mode - with internal scrolling
         */
        function initEmbedMode() {
            document.body.classList.add('wix-embed-mode');
            
            // Enable smooth scrolling within the iframe
            document.documentElement.style.scrollBehavior = 'smooth';
            
            // Initialize ad manager
            AdManager.init();

            // Initialize site configuration (Feature 1)
            SiteConfigManager.load();
            SiteConfigManager.applySectionVisibility();
            
            // Still send height for reference (Wix may use it)
            setTimeout(sendHeightToWix, 100);
            window.addEventListener('resize', sendHeightToWix);
            window.addEventListener('load', () => {
                setTimeout(sendHeightToWix, 500);
            });
            
            // Listen for messages from Wix parent
            window.addEventListener('message', (event) => {
                if (event.data && event.data.type === 'WIX_SCROLL_TO') {
                    const section = document.querySelector(event.data.target);
                    if (section) {
                        section.scrollIntoView({ behavior: 'smooth' });
                    }
                }
                // Handle member login status
                if (event.data && event.data.type === 'MEMBER_STATUS') {
                    PhotoGallery.isLoggedIn = event.data.isLoggedIn;
                }
            });
            
            console.log('[BANF Embed] Running in embed mode with internal scrolling');
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initEmbedMode);
        } else {
            initEmbedMode();
        }

        // Force favicon to prevent 403 errors - runs immediately
        (function() {
            // Remove any existing favicon links
            var existingLinks = document.querySelectorAll("link[rel*='icon']");
            existingLinks.forEach(function(link) { link.parentNode.removeChild(link); });
            
            // Create new favicon with data URI
            var link = document.createElement('link');
            link.type = 'image/x-icon';
            link.rel = 'icon';
            link.href = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23ff6b35"/><text x="50" y="65" font-family="Arial" font-size="40" font-weight="bold" fill="white" text-anchor="middle">B</text></svg>';
            document.head.appendChild(link);
            
            // Also set as shortcut icon
            var link2 = document.createElement('link');
            link2.rel = 'shortcut icon';
            link2.href = link.href;
            document.head.appendChild(link2);
        })();

        // ========== ZELLE PAYMENT AUTOMATION ==========
        // Zelle runs via Wix Velo backend — cloud-native, no localhost required
        const ZELLE_API = WIX_API_BASE;
        let _zelleCurrentFilter = 'all';
        let _zelleMatchPaymentId = null;

        async function zelleApiFetch(endpoint, options = {}) {
            try {
                const url = `${ZELLE_API}/zelle_${endpoint}`;
                const resp = await fetch(url, {
                    headers: { 'Content-Type': 'application/json' },
                    ...options
                });
                return await resp.json();
            } catch (err) {
                console.error('[Zelle API]', err);
                return null;
            }
        }

        async function zelleLoadStats() {
            const data = await zelleApiFetch('stats');
            if (!data) return;
            document.getElementById('zelleTotalDetected').textContent = data.total_payments || 0;
            document.getElementById('zellePendingCount').textContent = (data.by_status?.pending?.count || 0);
            const verified = (data.by_status?.verified?.count || 0) + (data.by_status?.auto_verified?.count || 0);
            document.getElementById('zelleVerifiedCount').textContent = verified;
            document.getElementById('zelleAutoMatched').textContent = data.auto_vs_manual?.auto || 0;
            document.getElementById('zelleTotalAmount').textContent = '$' + (data.total_amount || 0).toLocaleString(undefined, {minimumFractionDigits:2});
            if (data.last_poll?.poll_time) {
                const d = new Date(data.last_poll.poll_time);
                document.getElementById('zelleLastScan').textContent = d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
            }
            // Poller toggle
            const btn = document.getElementById('btnZelleAutoToggle');
            if (data.poller_active) {
                btn.innerHTML = '<i class="fas fa-sync-alt fa-spin"></i> Auto-Poll: ON';
                btn.classList.remove('admin-secondary'); btn.classList.add('admin-primary');
            } else {
                btn.innerHTML = '<i class="fas fa-sync-alt"></i> Auto-Poll: OFF';
                btn.classList.remove('admin-primary'); btn.classList.add('admin-secondary');
            }
        }

        async function zelleLoadPayments() {
            const statusParam = _zelleCurrentFilter === 'all' ? '' : `?status=${_zelleCurrentFilter}`;
            const data = await zelleApiFetch(`payments${statusParam}`);
            if (!data || !data.payments) return;
            const tbody = document.getElementById('zellePaymentsBody');
            if (data.payments.length === 0) {
                tbody.innerHTML = `<tr><td colspan="9" class="text-center" style="padding:2rem; color:#999;">
                    <i class="fas fa-inbox" style="font-size:2rem; display:block; margin-bottom:0.5rem;"></i>
                    No payments found${_zelleCurrentFilter !== 'all' ? ' with status "' + _zelleCurrentFilter + '"' : ''}. Click "Scan Gmail Now" or "Load Test Data" to start.
                </td></tr>`;
                return;
            }
            tbody.innerHTML = data.payments.map(p => {
                const statusColors = { pending: '#FFC107', auto_verified: '#17a2b8', verified: '#28a745', rejected: '#dc3545' };
                const statusLabels = { pending: '⏳ Pending', auto_verified: '🤖 Auto-Verified', verified: '✅ Verified', rejected: '❌ Rejected' };
                const color = statusColors[p.status] || '#6c757d';
                const label = statusLabels[p.status] || p.status;
                const dateStr = p.email_date ? new Date(p.email_date).toLocaleDateString() : 'N/A';
                let actions = '';
                if (p.status === 'pending') {
                    actions = `<button class="admin-primary" style="font-size:0.8rem; padding:4px 10px;" onclick="zelleVerifyPayment(${p.id})"><i class="fas fa-check"></i></button>
                        <button class="admin-secondary" style="font-size:0.8rem; padding:4px 10px;" onclick="zelleOpenMatchModal(${p.id}, '${(p.sender_name||'').replace(/'/g,"\\'")} - $${p.amount}')"><i class="fas fa-link"></i></button>
                        <button class="admin-secondary" style="font-size:0.8rem; padding:4px 8px; color:#dc3545;" onclick="zelleRejectPayment(${p.id})"><i class="fas fa-times"></i></button>`;
                } else if (p.status === 'auto_verified') {
                    actions = `<button class="admin-secondary" style="font-size:0.8rem; padding:4px 10px;" onclick="zelleVerifyPayment(${p.id})" title="Confirm"><i class="fas fa-check-double"></i></button>`;
                }
                return `<tr>
                    <td style="font-size:0.85rem;">${p.id}</td>
                    <td style="font-size:0.85rem;">${dateStr}</td>
                    <td><strong>${p.sender_name || 'Unknown'}</strong><br><small style="color:#888;">${(p.sender_email||'').substring(0,30)}</small></td>
                    <td><strong style="color:#28a745;">$${(p.amount||0).toFixed(2)}</strong></td>
                    <td style="font-size:0.85rem;">${p.memo || '-'}</td>
                    <td style="font-size:0.85rem;">${p.bank_source || '-'}</td>
                    <td>${p.matched_member_name ? '<i class="fas fa-user-check" style="color:#28a745;"></i> ' + p.matched_member_name : '<span style="color:#999;">Unmatched</span>'}</td>
                    <td><span style="background:${color}22; color:${color}; padding:3px 10px; border-radius:12px; font-size:0.8rem; font-weight:600;">${label}</span></td>
                    <td style="white-space:nowrap;">${actions}</td>
                </tr>`;
            }).join('');
            zelleLoadStats();
        }

        async function zelleManualScan() {
            const btn = document.getElementById('btnZelleScan');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Scanning...';
            const banner = document.getElementById('zelleScanBanner');
            banner.style.display = 'none';
            const result = await zelleApiFetch('scan', { method: 'POST', body: JSON.stringify({ days_back: 90 }) });
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-search"></i> Scan Gmail Now';
            if (result) {
                banner.style.display = 'block';
                if (result.new_payments > 0) {
                    banner.style.background = '#e8f5e9'; banner.style.borderColor = '#4caf50';
                    document.getElementById('zelleScanMessage').innerHTML =
                        `<strong>${result.new_payments}</strong> new Zelle payment(s) detected! (${result.auto_matched} auto-matched) • ${result.emails_checked} emails scanned`;
                } else {
                    banner.style.background = '#fff3e0'; banner.style.borderColor = '#ff9800';
                    document.getElementById('zelleScanMessage').innerHTML =
                        `No new payments found. ${result.emails_checked} emails scanned`;
                }
                zelleLoadPayments();
            } else {
                banner.style.display = 'block';
                banner.style.background = '#ffebee'; banner.style.borderColor = '#f44336';
                document.getElementById('zelleScanMessage').innerHTML =
                    '❌ Scan failed. Please try again in a moment.';
            }
        }

        async function zelleTogglePoller() {
            const btn = document.getElementById('btnZelleAutoToggle');
            const isOn = btn.textContent.includes('ON');
            const result = await zelleApiFetch('poller', { method: 'POST', body: JSON.stringify({ action: isOn ? 'stop' : 'start' }) });
            if (result?.success) zelleLoadStats();
        }

        function zelleFilterPayments(status) {
            _zelleCurrentFilter = status;
            ['All','Pending','Auto','Verified','Rejected'].forEach(s => {
                const el = document.getElementById('zelleFilter' + s);
                if (el) { el.classList.remove('admin-primary'); el.classList.add('admin-secondary'); }
            });
            const map = { all: 'All', pending: 'Pending', auto_verified: 'Auto', verified: 'Verified', rejected: 'Rejected' };
            const activeBtn = document.getElementById('zelleFilter' + (map[status] || 'All'));
            if (activeBtn) { activeBtn.classList.remove('admin-secondary'); activeBtn.classList.add('admin-primary'); }
            zelleLoadPayments();
        }

        async function zelleVerifyPayment(id) {
            if (!confirm('Verify this payment?')) return;
            await zelleApiFetch('verify', { method: 'POST', body: JSON.stringify({ paymentId: id, verifiedBy: 'admin' }) });
            zelleLoadPayments();
        }

        async function zelleRejectPayment(id) {
            const reason = prompt('Reason for rejection (optional):') || '';
            await zelleApiFetch('reject', { method: 'POST', body: JSON.stringify({ paymentId: id, reason }) });
            zelleLoadPayments();
        }

        async function zelleOpenMatchModal(paymentId, info) {
            _zelleMatchPaymentId = paymentId;
            document.getElementById('zelleMatchPaymentInfo').textContent = info;
            // Load members
            const data = await zelleApiFetch('members');
            const sel = document.getElementById('zelleMatchMemberSelect');
            sel.innerHTML = '<option value="">-- Select a member --</option>';
            if (data?.members) {
                data.members.forEach(m => {
                    sel.innerHTML += `<option value="${m.id}">${m.full_name} (${m.email})</option>`;
                });
            }
            document.getElementById('zelleMatchModal').style.display = 'flex';
        }

        function zelleCloseMatchModal() {
            document.getElementById('zelleMatchModal').style.display = 'none';
            _zelleMatchPaymentId = null;
        }

        async function zelleConfirmMatch() {
            const memberId = document.getElementById('zelleMatchMemberSelect').value;
            if (!memberId) { alert('Please select a member'); return; }
            await zelleApiFetch('match', {
                method: 'POST', body: JSON.stringify({ paymentId: _zelleMatchPaymentId, memberId })
            });
            zelleCloseMatchModal();
            zelleLoadPayments();
        }

        async function zelleSeedTestData() {
            const result = await zelleApiFetch('seed', { method: 'POST' });
            if (result?.success) {
                const banner = document.getElementById('zelleScanBanner');
                banner.style.display = 'block';
                banner.style.background = '#e3f2fd'; banner.style.borderColor = '#2196f3';
                document.getElementById('zelleScanMessage').innerHTML =
                    `<i class="fas fa-flask"></i> ${result.inserted} test Zelle payment(s) loaded for demo.`;
                zelleLoadPayments();
            }
        }

        function portalRefreshPayments() {
            // Refresh member portal payment view from Zelle service
            zelleApiFetch('history').then(data => {
                if (!data?.history?.length) return;
                const tbody = document.getElementById('portalPaymentHistoryBody');
                tbody.innerHTML = data.history.map(h => {
                    const d = h.created_at ? new Date(h.created_at).toLocaleDateString('en-US', {month:'short', day:'2-digit', year:'numeric'}) : '';
                    return `<tr>
                        <td>${d}</td>
                        <td>${h.description || h.payment_type || ''}</td>
                        <td>$${(h.amount||0).toFixed(2)}</td>
                        <td><i class="fas fa-bolt" style="color:#6528F7;"></i> ${h.payment_method || 'Zelle'}</td>
                        <td><span class="status-badge active">${h.status === 'completed' ? 'Paid' : h.status}</span></td>
                        <td><a href="#" class="text-primary" onclick="alert('Receipt: ${h.receipt_number || 'N/A'}'); return false;"><i class="fas fa-download"></i> PDF</a></td>
                    </tr>`;
                }).join('');
            });
        }
        // ========== END ZELLE PAYMENT AUTOMATION ==========
    </script>
</body>
</html>
